<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222" media="(prefers-color-scheme: light)">
<meta name="theme-color" content="#222" media="(prefers-color-scheme: dark)"><meta name="generator" content="Hexo 7.3.0">

  <link rel="apple-touch-icon" sizes="180x180" href="/di-blog/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/di-blog/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/di-blog/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/di-blog/images/logo.svg" color="#222">

<link rel="stylesheet" href="/di-blog/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css" integrity="sha256-5eIC48iZUHmSlSUz9XtjRyK2mzQkHScZY1WdMaoz74E=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"jokerdii.github.io","root":"/di-blog/","images":"/di-blog/images","scheme":"Muse","darkmode":true,"version":"8.21.1","exturl":false,"sidebar":{"position":"left","width_expanded":320,"width_dual_column":240,"display":"post","padding":18,"offset":12},"hljswrap":true,"copycode":{"enable":false,"style":null},"fold":{"enable":false,"height":500},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"i18n":{"placeholder":"Searching...","empty":"We didn't find any results for the search: ${query}","hits_time":"${hits} results found in ${time} ms","hits":"${hits} results found"}}</script><script src="/di-blog/js/config.js"></script>

    <meta property="og:type" content="website">
<meta property="og:title" content="Di&#39;s Blog">
<meta property="og:url" content="https://jokerdii.github.io/di-blog/page/2/index.html">
<meta property="og:site_name" content="Di&#39;s Blog">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="Di Zhen">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="https://jokerdii.github.io/di-blog/page/2/">


<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":true,"isPost":false,"lang":"en","comments":"","permalink":"","path":"page/2/index.html","title":""}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>Di's Blog</title>
  








  <noscript>
    <link rel="stylesheet" href="/di-blog/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar" role="button">
    </div>
  </div>

  <div class="site-meta">

    <a href="/di-blog/" class="brand" rel="start">
      <i class="logo-line"></i>
      <h1 class="site-title">Di's Blog</h1>
      <i class="logo-line"></i>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="Search" role="button">
    </div>
  </div>
</div>







</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-overview-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">Di Zhen</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/di-blog/archives/">
          <span class="site-state-item-count">44</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-tags">
        <span class="site-state-item-count">4</span>
        <span class="site-state-item-name">tags</span>
      </div>
  </nav>
</div>

        </div>
      </div>
    </div>

    
  </aside>


    </div>

    <div class="main-inner index posts-expand">

    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://jokerdii.github.io/di-blog/2025/04/01/2025-April/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/di-blog/images/avatar.gif">
      <meta itemprop="name" content="Di Zhen">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Di's Blog">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Di's Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/di-blog/2025/04/01/2025-April/" class="post-title-link" itemprop="url">2025 April - What I Have Read</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2025-04-01 10:27:12" itemprop="dateCreated datePublished" datetime="2025-04-01T10:27:12-04:00">2025-04-01</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h2 id="substack">Substack</h2>
<blockquote>
<p><em>A Parquet file is composed of Row Groups, Column Chunk, and
Pages.</em></p>
<p><em>Parquet is a self-described file format that contains all the
information needed for the application that consumes the file. This
allows the software to efficiently understand and process the file
without requiring external information. Thus, the metadata is the
crucial part of Parquet. They include Magic Number, FileMetadata, and
PageHeader.</em></p>
<p><em>Google Dremel (the query engine behind BigQuery) inspired
Parquet’s approach to implementing nested and repeated field storage. In
a <a
target="_blank" rel="noopener" href="https://static.googleusercontent.com/media/research.google.com/en//pubs/archive/36632.pdf">2010
paper</a> introducing Dremel, Google detailed its method for efficiently
handling nested and repeated fields in analytics workloads using
definition level (for nested fields) and repetition level (for
array-like fields). I wrote an article about this approach seven months
ago; you can read it here:</em></p>
<p><strong>― I spent 8 hours learning Parquet. Here’s what I discovered
- Vu Trinh</strong> [<a
target="_blank" rel="noopener" href="https://vutr.substack.com/p/the-overview-of-parquet-file-format">Link</a>]</p>
</blockquote>
<blockquote>
<p><em>The overall BigQuery architecture includes independent components
for query execution, storage, a container management system, and a
shuffler service:</em></p>
<ul>
<li><em><strong>Colossus</strong>: A distributed storage system that
holds and stores data.</em></li>
<li><em><strong>Dremel</strong>: The distributed query engine.</em></li>
<li><em><strong>Borg is</strong> Google’s large-scale cluster management
system that can reliably manage and orchestrate compute resources. (<a
target="_blank" rel="noopener" href="https://kubernetes.io/blog/2015/04/borg-predecessor-to-kubernetes/">Borg
is the predecessor of Kubernetes.</a>) We will return to Borg when
discussing the Vortex architecture.</em></li>
<li><em><strong>Dedicate shuffle service</strong>: Dremel was inspired
by the map-reduce paradigm to operate and manage the data shuffle
between stages efficiently; Google built a separate shuffle service on
top of disaggregated distributed memory. This service backs BigQuery and
supports other services, such as <a
target="_blank" rel="noopener" href="https://cloud.google.com/products/dataflow?hl=en">Google
Dataflow</a>.</em></li>
</ul>
<p><strong>― I spent 4 hours learning the architecture of BigQuery's
storage engine - Vu Trinh</strong> [<a
target="_blank" rel="noopener" href="https://vutr.substack.com/p/i-spent-4-hours-learning-the-architecture">Link</a>]</p>
</blockquote>
<blockquote>
<ol type="1">
<li><em><strong>Extract</strong>: The process’s first step is
extraction. The needed data is gathered from various sources, such as
relational databases or third-party APIs</em></li>
<li><em><strong>Transform</strong>: Extracted data undergoes many
potential transformations, including cleaning, filtering, combining from
different sources, and formatting to conform to a target
schema.</em></li>
<li><em><strong>Load</strong>: The transformed data is loaded into the
destination with the predefined schema and constrained.</em></li>
</ol>
<p><em>ELT solves many of the problems associated with ETL.</em></p>
<p><em>Most transformation logic can now be handled within the data
warehouse using SQL, making it more accessible for users such as data
analysts or data scientists. This eliminates the potential performance
bottleneck of ETL pipelines.</em></p>
<p><em>Most importantly, ELT allows you to keep raw data in the
warehouse. This approach offers several advantages. You don’t need to
plan transformation logic in advance; instead, the logic can evolve over
time based on analytical needs—an especially valuable benefit in today’s
agile software development environment.</em></p>
<p><strong>― ETL and ELT - Vu Trinh</strong> [<a
target="_blank" rel="noopener" href="https://vutr.substack.com/p/etl-and-elt">Link</a>]</p>
</blockquote>
<blockquote>
<p><strong>Apache Airflow Overview - Vu Trinh</strong> [<a
target="_blank" rel="noopener" href="https://vutr.substack.com/p/apache-airflow-overview">Link</a>]</p>
</blockquote>
<blockquote>
<p><strong>How did Airbnb build their semantic layer? - Vu
Trinh</strong> [<a
target="_blank" rel="noopener" href="https://vutr.substack.com/p/how-did-airbnb-build-their-semantic">Link</a>]</p>
</blockquote>
<blockquote>
<p><em>In a meltdown, discipline beats brilliance.</em></p>
<p><em>Over the years, I’ve found that having a simple rule-based system
helps me stay grounded. Here are the 4 rules I follow to protect my
portfolio:</em></p>
<ul>
<li><em>I invest a fixed amount monthly — rain or shine.</em></li>
<li><em>I don’t add to losers — keeping them relatively small.</em></li>
<li><em>I don’t sell winners — staying the course and being
patient.</em></li>
<li><em>I invest for at least 5 years — to give compounding time to
work.</em></li>
</ul>
<p><strong>― Bear Market Survival Guide - App Economy Insights</strong>
[<a
target="_blank" rel="noopener" href="https://www.appeconomyinsights.com/p/bear-market-survival-guide">Link</a>]</p>
</blockquote>
<blockquote>
<p><strong>Salesforce &amp; AI Strategy - Generative Value</strong> [<a
target="_blank" rel="noopener" href="https://www.generativevalue.com/p/salesforce-and-ai-strategy">Link</a>]</p>
</blockquote>
<p>This article discusses the history of Salesforce, what made it
successful, the state of the business, and the AI opportunity (or
threat) today.</p>
<blockquote>
<p><strong>Everything Wrong with MCP - Shrivu's Substack</strong> [<a
target="_blank" rel="noopener" href="https://blog.sshh.io/p/everything-wrong-with-mcp">Link</a>]</p>
</blockquote>
<blockquote>
<p><strong>How to future-proof your career in the age of AI - Operator's
Handbook</strong> [<a
target="_blank" rel="noopener" href="https://www.operatorshandbook.com/p/how-to-future-proof-your-career-in">Link</a>]</p>
</blockquote>
<p><strong>Key Takeaways:</strong></p>
<p>The author’s call to "lean into human strengths while actively
engaging with AI" is a compelling middle path. The essay underscores
that the future belongs to those who combine AI literacy with
irreplaceable human skills—judgment, influence, and adaptability.</p>
<p><strong>Human Competitive Advantages</strong>:</p>
<ul>
<li><strong>Judgment &amp; Conviction</strong>: Ability to make
decisions with incomplete/ambiguous data. Distinguishing impactful work
from "interesting but useless" projects. Simplifying complexity into
actionable frameworks.</li>
<li><strong>Influence &amp; Execution</strong>: Navigating
organizational politics and incentives. Building trust and adoption for
AI-driven outputs. Understanding unspoken processes and
relationships.</li>
</ul>
<p><strong>Actionable Skills to Cultivate</strong>:</p>
<ul>
<li>Develop "taste" by studying excellence in your field.</li>
<li>Gain hands-on experience to pressure-test AI outputs.</li>
<li>Learn to align stakeholders and drive consensus.</li>
<li>Build strong interpersonal relationships and reputation.</li>
</ul>
<p><strong>Adaptability as the Ultimate Skill</strong>:</p>
<ul>
<li>AI will keep evolving, so continuous learning and flexibility are
critical.</li>
<li>Focus on areas where humans add unique value (judgment, influence,
creativity).</li>
</ul>
<p>This is a very interesting point: "Develop "taste" by studying
excellence in your field."</p>
<p>Just like any skill, taste sharpens with exposure and effort. The
more you study, critique, and create, the better you’ll get at
recognizing—and producing—excellence. In a world flooded with
AI-generated content, the people who thrive will be those who can
separate the remarkable from the mediocre.</p>
<h2 id="blogs-and-articles">Blogs and Articles</h2>
<blockquote>
<p><strong>How Airbnb Standardized Metric Computation at Scale - Airbnb
Blog</strong> [<a
target="_blank" rel="noopener" href="https://medium.com/airbnb-engineering/airbnb-metric-computation-with-minerva-part-2-9afe6695b486">Link</a>]</p>
</blockquote>
<blockquote>
<p><strong>Digital hygiene - Andrej Karpathy</strong> [<a
target="_blank" rel="noopener" href="https://karpathy.bearblog.dev/digital-hygiene/">Link</a>]</p>
</blockquote>
<p>Good tips and tricks for digital hygiene, given the pervasive nature
of internet fraud and the data collection practices of major tech
companies.</p>
<blockquote>
<p><strong>Measuring AI Ability to Complete Long Tasks - METR</strong>
[<a
target="_blank" rel="noopener" href="https://metr.org/blog/2025-03-19-measuring-ai-ability-to-complete-long-tasks/">Link</a>]</p>
</blockquote>
<figure>
<img src="/di-blog/2025/04/01/2025-April/metr-length-of-tasks-log.png"
alt="metr-length-of-tasks-log" />
<figcaption aria-hidden="true">metr-length-of-tasks-log</figcaption>
</figure>
<blockquote>
<p><strong>The "think" tool: Enabling Claude to stop and think in
complex tool use situations - Anthropic</strong> [<a
target="_blank" rel="noopener" href="https://www.anthropic.com/engineering/claude-think-tool">Link</a>]</p>
</blockquote>
<p>Anthropic introduces a "think" tool designed to enhance Claude's
complex problem-solving by providing a dedicated space for structured
reasoning during tasks. This tool differs from extended thinking by
allowing Claude to pause and consider necessary information
mid-response, particularly beneficial for multi-step processes and tool
use. Evaluations on benchmarks like τ-Bench demonstrated significant
performance improvements, especially in policy-heavy domains like
airline customer service, where optimized prompting alongside the
"think" tool proved most effective.</p>
<blockquote>
<p><strong>Tiny Agents: a MCP-powered agent in 50 lines of code -
HuggingFace</strong> [<a
target="_blank" rel="noopener" href="https://huggingface.co/blog/tiny-agents">Link</a>]</p>
</blockquote>
<blockquote>
<p><strong>Anthropic CEO wants to open the black box of AI models by
2027 - Techcrunch</strong> [<a
target="_blank" rel="noopener" href="https://techcrunch.com/2025/04/24/anthropic-ceo-wants-to-open-the-black-box-of-ai-models-by-2027/?guccounter=1">Link</a>]</p>
<p><em>Powerful AI will shape humanity’s destiny, and we deserve to
understand our own creations before they radically transform our
economy, our lives, and our future.</em></p>
<p><strong>― The Urgency of Interpretability - Dario Amodei</strong> [<a
target="_blank" rel="noopener" href="https://www.darioamodei.com/post/the-urgency-of-interpretability">Link</a>]</p>
</blockquote>
<p>Interpretability isn’t just academic—it’s a prerequisite for safe,
controllable AI. The window to solve it is narrowing as AI grows more
powerful. By steering resources toward this goal now, we might avoid a
future where humanity builds systems it doesn’t understand but can’t
afford to stop.</p>
<blockquote>
<p><strong>The Jobs That Will Fall First As AI Takes Over The Workplace
- Forbes</strong> [<a
target="_blank" rel="noopener" href="https://www.forbes.com/sites/jackkelly/2025/04/25/the-jobs-that-will-fall-first-as-ai-takes-over-the-workplace/">Link</a>]</p>
</blockquote>
<p><strong>Takeaways:</strong></p>
<ol type="1">
<li>Timeline for Disruption:
<ul>
<li>By 2030: 30% of U.S. jobs could be automated (McKinsey).</li>
<li>By 2035: White-collar restructuring in finance, legal, and media
(Larry Fink, Jamie Dimon).</li>
<li>By 2045: 50% of jobs may be fully automated (Goldman Sachs).</li>
<li>By 2050: AI could dominate 60-80% of jobs, depending on innovation
pace.</li>
</ul></li>
<li>Most Vulnerable Jobs (Near-Term):
<ul>
<li>Administrative: Data entry, scheduling, customer service (60%
automatable, per IPPR).</li>
<li>Finance &amp; Legal: Bookkeeping, contract drafting, paralegal work
(AI tools like Harvey already achieve 90% accuracy).</li>
<li>Creative &amp; Media: Basic graphic design, copywriting, journalism
(30% at risk by 2035, Pew Research).</li>
<li>Routine STEM Tasks: Coding, data analysis (40% automatable by 2040,
WEF).</li>
</ul></li>
<li>More Resilient Jobs (Longer-Term):
<ul>
<li>Healthcare: Nursing, therapy, and patient care (empathy-driven
roles).</li>
<li>Skilled Trades: Construction, repair, maintenance (physical labor is
harder to automate).</li>
<li>Education &amp; Leadership: Teaching, high-level management
(requires emotional intelligence).</li>
</ul></li>
</ol>
<p><strong>To protect career:</strong></p>
<ul>
<li>Focus on critical thinking, creativity, and AI collaboration (e.g.,
prompt engineering, AI-augmented decision-making).</li>
<li>Target Resilient Sectors- Healthcare, education, skilled trades, and
AI-adjacent roles (e.g., cybersecurity, AI ethics).</li>
<li>Push for employer or government-sponsored programs to transition
into hybrid (human + AI) roles.</li>
<li>Embrace Hybrid Roles- Jobs that combine technical skills with human
judgment (e.g., AI-assisted healthcare diagnostics) will thrive.</li>
</ul>
<p>As Ray Dalio warns, the economy faces a "great deleveraging" where AI
disrupts jobs faster than new ones emerge. The key is
<strong>adaptability</strong>—those who proactively reinvent their
skills today will shape the workforce of tomorrow.</p>
<blockquote>
<p><strong>Curation is the new leadership superpower. Here are 3 ways to
adopt a curation mindset - FastCompany</strong> [<a
target="_blank" rel="noopener" href="https://www.fastcompany.com/91322752/curation-is-the-new-leadership-superpower-here-are-3-ways-to-adopt-a-curation-mindset">Link</a>]</p>
</blockquote>
<p>The most transformative leaders of the next decade will be those who
master the art of curation—seeing their role as a conduit for the best
ideas, not the source of them.</p>
<p>The Obsolescence of the "Omniscient Leader": The pace of change,
hyper-specialization, and interconnected challenges (e.g., AI, climate,
global markets) make it impossible for one person to have all the
answers. Leaders must shift from being "the smartest in the room" to
becoming "architects of collective intelligence."</p>
<p><strong>Curation as the Core Leadership Skill:</strong></p>
<ol type="1">
<li>Curating Talent: Prioritize cognitive diversity over homogeneity.
Example: Diverse teams solve problems faster (39% efficiency
boost).</li>
<li>Curating Ideas: Create systems where unconventional thinking
flourishes (e.g., Google’s 20% time → Gmail, Maps). Actively seek
"outliers" (contrarians, outsiders) to challenge groupthink.</li>
<li>Curating Innovation: Design for "structured serendipity" (e.g.,
Pixar’s open office, IDEO’s cross-industry brainstorming). Embrace
cross-disciplinary collisions (e.g., NASA’s tech inspiring sportswear,
biomimicry in architecture).</li>
</ol>
<p><strong>How to Cultivate a Curation Mindset</strong>:</p>
<ul>
<li>Facilitate, don’t dictate: Ask better questions; let solutions
emerge from debate (e.g., Amazon’s "Disagree and Commit").</li>
<li>Optimize for collaboration, not just efficiency: Space matters
(physical or virtual).</li>
</ul>
<blockquote>
<p><strong>Perplexity CEO says its browser will track everything users
do online to sell ‘hyper personalized’ ads - TechCrunch</strong> [<a
target="_blank" rel="noopener" href="https://techcrunch.com/2025/04/24/perplexity-ceo-says-its-browser-will-track-everything-users-do-online-to-sell-hyper-personalized-ads/">Link</a>]</p>
</blockquote>
<p>Perplexity is building a browser (Comet) to track user behavior
across the web—explicitly to fuel targeted advertising. It highlights
the company’s ambition to emulate Google’s surveillance-capitalism
playbook.</p>
<p>Perplexity’s move confirms that the AI search revolution is less
about displacing Google’s model than replicating it—with AI as a smarter
wrapper for the same ads.</p>
<blockquote>
<p><strong>Today’s Most Crucial Leadership Skill Is Systems Thinking -
Forbes</strong> [<a
target="_blank" rel="noopener" href="https://www.forbes.com/sites/maryjohnstone-louis/2025/04/25/todays-most-crucial-leadership-skill-is-systems-thinking/">Link</a>]</p>
</blockquote>
<p>Leaders who master systems thinking don’t just survive
uncertainty—they <strong>thrive in it</strong>, turning complexity into
competitive advantage.</p>
<p><strong>Five Key Tools of Systems Thinking for Strategic
Leaders</strong></p>
<ol type="1">
<li>Problem Statements: Move from surface-level fixes to systemic
solutions. Example: Instead of asking, <em>“How do we get customers to
recycle?”</em>, ask, <em>“How can we redesign products and
infrastructure for circularity?”</em></li>
<li>Stakeholder Mapping: Identify all affected parties—not just obvious
ones. Example: For electric vehicles, consider miners of critical
minerals, urban planners, and regulators, not just automakers and
buyers.</li>
<li>Iceberg Analysis: Look beneath visible events to uncover hidden
structures and mindsets. Example: Employee burnout isn’t just about
workload—it’s shaped by corporate culture, incentive systems, and
societal norms.</li>
<li>Causal Loops: Visualize feedback loops to see how actions create
ripple effects. Example: A cost-cutting measure in one department may
increase inefficiencies elsewhere.</li>
<li>Iteration &amp; Testing: Embrace adaptive strategies, not rigid
plans. Example: Pilot small-scale solutions, measure impact, and refine
before full rollout.</li>
</ol>
<blockquote>
<p><strong>Perplexity CEO shares the Elon Musk–inspired mantra that
helped him build the $9 billion rival to OpenAI - Fortune</strong> [<a
target="_blank" rel="noopener" href="https://fortune.com/article/perplexity-ceo-aravind-srinivas-elon-musk-inspired-mantra-help-build-billion-dollar-openai-google-rival/">Link</a>]</p>
</blockquote>
<p>Srinivas’s journey highlights resilience, speed, and Silicon Valley’s
tight-knit founder network as key drivers of startup success.</p>
<ol type="1">
<li>"It’s Only Over When You Give Up" – Aravind Srinivas, CEO of AI
search startup Perplexity, draws inspiration from Elon Musk’s
perseverance during SpaceX’s early failures. He told Harvard students
that success comes from relentless self-belief, even when others doubt
you.</li>
<li>Rocketing Valuation – Perplexity, competing with Google and OpenAI,
grew from a 1B to 9B and is now in talks to raise funds at an 18B
valuation.</li>
<li>Forget Pitch Decks, Build Fast – Srinivas advises founders to focus
on rapid product iteration rather than lengthy business plans. He admits
he doesn’t even know how to make a pitch deck—Perplexity’s success came
from live demos.</li>
<li>OpenAI Alumni Network – Despite competing with OpenAI, Srinivas
maintains a strong relationship with Sam Altman (his former boss at
OpenAI). This mirrors the "PayPal Mafia" dynamic, where ex-OpenAI
employees now lead major AI firms like Anthropic and Safe
Superintelligence.</li>
</ol>
<blockquote>
<p><strong>Marc Andreessen predicts one of the few jobs that may survive
the rise of AI automation - Fortune</strong> [<a
target="_blank" rel="noopener" href="https://fortune.com/article/mark-andreessen-venture-capitalism-ai-automation-a16z/">Link</a>]</p>
</blockquote>
<p>Andreessen’s logic suggests focusing on roles where trust,
psychology, and networks matter more than data crunching. But don’t
underestimate AI’s ability to creep into those domains too.</p>
<blockquote>
<p><strong>How To Get Noticed Without Self-Promotion By Using Strategic
Visibility - Forbes</strong> [<a
target="_blank" rel="noopener" href="https://www.forbes.com/sites/cynthiayoung/2025/04/27/how-to-get-noticed-without-self-promotion-by-using-strategic-visibility/">Link</a>]</p>
</blockquote>
<p><strong>Core Lessons:</strong></p>
<ol type="1">
<li><strong>Hard Work ≠ Visibility</strong>: Doing great work is
necessary but insufficient. If leaders don’t know what you’re doing,
they can’t reward it. Waiting for annual reviews is too late—visibility
requires consistent, intentional updates.</li>
<li><strong>Humility Has a Hidden Cost</strong>: While modesty is
admirable, staying silent can render you invisible. Gallup’s data on
declining engagement (just 36% in 2020) highlights how disengagement
hurts promotion prospects. Visibility isn’t ego-driven; it’s about
ensuring your impact is recognized.</li>
<li><strong>Visibility ≠ Bragging</strong>: Framing contributions as
useful knowledge (e.g., "Here’s how I solved X") builds trust and
leadership credibility. Sharing wins, failures, and best practices helps
the team and positions you as a problem-solver.</li>
<li><strong>Tactical Ways to Increase Visibility</strong>
<ul>
<li>Share knowledge: Lead "lessons learned" sessions or contribute to
internal newsletters.</li>
<li>Mentor others: Their success reflects your leadership.</li>
<li>Speak up strategically: One substantive insight per meeting &gt;
empty chatter.</li>
<li>Volunteer for high-impact projects: Align with organizational
priorities.</li>
<li>Write internally: Document best practices to showcase thought
leadership.</li>
</ul></li>
<li><strong>Emotional Intelligence (EQ) Matters More Than
Extroversion</strong>
<ul>
<li>Visibility is about meaningful engagement, not being the
loudest.</li>
<li>Avoid self-deprecating language ("I’m sorry, but…")—speak with
conviction.</li>
</ul></li>
<li><strong>What Leaders Actually Notice</strong>
<ul>
<li>Initiative, influence, and alignment with goals matter more than
face-time.</li>
<li>Working smart (not just late) and collaborating effectively signal
leadership potential.</li>
</ul></li>
</ol>
<h2 id="youtube-and-podcast">YouTube and Podcast</h2>
<blockquote>
<p><strong>DOGE updates + Liberation Day Tariff Reactions with Ben
Shapiro and Antonio Gracias - All-In Podcast</strong> [<a
target="_blank" rel="noopener" href="https://www.youtube.com/watch?v=OjhA9p3ZXW0&amp;ab_channel=All-InPodcast">Link</a>]</p>
</blockquote>
<blockquote>
<p><strong>2027 Intelligence Explosion: Month-by-Month Model — Scott
Alexander &amp; Daniel Kokotajlo - Dwarkesh Patel</strong> [<a
target="_blank" rel="noopener" href="https://www.youtube.com/watch?v=htOvH12T7mU&amp;ab_channel=DwarkeshPatel">Link</a>]</p>
</blockquote>
<blockquote>
<p><strong>Trump vs Harvard, Nvidia export controls, how DEI killed
Hollywood with Tim Dillon - All-In Podcast</strong> [<a
target="_blank" rel="noopener" href="https://www.youtube.com/watch?v=rCrb4TbHRxc&amp;ab_channel=All-InPodcast">Link</a>]</p>
</blockquote>
<blockquote>
<p><strong>E187 | 关税战难解美国制造业困境，旧秩序正在崩溃 -
硅谷101播客</strong> [<a
target="_blank" rel="noopener" href="https://www.youtube.com/watch?v=6Fmo_jBc7mA&amp;t=1637s&amp;ab_channel=%E7%A1%85%E8%B0%B7101%E6%92%AD%E5%AE%A2">Link</a>]</p>
</blockquote>
<blockquote>
<p><strong>How DeepSeek Rewrote the Transformer [MLA] - Welch
Labs</strong> [<a
target="_blank" rel="noopener" href="https://www.youtube.com/watch?v=0VLAoVGf_74&amp;ab_channel=WelchLabs">Link</a>]</p>
</blockquote>
<p>A lecture explaining the architecture and optimizations behind
DeepSeek R1, a language model that improves Transformer efficiency.</p>
<blockquote>
<p><strong>Live Demo: Reinforcement Fine-Tuning for LLMs — Build Smarter
Models with Less Data l Tutorial - Predibase</strong> [<a
target="_blank" rel="noopener" href="https://www.youtube.com/watch?v=tHvZypO3le4&amp;ab_channel=Predibase">Link</a>]</p>
</blockquote>
<p>This video was talking about why RFT beats supervised fine-tuning
(SFT) in reasoning tasks, giving live demo of an end-to-end RFT
workflow, and PyTorch-to-Triton case study showing real-world
impact.</p>
<blockquote>
<p><strong>Model Context Protocol (MCP), clearly explained (why it
matters) - Greg Isenberg</strong> [<a
target="_blank" rel="noopener" href="https://www.youtube.com/watch?v=7j_NE6Pjv-E&amp;ab_channel=GregIsenberg">Link</a>]</p>
</blockquote>
<blockquote>
<p><strong>Trump Rally or Bessent Put? Elon Back at Tesla, Google's
Gemini Problem, China's Thorium Discovery - All-In Podcast</strong> [<a
target="_blank" rel="noopener" href="https://www.youtube.com/watch?v=4tcd1EgQrhU&amp;ab_channel=All-InPodcast">Link</a>]</p>
</blockquote>
<blockquote>
<p><em>Suffering is mostly mental anguish and mental pain and it just
means you don't want to do the task at hand.</em></p>
<p><em>The kind of fame that pure actors and celebrities have, I
wouldn't want, but the kind of fame that's earned because you did
something useful, why dodge that.</em></p>
<p><em>People will always want more status uh but I think you can be
satisfied at a certain level of wealth.</em></p>
<p><em>Not the kind of confidence that would say I have the answer but
the kind of confidence that I will figure it out and I know what I want
or only I am a good arbiter of what I want.</em></p>
<p><em>Pride is the enemy of learning, so when I look at my friends and
colleagues, the ones who are still stuck in the past and have grown the
least are the ones who were the proudest, because they sort of feel like
they already had the answers and so they don't want to correct
themselves publicly.</em></p>
<p><em>I think everybody puts themselves first that's just human nature,
you're here because you survive you're a separate organism.</em></p>
<p><em>The happier you are, the more you can sustain doing something,
the more likely you're going to do something that will in turn make you
even happier, and you'll continue to do it, and you'll outwork everybody
else. The more free you are the better you can allocate your
time.</em></p>
<p><em>There are no problems in the real world other than maybe things
that inflict pain on your body. Everything else has to become a problem
in your mind first.</em></p>
<p><em>Your family is broken but you're going to fix the world. People
are running out there to try and fix the world when their own lives are
a mess.</em></p>
<p><em>I think the only true test of intelligence is if you get what you
want out of life and there are two parts to that one is getting what you
want so you know how to get it and the second is wanting the right
things knowing what to want in the first place.</em></p>
<p><em>Usually I think people end up there because they are going on
autopilot with sort of societal expectations or other people's
expectations or out of guilt or out of like mimetic desire.</em></p>
<p><em>Probably the biggest regret will be staying in the relationship
after you knew it was over, exactly you should have left sooner, the
moment you knew it wasn't going to work out, you should have moved
on.</em></p>
<p><em>We are naturally hardwired to be pessimists but modern society is
very different despite whatever problems you may have with modern
society, it is far far safer than living in the jungle and just trying
to survive and the opportunities.</em></p>
<p><em>Leave all those labels alone. It's better just to look at the
problem at hand, look at reality the way it is, try to take yourself out
of the equation in a sense.</em></p>
<p><em>The less you think about yourself the more you can think about a
mission or about God or about a child or something like that.</em></p>
<p><em>I don't think there are any formulas i think it's unique to each
person it's like asking a successful person how did you become
successful each one of them will give you a different story uh you can't
follow anyone else's path.</em></p>
<p><em>A lot of change is more about desire and understanding than it is
about uh forcing yourself or trying to domesticate yourself.</em></p>
<p><em>When your mind is under stress, it's because it has two
conflicting desires at once... and anxiety I think is sort of this
pervasive unidentifiable stress where you're just kind of stressed out
all the time and you're not even sure why and you can't even identify
the underlying problem. I think the reason for that is because you have
so many unresolved problems unresolved stress points that have piled up
in your life that you can no longer identify what the problems
are.</em></p>
<p><em>Life is going to play out the way it's going to play out there
will be some good and some bad most of it is actually just up to your
interpretation.</em></p>
<p><em>The gut is what decides the head, is kind of what rationalizes it
afterwards, the gut is the ultimate decision maker.</em></p>
<p><em>You can't change other people, you can change your reaction to
them.</em></p>
<p><em>If you do want to change someone's behavior, I I think the only
effective way to do it is to compliment them when they do something you
want, not to insult them or be negative or critical when they do
something you don't want.</em></p>
<p>If you can't decide, the answer is no.</p>
<p><em>Almost invariably the advice that you would give yourself 10
years ago is still the advice that you need to hear today.</em></p>
<p><em>On mental things, I think understanding is way more important
once you see the truth of something you cannot unsee it... when we
really do see something clearly, it changes our behavior immediately,
and that is far more efficient than trying to change your behavior
through repetition.</em></p>
<p><em>Truth is often painful, if it wasn't, we'd all be seeing truth
all the time. Reality is always reflecting truth that's all it is why
would you not have accessed it already exactly... wisdom is the set of
things that cannot be transmitted. If they could be transmitted you know
we'd read the same five philosophy books, and we'd all be done, we'd all
be wise. You have to learn it for yourself, it has to be rediscovered
for yourself in your own context.</em></p>
<p><em>You're probably better off only caring about things that are
local or things that you can affect. So if you really care about
something that's in the news, then by all means care about it but make a
difference go do something about it.</em></p>
<p><em>Desire is a contract to be unhappy until you get what you
want.</em></p>
<p><em>The real currency of life is attention it's what you choose to
pay attention to and and what you do about it.</em></p>
<p><strong>― 44 Harsh Truths About Human Nature - Naval Ravikant (4K) -
Chris Williamson</strong> [<a
target="_blank" rel="noopener" href="https://www.youtube.com/watch?v=KyfUysrNaco">Link</a>]</p>
</blockquote>
<p>Key Learnings:</p>
<ul>
<li>Someone who can do the job peacefully or happily is more effective
than someone with unnecessary emotional turmoil</li>
<li>Fame sought for its own sake is fragile and leads to a constant need
to perform.</li>
<li>People often say things they don't really believe, driven by a
desire to be seen as something they are not.</li>
<li>Status is zero-sum and insatiable, unlike wealth. Status is often
comparative, like leaderboards, where one person's gain can be another's
loss.</li>
<li>Self-esteem comes from aligning actions with internal values,
especially when difficult. Genuine sacrifice, doing something you want
less for something you value more, can build self-esteem.</li>
<li>True confidence is not having all the answers but the self-belief to
figure things out.</li>
<li>Pride is an enemy of learning and can lead to being stuck in past
mistakes.</li>
<li>Everyone puts themselves first; unapologetic self-prioritization is
rare but perhaps more honest. Much of what appears as altruism might be
a waste of time if it goes against one's true desires.</li>
<li>Happiness and freedom are intertwined with efficiency and
productivity.</li>
<li>Many emotional problems arise from the mind creating problems where
none exist in the real world. He advises observing one's thoughts
objectively to realize unnecessary emotional energy expenditure.</li>
<li>People often try to fix the world while their own lives are in
disarray. He questions the credibility of those who cannot manage their
own lives but seek to solve global issues.</li>
<li>True intelligence is getting what you want out of life by wanting
the right things and knowing how to get them.</li>
<li>Many people go through life unconsciously following societal or
mimetic desires. He emphasizes the importance of thinking things through
for oneself rather than blindly following others.</li>
<li>Staying too long in bad situations (relationships, jobs) is a common
regret.</li>
<li>We are naturally hardwired for pessimism due to evolutionary
pressures to avoid ruin.</li>
<li>Humans are dynamic and labels like optimist, pessimist, introvert,
extrovert are self-limiting.</li>
<li>Overthinking about oneself can lead to misery; focusing on something
bigger can bring happiness. Overthinking and rumination do not help with
happiness.</li>
<li>There are no universal formulas for success or happiness; each
person's path is unique.</li>
<li>Lasting change comes from desire and understanding, not forcing
oneself. He suggests aligning actions with genuine wants for maximal
effectiveness.</li>
<li>Anxiety often stems from having many unresolved and conflicting
desires.</li>
<li>Our interpretations of experiences shape our reality. The same
experience can lead to different emotional responses based on individual
interpretation.</li>
<li>The "gut" is the ultimate decision-maker, representing refined
judgment accumulated through evolution and experience. He advises
trusting this instinct once it's developed.</li>
<li>You cannot change other people, only your reaction to them. He adds
that people change through their own insights or trauma, not by being
told to.</li>
<li>Negative reinforcement is less effective than positive reinforcement
in changing behavior.</li>
<li>If faced with a difficult choice and unable to decide, the answer is
often "no." He also suggests that when choosing between two equal
options, take the more painful path in the short term.</li>
<li>Understanding is more important than discipline for mental
change.</li>
<li>Truth, though often painful, is constantly reflected by reality;
wisdom is the personal rediscovery and contextual application of
timeless truths. He also mentions that many important life lessons are
"unteachable" in the sense that they must be experienced firsthand to be
truly understood.</li>
<li>Memorization is becoming less valuable in the age of readily
available information; understanding, judgment, and taste are more
crucial. He links understanding to solving real problems and finding
generalizable truths.</li>
<li>Philosophy evolves with new knowledge and perspectives. He explains
how advancements in science and technology lead to different
philosophical outlooks, and even moral philosophy progresses over
time.</li>
<li>Many philosophical paradoxes can be resolved by considering
different scales and timeframes. Naval suggests that seemingly
contradictory questions like free will and determinism can be understood
by shifting perspectives.</li>
<li>Coordination is essential for societal function; pure libertarianism
is unsustainable.</li>
<li>Modern AI, while powerful, currently lacks true creativity and deep
understanding.</li>
<li>Meaning can be more important than moment-to-moment happiness.</li>
<li>In an age of news saturation, it's a battle to maintain focus on
what truly matters and what one can influence. He emphasizes that
attention is the real currency of life and should be spent consciously.
Attention, not time or money, is the most fundamental resource in
life.</li>
<li>Getting past one's past is a skill achieved by processing it to be
rid of it, not to dwell on it.</li>
</ul>
<blockquote>
<p><em>I think agents are real, but I think that we are far away from
that because we're still at the phase of how do you build reliable
software in production for an enterprise versus the toy apps that you
see on the internet which is like let me vibe code something. I think
these things are worlds apart still. - Chamath Palihapitiya</em></p>
<p><em>I think we have not yet figured out how to move the budgets from
experimentation to mainline production. Meaning where large chunks of
the US economy are comfortable enough with the ways in which
hallucinations are managed such that they will replace legacy
deterministic code with this new probabilistic model generated code
meaning model enabled code. - Chamath Palihapitiya</em></p>
<p><strong>― Trump's First 100 Days, Tariffs Impact Trade, AI Agents,
Amazon Backs Down - All-In Podcast</strong> [<a
target="_blank" rel="noopener" href="https://www.youtube.com/watch?v=W960TW79QCI">Link</a>]</p>
</blockquote>
<h2 id="papers-and-reports">Papers and Reports</h2>
<blockquote>
<p><strong>Orchestrating Agents and Data for Enterprise: A Blueprint
Architecture for Compound AI</strong> [<a
target="_blank" rel="noopener" href="https://arxiv.org/abs/2504.08148">Link</a>]</p>
</blockquote>
<p>This paper contributes to the enterprise AI landscape by offering a
comprehensive architectural blueprint for deploying agentic, modular,
and data-integrated AI systems that can efficiently leverage LLMs and
enterprise assets.</p>
<h2 id="github">Github</h2>
<blockquote>
<p><strong>Google Gemini 2.0 with MCP (Model Context Protocol) Servers -
Gemini Samples</strong> [<a
target="_blank" rel="noopener" href="https://github.com/philschmid/gemini-samples/blob/main/examples/gemini-mcp-example.ipynb">Link</a>]</p>
</blockquote>
<blockquote>
<p><strong>Maestro - A Framework for Claude Opus, GPT and local LLMs to
Orchestrate Subagents - maestro</strong> [<a
target="_blank" rel="noopener" href="https://github.com/Doriandarko/maestro">Link</a>]</p>
</blockquote>
<blockquote>
<p><strong>MCP-Agent</strong> [<a
target="_blank" rel="noopener" href="https://github.com/lastmile-ai/mcp-agent">Link</a>]</p>
</blockquote>
<blockquote>
<p><strong>Local Deep Researcher</strong> [<a
target="_blank" rel="noopener" href="https://github.com/langchain-ai/local-deep-researcher">Link</a>]</p>
</blockquote>
<h2 id="news">News</h2>
<blockquote>
<p><strong>Accelerate Generalist Humanoid Robot Development with NVIDIA
Isaac GR00T N1 - NVIDIA</strong> [<a
target="_blank" rel="noopener" href="https://developer.nvidia.com/blog/accelerate-generalist-humanoid-robot-development-with-nvidia-isaac-gr00t-n1/">Link</a>]</p>
</blockquote>
<blockquote>
<p><strong>Announcing the Agent2Agent Protocol (A2A) - Google for
Developers</strong> [<a
target="_blank" rel="noopener" href="https://developers.googleblog.com/en/a2a-a-new-era-of-agent-interoperability/">Link</a>]</p>
</blockquote>
<p><strong>Key Takeaways:</strong></p>
<ol type="1">
<li>A2A is an open-source protocol backed by 50+ tech giants (e.g.,
Salesforce, SAP, Cohere) and consultancies (e.g., Accenture, Deloitte).
It allows agents from different vendors/frameworks to communicate, share
data, and coordinate tasks without being locked into a single
platform.</li>
<li>Solving Enterprise Pain Points: Breaks down silos by letting agents
interoperate across HR (Workday), CRM (Salesforce), ERP (SAP), and other
systems. Example: A hiring manager’s agent can autonomously source
candidates, schedule interviews, and run background checks by
collaborating with specialized agents.</li>
<li>Design Principles:
<ul>
<li>Agent-Centric: Supports unstructured, multi-agent collaboration
(beyond rigid "tool" roles).</li>
<li>Built on Standards: Uses HTTP, JSON-RPC, and SSE for easy
integration.</li>
<li>Secure by Default: Enterprise-grade auth (aligned with
OpenAPI).</li>
<li>Long-Running Tasks: Handles tasks lasting hours/days with real-time
updates.</li>
<li>Multimodal: Supports text, audio, video, and UI negotiations (e.g.,
web forms, iframes).</li>
</ul></li>
</ol>
<blockquote>
<p><strong>The Chinese goods Americans most rely on, from microwaves to
Barbies - Financial Times</strong> [<a
target="_blank" rel="noopener" href="https://www.ft.com/content/ec96e2ed-5dd6-4c6b-92a0-1b77bf517b36">link</a>]</p>
</blockquote>
<blockquote>
<p><strong>Apple Vision Pro 2 Reportedly Cheaper &amp; Lighter,
Mac-Tethered Headset Coming Too - Upload</strong> [<a
target="_blank" rel="noopener" href="https://www.uploadvr.com/apple-vision-pro-2-reportedly-cheaper-lighter-mac-tethered-headset-coming-too/">Link</a>]</p>
</blockquote>
<h2 id="others">Others</h2>
<p>Machine learning (ML) solutions applied to business problems across
various industries:</p>
<ul>
<li>ML and LLM system design: 500 case studies to learn from [<a
target="_blank" rel="noopener" href="https://www.evidentlyai.com/ml-system-design">Link</a>]</li>
<li>Machine Learning and Data Science Applications in Industry - Firmai
[<a
target="_blank" rel="noopener" href="https://github.com/firmai/industry-machine-learning">Link</a>]</li>
<li>Business Machine Learning - Firmai [<a
target="_blank" rel="noopener" href="https://github.com/firmai/business-machine-learning">Link</a>]</li>
<li>ML System Design Case Studies Repository [<a
target="_blank" rel="noopener" href="https://github.com/Engineer1999/A-Curated-List-of-ML-System-Design-Case-Studies">Link</a>]</li>
<li>500+ Artificial Intelligence Project List with Code [<a
target="_blank" rel="noopener" href="https://github.com/ashishpatel26/500-AI-Machine-learning-Deep-learning-Computer-vision-NLP-Projects-with-code">Link</a>]</li>
</ul>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://jokerdii.github.io/di-blog/2025/03/04/2025-March/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/di-blog/images/avatar.gif">
      <meta itemprop="name" content="Di Zhen">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Di's Blog">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Di's Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/di-blog/2025/03/04/2025-March/" class="post-title-link" itemprop="url">2025 March - What I Have Read</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2025-03-04 00:15:05" itemprop="dateCreated datePublished" datetime="2025-03-04T00:15:05-05:00">2025-03-04</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h2 id="blogs-and-articles">Blogs and Articles</h2>
<blockquote>
<p><strong>How to Build a Graph RAG App - Steve Hedden</strong> [<a
target="_blank" rel="noopener" href="https://towardsdatascience.com/how-to-build-a-graph-rag-app-b323fc33ba06/">Link</a>]</p>
</blockquote>
<p>Walking through building a graph rag app that improves LLM accuracy
using knowledge graphs. It covers data preparation, search refinement
with MeSH terms, and article summarization.</p>
<blockquote>
<p><em>We believe that, in 2025, we may see the first AI agents “join
the workforce” and materially change the output of companies. We
continue to believe that iteratively putting great tools in the hands of
people leads to great, broadly-distributed outcomes.</em></p>
<p><strong>― Reflections - Sam Altman</strong> [<a
target="_blank" rel="noopener" href="https://blog.samaltman.com/reflections">Link</a>]</p>
</blockquote>
<blockquote>
<p><strong>Structured Report Generation Blueprint with NVIDIA
AI</strong> [<a
target="_blank" rel="noopener" href="https://blog.langchain.dev/structured-report-generation-blueprint/">Link</a>]
[<a target="_blank" rel="noopener" href="https://www.youtube.com/watch?v=E04rFNtwFcA">YouTube</a>]</p>
</blockquote>
<blockquote>
<p><strong>Sky-T1: Train your own O1 preview model within $450</strong>
- <a target="_blank" rel="noopener" href="https://novasky-ai.github.io/">NovaSky</a> [<a
target="_blank" rel="noopener" href="https://novasky-ai.github.io/posts/sky-t1/">Link</a>]</p>
</blockquote>
<blockquote>
<p><strong>Agents - Chip Huyen</strong> [<a
target="_blank" rel="noopener" href="https://huyenchip.com//2025/01/07/agents.html">Link</a>]</p>
</blockquote>
<p>This guide provides a comprehensive exploration of AI-powered agents,
focusing on their capabilities, planning, tool selection, and failure
modes. It delves into the factors determining an agent's performance,
how LLMs can plan, and how to augment planning capabilities. It also
provides insights into agent failures and how to evaluate them
effectively.</p>
<blockquote>
<p><strong>The Batch Issue 284 - DeepLearning.AI - Andrew Ng</strong>
[<a
target="_blank" rel="noopener" href="https://www.deeplearning.ai/the-batch/issue-284/">Link</a>]</p>
</blockquote>
<p>Andrew Ng highlights AI Product Management’s growth as software
becomes cheaper to build.</p>
<blockquote>
<p><strong>DeepSeek V3 LLM NVIDIA H200 GPU Inference Benchmarking -
DataCrunch</strong> [<a
target="_blank" rel="noopener" href="https://datacrunch.io/blog/deepseek-v3-llm-nvidia-h200-gpu-inference-benchmarking">Link</a>]</p>
</blockquote>
<blockquote>
<p><strong>Global-batch load balance almost free lunch to improve your
MoE LLM training - Qwen</strong> [<a
target="_blank" rel="noopener" href="https://qwenlm.github.io/blog/global-load-balance/">Link</a>]</p>
</blockquote>
<p>MoE models struggle with expert underutilization due to
micro-batch-level load balancing, which fails when data within a batch
lacks diversity. This results in poor expert specialization and model
performance.</p>
<p>The paper proposes global-batch load balancing, where expert
selection frequencies are synchronized across all parallel groups,
ensuring more effective domain specialization and improved
performance.</p>
<p>Global-batch load balancing outperforms micro-batch balancing in all
tested configurations. It shows improved performance and expert
specialization, with models achieving better results across various data
sizes and domains.</p>
<blockquote>
<p><strong>How to Evaluate LLM Summarization - Isaac Tham</strong> [<a
target="_blank" rel="noopener" href="https://towardsdatascience.com/how-to-evaluate-llm-summarization-18a040c3905d/">Link</a>]</p>
</blockquote>
<p>A quantitative, research-backed framework for evaluating LLM
summaries, focusing on conciseness and coherence. This guide explores
challenges in summarization evaluation, defines key quality metrics
(conciseness, coherence), and improves the Summarization Metric in the
DeepEval framework. Includes a GitHub notebook for applying these
methods to assess summaries of long-form content systematically.</p>
<blockquote>
<p><strong>We just gave sight to smolagents - HuggingFace</strong> [<a
target="_blank" rel="noopener" href="https://huggingface.co/blog/smolagents-can-see">Link</a>]</p>
</blockquote>
<p>This tutorial is about how to integrate vision capabilities into
autonomous agents using smolagents. It explains passing images to agents
in two ways: at initialization or dynamically via callbacks. It
demonstrates building a web-browsing agent with vision using the
MultiStepAgent class and helium. The agent performs actions like
navigation, popup handling, and dynamic webpage analysis.</p>
<blockquote>
<p><strong>On DeepSeek and Export Controls - Dario Amodei</strong> [<a
target="_blank" rel="noopener" href="https://darioamodei.com/on-deepseek-and-export-controls">Link</a>]</p>
</blockquote>
<p>Highlighting export controls' impact on AI geopolitics.</p>
<blockquote>
<p><strong>Workflows and Agents - LangGraph</strong> [<a
target="_blank" rel="noopener" href="https://langchain-ai.github.io/langgraph/tutorials/workflows/">Link</a>]</p>
</blockquote>
<p>Review of common patterns for agentic systems.</p>
<blockquote>
<p><strong>Constitutional Classifiers: Defending against universal
jailbreaks - Anthropic</strong> [<a
target="_blank" rel="noopener" href="https://www.anthropic.com/research/constitutional-classifiers">Link</a>]
[<a target="_blank" rel="noopener" href="https://youtu.be/BaNXYqcfDyo">YouTube</a>]</p>
</blockquote>
<p>Anthropic invites everyone to test its new safety classifier that
eradicates jailbreaks and further increases Claude's over-refusal
rate.</p>
<blockquote>
<p><strong>Open-source DeepResearch – Freeing our search agents -
HuggingFace</strong> [<a
target="_blank" rel="noopener" href="https://huggingface.co/blog/open-deep-research">Link</a>]</p>
</blockquote>
<p>Hugging Face challenges OpenAI’s Deep Research with an open-source
alternative, beating previous SOTA by 9 points.</p>
<blockquote>
<p><strong>Choosing the Right AI Agent Framework: LangGraph vs CrewAI vs
OpenAI Swarm - Yi Zhang</strong> [<a
target="_blank" rel="noopener" href="https://blog.relari.ai/choosing-the-right-ai-agent-framework-langgraph-vs-crewai-vs-openai-swarm-56f7931b4249">Link</a>]</p>
</blockquote>
<p>Compare LangGraph, CrewAI, and OpenAI Swarm frameworks for building
agentic applications with hands-on examples. Understand when to use each
framework, and get a preview of debugging and observability topics in
Part II.</p>
<blockquote>
<p><strong>How to Scale Your Model - Google DeepMind</strong> [<a
target="_blank" rel="noopener" href="https://jax-ml.github.io/scaling-book/">Link</a>]</p>
</blockquote>
<p>Learn how to scale LLMs on TPUs by understanding hardware
limitations, parallelism, and efficient training techniques. Explore how
to estimate training costs, memory needs, and optimize performance using
strategies like data, tensor, pipeline, and expert parallelism. Gain
hands-on experience with LLaMA-3, and learn to profile and debug your
code.</p>
<blockquote>
<p><strong>Three Observations - Sam Altman</strong> [<a
target="_blank" rel="noopener" href="https://blog.samaltman.com/three-observations">Link</a>]</p>
</blockquote>
<p>Sam outlines AI trends: AI’s scaling limits, cost reduction, and the
future of autonomous agents.</p>
<blockquote>
<p><strong>How to deploy and fine-tune DeepSeek models on AWS -
HuggingFace</strong> [<a
target="_blank" rel="noopener" href="https://huggingface.co/blog/deepseek-r1-aws">Link</a>]</p>
</blockquote>
<p>Deploy and fine-tune DeepSeek-R1 models on AWS using Hugging Face
with GPUs, SageMaker, and EC2 Neuron.</p>
<blockquote>
<p><strong>Building a Universal Assistant to connect with any API -
Pranav Dhoolia</strong> [<a
target="_blank" rel="noopener" href="https://medium.com/heurislabs/building-a-universal-assistant-to-connect-with-any-api-89d7c353e524">Link</a>]</p>
</blockquote>
<p>Convert any OpenAPI spec into an MCP-compatible API assistant without
writing custom integration code. Use a generic MCP server to expose API
endpoints dynamically. This approach simplifies integration, expands
compatibility, and makes scaling API support more efficient.</p>
<blockquote>
<p><strong>From PDFs to Insights: Structured Outputs from PDFs with
Gemini 2.0 - Philschmid</strong> [<a
target="_blank" rel="noopener" href="https://www.philschmid.de/gemini-pdf-to-data">Link</a>]</p>
</blockquote>
<p>Learn to convert PDFs into structured JSON using Gemini 2.0. Set up
the SDK, process files, manage tokens, and define JSON schemas with
Pydantic. Covers real-world examples like invoices and forms, best
practices, and cost management, works within the free tier.</p>
<blockquote>
<p><strong>The Hidden Ways We Really Work Together - Microsoft</strong>
[<a
target="_blank" rel="noopener" href="https://www.microsoft.com/en-us/worklab/patterns-hidden-inside-the-org-chart">Link</a>]</p>
</blockquote>
<blockquote>
<p><strong>Managing LLM implementation projects - Piotr
Jurowiec</strong> [<a
target="_blank" rel="noopener" href="https://piotr-jurowiec.medium.com/managing-llm-implementation-projects-2daa0ef5c67a">Link</a>]</p>
</blockquote>
<p>Discover how to implement LLMs from initial planning to deployment.
Establish project goals, select suitable architectures, preprocess data,
train and evaluate models, optimize hyperparameters, and incorporate
domain expertise. Tackle challenges such as hallucinations, security
risks, regulatory compliance, and scalability limitations. Develop
systematic workflows for building and managing LLM-based
applications.</p>
<blockquote>
<p><strong>How to build a ChatGPT-Powered AI tool to learn technical
things fast - AWS</strong> [<a
target="_blank" rel="noopener" href="https://community.aws/content/2hEttGRiSiGwAn2Bzl0lbQcT7v6/build-ai-with-hf-chatgpt">Link</a>]</p>
</blockquote>
<blockquote>
<p><strong>What Problem Does The Model Context Protocol Solve? -
AIhero</strong> [<a
target="_blank" rel="noopener" href="https://www.aihero.dev/what-problem-does-model-context-protocol-solve">Link</a>]</p>
</blockquote>
<p>Learn how the Model Context Protocol (MCP) simplifies integrating
large language models (LLMs) with external APIs.</p>
<p>MCP acts as a connector between LLMs and external data sources,
facilitating interactions with tools without requiring LLMs to
understand intricate APIs. By providing a standardized interface, it
streamlines integrations with platforms like GitHub, enhancing workflow
speed and efficiency.</p>
<blockquote>
<p><strong>Most AI value will come from broad automation, not from
R&amp;D - Epoch AI</strong> [<a
target="_blank" rel="noopener" href="https://epoch.ai/gradient-updates/most-ai-value-will-come-from-broad-automation-not-from-r-d">Link</a>]</p>
</blockquote>
<p>Epoch AI's article argues against the popular notion that the primary
economic benefit of artificial intelligence will stem from its
application in research and development. Instead, the authors posit that
AI's most significant value will arise from its widespread deployment in
automating existing labor across various sectors.</p>
<h2 id="substack">Substack</h2>
<blockquote>
<p><strong>Tencent: Betting Big on AI - App Economy Insights</strong>
[<a
target="_blank" rel="noopener" href="https://www.appeconomyinsights.com/p/tencent-betting-big-on-ai">Link</a>]</p>
</blockquote>
<figure>
<img src="/di-blog/2025/03/04/2025-March/tencent_corporate_overview.png"
alt="tencent_corporate_overview" />
<figcaption aria-hidden="true">tencent_corporate_overview</figcaption>
</figure>
<p>Tencent's proprietary HunYuan framework has developed into a central
AI platform catering to both consumers and enterprises. Originally
centered on text and conversational AI, HunYuan has expanded to support
multimodal capabilities, including image, video, and 3D generation,
where it has attained top rankings in industry benchmarks.</p>
<figure>
<img src="/di-blog/2025/03/04/2025-March/HunYuan_Thesis.png"
alt="HunYuan_Thesis" />
<figcaption aria-hidden="true">HunYuan_Thesis</figcaption>
</figure>
<p>Tencent has a Dual-Core AI strategy: It combines its proprietary T1
model with external AI, such as DeepSeek’s R1, in a “double-core”
approach. Yuanbao chatbot utilizes both—T1 for deep reasoning and R1 for
quick responses—while WeChat Search enhances accuracy by integrating T1
with DeepSeek.</p>
<figure>
<img
src="/di-blog/2025/03/04/2025-March/tencent_multi_model_strategy.png"
alt="tencent_multi_model_strategy" />
<figcaption aria-hidden="true">tencent_multi_model_strategy</figcaption>
</figure>
<blockquote>
<p><strong>Google: Biggest Deal Ever - App Economy Insights</strong> [<a
target="_blank" rel="noopener" href="https://www.appeconomyinsights.com/p/google-biggest-deal-ever">Link</a>]</p>
</blockquote>
<p>Alphabet has completed its largest acquisition to date with a $32
billion deal to acquire cloud security startup Wiz. If successful, this
move could redefine GCP’s security portfolio, strengthening its stance
as AI-driven cloud computing becomes the focal point.</p>
<figure>
<img src="/di-blog/2025/03/04/2025-March/google_biggest_acquisition.png"
alt="google_biggest_acquisition" />
<figcaption aria-hidden="true">google_biggest_acquisition</figcaption>
</figure>
<h2 id="papers-and-reports">Papers and Reports</h2>
<blockquote>
<p><strong>Whitepaper Agents - Authors: Julia Wiesinger, Patrick Marlow
and Vladimir Vuskovic</strong> [<a
target="_blank" rel="noopener" href="https://www.kaggle.com/whitepaper-agents">Link</a>]</p>
</blockquote>
<p>Google’s whitepaper explains how AI agents use reasoning, tools, and
external data to automate tasks, turning large language models (LLMs)
into workflow automation systems. Google suggests using
<strong>LangChain</strong> for prototyping and <strong>Vertex
AI</strong> for scaling production-ready agents. its framework provides
a standardized approach to ensure reliable AI agent execution.</p>
<p><strong>Key Components</strong></p>
<ol type="1">
<li><strong>Decision Engine</strong> – The LLM plans and executes tasks
using reasoning methods like ReAct or Chain-of-Thought.</li>
<li><strong>Tool Integration</strong> – Agents interact with APIs,
databases, and real-time data.</li>
<li><strong>Orchestration Layer</strong> – Manages task execution and
decision-making.</li>
</ol>
<p><strong>Tool Types</strong></p>
<ol type="1">
<li><strong>Extensions</strong> – Directly call APIs for
automation.</li>
<li><strong>Functions</strong> – Allow developers to control
execution.</li>
<li><strong>Data Stores</strong> – Use retrieval-augmented generation
(RAG) for external data access.</li>
</ol>
<p><strong>Use Cases</strong></p>
<p>Agents handle tasks like personalized recommendations, workflow
automation, and database queries. For example, they can fetch a user’s
purchase history and generate tailored responses.</p>
<blockquote>
<p><strong>Introducing <em>smolagents</em>, a simple library to build
agents - HuggingFace</strong> [<a
target="_blank" rel="noopener" href="https://huggingface.co/blog/smolagents">Link</a>]</p>
</blockquote>
<blockquote>
<p><strong>Memory Layers at Scale - Meta</strong> [<a
target="_blank" rel="noopener" href="https://arxiv.org/abs/2412.09764">Link</a>]</p>
</blockquote>
<blockquote>
<p><strong>2 OLMo 2 Furious - Alien AI</strong> [<a
target="_blank" rel="noopener" href="https://arxiv.org/abs/2501.00656">Link</a>]</p>
</blockquote>
<blockquote>
<p><strong>HuatuoGPT-o1, Towards Medical Complex Reasoning with
LLMs</strong> [<a target="_blank" rel="noopener" href="https://arxiv.org/abs/2412.18925">Link</a>]</p>
</blockquote>
<p>This paper shows how to build domain-specific reasoning models using
a two-stage training process. HuatuoGPT-o1, a medical LLM, enhances
complex reasoning using this two-stage approach: (1) supervised
fine-tuning (SFT) with complex Chain-of-Thought (CoT) and (2)
reinforcement learning (RL) using a verifier to refine reasoning.</p>
<figure>
<img src="/di-blog/2025/03/04/2025-March/huatuogpto1.png"
alt="huatuogpto1" />
<figcaption aria-hidden="true">huatuogpto1</figcaption>
</figure>
<blockquote>
<p><strong>Inference-Time Scaling for Diffusion Models beyond Scaling
Denoising Steps - Google DeepMind</strong> [<a
target="_blank" rel="noopener" href="https://arxiv.org/abs/2501.09732">Link</a>]</p>
</blockquote>
<p>Google DeepMind introduces noise search method, outperforming
traditional denoising in diffusion models.</p>
<blockquote>
<p><strong>Chain of Agents: Large language models collaborating on
long-context tasks - Google Research</strong> [<a
target="_blank" rel="noopener" href="https://research.google/blog/chain-of-agents-large-language-models-collaborating-on-long-context-tasks/">Link</a>]
[<a target="_blank" rel="noopener" href="https://openreview.net/pdf?id=LuCLf4BJsr">Paper</a>]</p>
</blockquote>
<blockquote>
<p><strong>SFT Memorizes, RL Generalizes: A Comparative Study of
Foundation Model Post-training - Google DeepMind</strong> [<a
target="_blank" rel="noopener" href="https://tianzhechu.com/SFTvsRL/">Link</a>] [<a
target="_blank" rel="noopener" href="https://arxiv.org/abs/2501.17161v1">Link</a>]</p>
</blockquote>
<p>Explaining why reinforcement learning outperforms supervised
fine-tuning for model generalization.</p>
<blockquote>
<p><strong>Learning to Plan &amp; Reason for Evaluation with
Thinking-LLM-as-a-Judge</strong> [<a
target="_blank" rel="noopener" href="https://arxiv.org/abs/2501.18099">Link</a>]</p>
</blockquote>
<p>A new preference optimization algorithm for LLM-as-a-Judge
models.</p>
<blockquote>
<p><strong>Hallucination Mitigation using Agentic AI Natural
Language-Based Frameworks</strong> [<a
target="_blank" rel="noopener" href="https://arxiv.org/abs/2501.13946v1">Link</a>]</p>
</blockquote>
<p>Generative AI models often produce hallucinations, making them less
reliable and reducing trust in AI systems. In this work, a multi-agent
system is designed using over 300 prompts to induce hallucinations. AI
agents at different levels review and refine outputs using distinct
language models, structured JSON communication, and the OVON framework
for seamless interaction. New KPIs are introduced to measure
hallucination levels.</p>
<blockquote>
<p><strong>ELEGNT: Expressive and Functional Movement Design for
Non-Anthropomorphic Robot - Apple</strong> [<a
target="_blank" rel="noopener" href="https://machinelearning.apple.com/research/elegnt-expressive-functional-movement">Link</a>]
[<a target="_blank" rel="noopener" href="https://arxiv.org/abs/2501.12493">Link</a>]</p>
</blockquote>
<p>This is very cool.</p>
<blockquote>
<p><strong>π0 and π0-FAST: Vision-Language-Action Models for General
Robot Control - Hugging Face</strong> [<a
target="_blank" rel="noopener" href="https://huggingface.co/blog/pi0">Link</a>]</p>
</blockquote>
<p>Hugging Face publishes the first open-source robotics foundation
models for real-world applications.</p>
<blockquote>
<p><strong>Claude’s extended thinking - Anthropic</strong> [<a
target="_blank" rel="noopener" href="https://www.anthropic.com/research/visible-extended-thinking">Link</a>]</p>
</blockquote>
<p>Claude 3.7 Sonnet introduces extended thinking, visible reasoning,
and improved agentic capabilities for complex tasks.</p>
<blockquote>
<p><strong>Can LLMs Generate Novel Research Ideas? A Large-Scale Human
Study with 100+ NLP Researchers</strong> [<a
target="_blank" rel="noopener" href="https://arxiv.org/abs/2409.04109">Link</a>]</p>
</blockquote>
<p>This study evaluated the ability of LLMs to generate novel,
expert-level research ideas compared to human experts by recruiting over
100 NLP researchers for idea generation and blind reviews. Results
showed that LLM-generated ideas were rated as more novel than human
ideas (p &lt; 0.05) but slightly less feasible. While LLMs demonstrated
promising ideation capabilities, challenges such as limited idea
diversity and unreliable self-evaluation were identified, highlighting
areas for improvement in developing effective research agents.</p>
<blockquote>
<p><strong>Transformers without Normalization</strong> [<a
target="_blank" rel="noopener" href="https://jiachenzhu.github.io/DyT/?utm_source=alphasignal">Link</a>]</p>
</blockquote>
<p>Yann LeCun and his team have proposed Dynamic Tanh (DyT) as an
alternative to conventional normalization layers in deep learning
models. This innovative method, leveraging the scaled tanh function,
delivers performance on par with or superior to techniques like
LayerNorm and RMSNorm. Notably, its ability to lower computational costs
while preserving model efficiency makes it particularly compelling.</p>
<blockquote>
<p><strong>Energy</strong> [<a
target="_blank" rel="noopener" href="https://infrastructurereportcard.org/wp-content/uploads/2025/03/Energy.pdf">Link</a>]</p>
</blockquote>
<p>Most serious issues:</p>
<ul>
<li>Aging and overburdened energy infrastructure is the most serious
issue.</li>
<li>Energy demand is at its highest growth rate in 20 years. EV adoption
and AI workloads are accelerating the strain on the grid.</li>
<li>There is increased frequency of extreme weather events causing
outages.</li>
<li>The U.S. experienced twice as many weather-related power outages
from 2014–2023 compared to 2000–2009.</li>
</ul>
<p>Some key trends:</p>
<ul>
<li>Energy demand is rising rapidly, especially due to data centers, AI,
and EV adoption.</li>
<li>Extreme weather is causing more frequent and severe power
outages.</li>
<li>The transition to renewables is accelerating, but grid
interconnection delays are slowing progress.</li>
<li>Grid infrastructure is aging and requires massive investment, but
funding gaps remain.</li>
<li>Transformer shortages and long lead times are hindering grid
expansion and maintenance.</li>
<li>Cybersecurity threats and physical attacks on substations are
emerging risks.</li>
</ul>
<h2 id="youtube-and-podcasts">YouTube and Podcasts</h2>
<blockquote>
<p><strong>Fixing the American Dream with Andrew Schulz - All-In
Podcast</strong> [<a
target="_blank" rel="noopener" href="https://www.youtube.com/watch?v=IjU-Nd6iiQ4&amp;ab_channel=All-InPodcast">Link</a>]</p>
</blockquote>
<blockquote>
<p><strong>E179｜DeepSeek技术解析：为何引发英伟达股价下跌？-
硅谷101播客</strong> [<a
target="_blank" rel="noopener" href="https://www.youtube.com/watch?v=f9Wm1ayTKlQ&amp;ab_channel=%E7%A1%85%E8%B0%B7101%E6%92%AD%E5%AE%A2">Link</a>]</p>
</blockquote>
<blockquote>
<p><strong>This Year in Uber’s AI-Driven Developer Productivity
Revolution - Gradle</strong> [<a
target="_blank" rel="noopener" href="https://www.youtube.com/watch?v=jp-fBw07r7c&amp;t=2s">Link</a>]</p>
</blockquote>
<blockquote>
<p><strong>GraphRAG: The Marriage of Knowledge Graphs and RAG: Emil
Eifrem - AI Engineer</strong> [<a
target="_blank" rel="noopener" href="https://www.youtube.com/watch?v=knDDGYHnnSI">Link</a>]</p>
</blockquote>
<p>Great intro to Graph RAG from Prof Emil Eifrem. Check out <a
target="_blank" rel="noopener" href="https://neo4j.com/labs/genai-ecosystem/">neo4j genai
ecosystem</a>.</p>
<p>Some articles mentioned: "Retrieval-Augmented Generation with
Knowledge Graphs for Customer Service Question Answering" [<a
target="_blank" rel="noopener" href="https://arxiv.org/abs/2404.17723v1">Link</a>], and "GraphRAG:
Unlocking LLM discovery on narrative private data" [<a
target="_blank" rel="noopener" href="https://www.microsoft.com/en-us/research/blog/graphrag-unlocking-llm-discovery-on-narrative-private-data/">Link</a>].</p>
<blockquote>
<p><strong>Building a fully local "deep researcher" with DeepSeek-R1 -
LangChain</strong> [<a
target="_blank" rel="noopener" href="https://www.youtube.com/watch?v=sGUjmyfof4Q">Link</a>]</p>
</blockquote>
<p>This tutorial reviews DeepSeek R1's training methods, explains
downloading the model via Ollama, and demonstrates JSON-mode testing.
Test its local "deep research" assistant, which performs web research
and iterative summarization with reflection for improved results.</p>
<blockquote>
<p><strong>Building Effective Agents with LangGraph - LangChain</strong>
[<a target="_blank" rel="noopener" href="https://www.youtube.com/watch?v=aHCDrAbH_go">Link</a>]</p>
</blockquote>
<p>This video shows the difference between agents and workflows and when
to use each. You'll Implement patterns like prompt chaining,
parallelization, and routing using LangGraph. The session covers
building agents, applying advanced patterns, and understanding how
LangGraph enhances automation and optimization in AI systems.</p>
<blockquote>
<p><strong>Nvidia's GTC 2025 Keynote: Everything Announced in 30 Minutes
- Amrit Talks</strong> [<a
target="_blank" rel="noopener" href="https://www.youtube.com/watch?v=DT5IMxzfdL0&amp;ab_channel=AmritTalks">Link</a>]</p>
</blockquote>
<blockquote>
<p><strong>How I use LLMs - Andrej Karpathy</strong> [<a
target="_blank" rel="noopener" href="https://www.youtube.com/watch?v=EWvNQjAaOHw&amp;ab_channel=AndrejKarpathy">Link</a>]</p>
</blockquote>
<blockquote>
<p><strong>White House BTS, Google buys Wiz, Treasury vs Fed, Space
Rescue - All-In Podcast</strong> [<a
target="_blank" rel="noopener" href="https://www.youtube.com/watch?v=p1MAA8y4CgU&amp;ab_channel=All-InPodcast">Link</a>]</p>
</blockquote>
<blockquote>
<p><strong>Satya Nadella – Microsoft’s AGI Plan &amp; Quantum
Breakthrough - Dwarkesh Partel</strong> [<a
target="_blank" rel="noopener" href="https://www.youtube.com/watch?v=4GLSzuYXh6w&amp;ab_channel=DwarkeshPatel">Link</a>]</p>
</blockquote>
<p>Satya Nadella discusses AI, AGI skepticism, economic growth, quantum
computing, AI pricing, gaming models, and legal challenges. Notes of
insights impressed me:</p>
<ol type="1">
<li>Nadella believes hyperscalers (like Microsoft Azure, AWS, and Google
Cloud) will be major beneficiaries of AI advancements. The exponential
growth in compute demand for AI workloads—both for training and
inference—will drive massive infrastructure needs. Hyperscalers are
well-positioned to meet this demand due to their ability to scale
compute, storage, and AI accelerators efficiently.</li>
<li>He argues that hyperscale infrastructure is not a winner-takes-all
market. Enterprises and corporations prefer multiple suppliers to avoid
dependency on a single vendor. This structural dynamic ensures
competition and prevents monopolization.</li>
<li>While there may be a few dominant closed-source AI models, Nadella
predicts that open-source alternatives will act as a check, preventing
any single entity from monopolizing the AI model space. He draws
parallels to the coexistence of closed-source (e.g., Windows) and
open-source systems in the past.</li>
<li>He highlights that governments worldwide are unlikely to allow
private companies to dominate AI entirely. Regulatory and state
involvement will likely shape the landscape, further preventing a
winner-takes-all scenario.</li>
<li>In consumer markets, network effects can lead to winner-takes-all
dynamics (e.g., ChatGPT's early success). However, in enterprise
markets, multiple players will thrive across different categories.</li>
<li>He disagrees with the notion that AI models or cloud infrastructure
will become commoditized. At scale, the complexity of managing
hyperscale infrastructure and the know-how required to optimize it
create significant barriers to entry and sustain profitability.</li>
<li>Microsoft aims to build a versatile hyperscale fleet capable of
handling large training jobs, inference workloads, and specialized tasks
like reinforcement learning (RL). The company focuses on distributed
computing, global data center placement, and high utilization of
resources to meet diverse AI demands.</li>
<li>Nadella envisions a future where AI agents and specialized models
will drive even greater compute demand. He emphasizes the importance of
building infrastructure that can support both training and inference at
scale, while also accommodating evolving AI research and
development.</li>
<li>Microsoft Research (MSR) has a history of investing in fundamental,
curiosity-driven research, often with no immediate payoff. Nadella
emphasizes the importance of maintaining this culture, even if the
benefits may only materialize decades later. Nadella highlights the
difficulty of transitioning from research breakthroughs to scalable
products. The role of leadership is to ensure that innovations are not
only technically sound but also commercially viable.</li>
<li>Nadella envisions quantum computing being accessed via APIs, similar
to how cloud services are used today. This could democratize access to
quantum capabilities for research and industry.</li>
</ol>
<blockquote>
<p><strong>Instrumenting &amp; Evaluating LLMs - Hamei Husain</strong>
[<a
target="_blank" rel="noopener" href="https://www.youtube.com/watch?v=SnbGD677_u0&amp;ab_channel=HamelHusain">Link</a>]</p>
</blockquote>
<blockquote>
<p><strong>How to Get Your Data Ready for AI Agents (Docs, PDFs,
Websites) - Dave Ebbelaar</strong> [<a
target="_blank" rel="noopener" href="https://www.youtube.com/watch?v=9lBTS5dM27c&amp;ab_channel=DaveEbbelaar">Link</a>]</p>
</blockquote>
<blockquote>
<p><strong>The AI Cold War, Signalgate, CoreWeave IPO, Tariff Endgames,
El Salvador Deportations - All-In Podcast</strong> [<a
target="_blank" rel="noopener" href="https://www.youtube.com/watch?v=Iazo7g40VbQ&amp;ab_channel=All-InPodcast">Link</a>]</p>
</blockquote>
<h2 id="github">Github</h2>
<blockquote>
<p><strong>a smol course - HuggingFace</strong> [<a
target="_blank" rel="noopener" href="https://github.com/huggingface/smol-course">Link</a>]</p>
</blockquote>
<p>Good course to help you to align LLM with specific use cases. It
includes instruction tuning, preference alignment using DPO/ORPO, LoRA,
prompt tuning, and multimodal model adaptation, and it covers creating
synthetic datasets, evaluation, and efficient inference.</p>
<blockquote>
<p><strong>AI Hedge Fund</strong> [<a
target="_blank" rel="noopener" href="https://github.com/virattt/ai-hedge-fund">Link</a>]</p>
</blockquote>
<p>POC for educational purposes.</p>
<blockquote>
<p><strong>build-your-own-x</strong> [<a
target="_blank" rel="noopener" href="https://github.com/codecrafters-io/build-your-own-x">Link</a>]</p>
</blockquote>
<p>Interesting resources / tutorials for building technologies from
scratch to deepen practical understanding.</p>
<blockquote>
<p><strong>Open R1- HuggingFace</strong> [<a
target="_blank" rel="noopener" href="https://github.com/huggingface/open-r1">Link</a>]</p>
</blockquote>
<p>A fully open reproduction of DeepSeek-R1.</p>
<blockquote>
<p><strong>AI Tutor Using RAG, Vector DB, and Groq</strong> [<a
target="_blank" rel="noopener" href="https://colab.research.google.com/drive/1ZdVuxLTEkQJrV6EdZwEqtvoRkGF4FOY0">Link</a>]</p>
</blockquote>
<blockquote>
<p><strong>GenAI Agents: Comprehensive Repository for Development and
Implementation</strong> [<a
target="_blank" rel="noopener" href="https://github.com/NirDiamant/GenAI_Agents">Link</a>]</p>
</blockquote>
<blockquote>
<p><strong>DeepSeek Open Infra</strong> [<a
target="_blank" rel="noopener" href="https://github.com/deepseek-ai/open-infra-index/tree/main">Link</a>]</p>
</blockquote>
<blockquote>
<p><strong>Awesome MCP Servers</strong> [<a
target="_blank" rel="noopener" href="https://github.com/punkpeye/awesome-mcp-servers">Link</a>]</p>
</blockquote>
<p>This repository provides access to a selection of curated Model
Context Protocol (MCP) servers designed for seamless AI model-resource
interaction. It features both production-ready and experimental servers,
offering capabilities like file access, database connections, and API
integrations. There are frameworks, tutorials, and practical tips to
enhance model deployment and maximize resource efficiency in real-world
applications.</p>
<h2 id="news">News</h2>
<blockquote>
<p><strong>Replit Integrates xAI</strong> [<a
target="_blank" rel="noopener" href="https://docs.replit.com/updates/2025/03/07/changelog#xai-integration">Link</a>]</p>
</blockquote>
<blockquote>
<p><strong>Expand your research with proprietary financial data -
Perplexity</strong> [<a
target="_blank" rel="noopener" href="https://www.perplexity.ai/enterprise/crunchbase-factset-integration">Link</a>]</p>
</blockquote>
<p>Crunchbase, FactSet, and DeepSeek R1 now power enterprise
insights.</p>
<blockquote>
<p><strong>Google to acquire cloud security startup Wiz for $32 billion
after deal fell apart last year - CNBC</strong> [<a
target="_blank" rel="noopener" href="https://www.cnbc.com/2025/03/18/google-to-acquire-cloud-security-startup-wiz-for-32-billion.html">Link</a>]</p>
</blockquote>
<blockquote>
<p><strong>Leave it to Manus - Manus</strong> [<a
target="_blank" rel="noopener" href="https://manus.im/">Link</a>]</p>
</blockquote>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://jokerdii.github.io/di-blog/2025/02/09/Daring-Greatly/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/di-blog/images/avatar.gif">
      <meta itemprop="name" content="Di Zhen">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Di's Blog">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Di's Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/di-blog/2025/02/09/Daring-Greatly/" class="post-title-link" itemprop="url">Daring Greatly</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2025-02-09 21:53:40" itemprop="dateCreated datePublished" datetime="2025-02-09T21:53:40-05:00">2025-02-09</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>I just finished reading "Daring Greatly: How the Courage to Be
Vulnerable Transforms the Way We Live, Love, Parent, and Lead" by Brené
Brown. This is the second book of hers I have read. Her words feel like
whispers from God.</p>
<p>What she says about wholeheartedness:</p>
<blockquote>
<p>“Wholehearted living is about engaging in our lives from a place of
worthiness. It means cultivating the courage, compassion, and connection
to wake up in the morning and think, No matter what gets done and how
much is left undone, I am enough. It's going to bed at night thinking,
Yes, I am imperfect and vulnerable and sometimes afraid, but that
doesn't change the truth that I am also brave and worthy of love and
belonging.”</p>
</blockquote>
<p>What she says about vulnerability:</p>
<blockquote>
<p>“Vulnerability is based on mutuality and requires boundaries and
trust. It's not oversharing, it's not purging, it's not indiscriminate
disclosure, and it's not celebrity-style social media information dumps.
Vulnerability is about sharing our feelings and our experiences with
people who have earned the right to hear them. Being vulnerable and open
is mutual and an integral part of the trust-building process.”</p>
</blockquote>
<blockquote>
<p>“If we're going to find our way out of shame and back to each other,
vulnerability is the path and courage is the light. To set down those
lists of what we're supposed to be is brave. To love ourselves and
support each other in the process of becoming real is perhaps the
greatest single act of daring greatly.”</p>
</blockquote>
<p>What she says about perfectionism: (I love this part!)</p>
<blockquote>
<p>“The problem was thankfully never fixed, and in time the box
overflowed as more and more art piled up. I think the dilemma exists
because art, among all the other tidy categories, most closely resembles
what it is like to be human. To be alive. It is our nature to be
imperfect. To have uncategorized feelings and emotions. To make or do
things that don't sometimes necessarily make sense.</p>
<p>Art is all just perfectly imperfect.</p>
<p>My fixation with these words from Leonard Cohen's song "Anthem" comes
from how much comfort and hope they give me as I put "enough" into
practice: "There's a crack in everything. That's how the light gets
in."”</p>
</blockquote>
<p>What she says about oversharing:</p>
<blockquote>
<p>“It's an important question, and the answer is that I don't tell
stories or share vulnerabilities with the public until I've worked
through them with the people I love. I have my own boundaries around
what I share and what I don't share and I stay mindful of my
intentions.</p>
<p>First, I only share stories or experiences that I've worked through
and feel that I can share from solid ground. I don't share what I define
as "intimate" stories, nor do I share stories that are fresh wounds.</p>
<p>Second, I follow the rule that I learned in my graduate social work
training. Sharing yourself to teach or move a process forward can be
healthy and effective, but disclosing information as a way to work
through your personal stuff is inappropriate and unethical.</p>
<p>Last, I only share when I have no unmet needs that I'm trying to
fill. I firmly believe that being vulnerable with a larger audience is
only a good idea if the healing is tied to the sharing, not to the
expectations I might have for the response I get.</p>
</blockquote>
<p>What she says about disengagement:</p>
<blockquote>
<p>“Disengagement is the issue underlying the majority of problems I see
in families, schools, communities, and organizations and it takes many
forms, including the ones we discussed in the "Armory" chapter. We
disengage to protect ourselves from vulnerability, shame, and feeling
lost and without purpose. We also disengage when we feel like the people
who are leading us—our boss, our teachers, our principal, our clergy,
our parents, our politicians-aren't living up to their end of the social
contract.”</p>
</blockquote>
<blockquote>
<p>“The gap starts here: We can't give people what we don't have. Who we
are matters immeasurably more than what we know or who we want to be.
The space between our practiced values (what we're actually doing,
thinking, and feeling) and our aspirational values (what we want to do,
think, and feel) is the value gap, or what I call "the disengagement
divide." It's where we lose our employees, our clients, our students,
our teachers, our congregations, and even our own children.”</p>
</blockquote>
<p>What she says about vulnerabilities in Sales:</p>
<blockquote>
<p>“My answer was no. And yes. In that scenario vulnerability is
recognizing and owning that you don't know something; it's looking the
customer in the eye and saying, "I don't know the answer to that, but
I'll find out. I want to make sure you have the correct information." I
explained that the unwillingness to engage with the vulnerability of not
knowing often leads to making excuses, dodging the question,
or-worst-case scenario-bullshitting. That's the deathblow in any
relationship, and the one thing I've learned from talking to people who
sell for a living is that sales is all about relationships.”</p>
</blockquote>
<p>And her Daring Greatly Leadership Manifesto:</p>
<blockquote>
<p>“To the CEOs and teachers. To the principals and the managers. To the
politicians, community leaders, and decision makers:</p>
<p>We want to show up, we want to learn, and we want to inspire.</p>
<p>We are hardwired for connection, curiosity, and engagement.</p>
<p>We crave purpose, and we have a deep desire to create and
contribute.</p>
<p>We want to take risks, embrace our vulnerabilities, and be
courageous.</p>
<p>When learning and working are dehumanized, when you no longer see us
and no longer encourage our daring, or when you only see what we produce
or how we perform, we disengage and turn away from the very things that
the world needs from us: our talent, our ideas, and our passion.</p>
<p>What we ask is that you engage with us, show up beside us, and learn
from us.</p>
<p>Feedback is a function of respect; when you don't have honest
conversations with us about our strengths and our opportunities for
growth, we question our contributions and your commitment.</p>
<p>Above all else, we ask that you show up, let yourself be seen, and be
courageous. Dare Greatly with us.”</p>
</blockquote>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://jokerdii.github.io/di-blog/2025/02/02/2025-February/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/di-blog/images/avatar.gif">
      <meta itemprop="name" content="Di Zhen">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Di's Blog">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Di's Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/di-blog/2025/02/02/2025-February/" class="post-title-link" itemprop="url">2025 February - What I Have Read</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2025-02-02 13:20:26" itemprop="dateCreated datePublished" datetime="2025-02-02T13:20:26-05:00">2025-02-02</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h2 id="substack">Substack</h2>
<blockquote>
<p><em>The key aspect of managing up is to learn to speak the language
of your counterpart. If you can speak their language you can understand
their goals and fears, and you can communicate at the level they are.
You'll be in a better position to be an effective report.</em> <em>— <a
target="_blank" rel="noopener" href="https://www.linkedin.com/in/umberto-nicoletti/">Umberto
Nicoletti</a>, Head of R&amp;D at Proemion</em></p>
<p><em>The better we understand the goals that our managers have, the
less surprising their actions will be. […] Some of the situations where
managers act in ways that most dismay or surprise us are when they are
acting on their fears and worries. - <a
target="_blank" rel="noopener" href="https://monkeysthumb.co.uk/">Joe Chippindale</a>, CTO
Coach</em></p>
<p><strong>― Frameworks for Managing Up as a Software Engineer - High
Growth Engineer</strong> [<a
target="_blank" rel="noopener" href="https://read.highgrowthengineer.com/p/frameworks-for-managing-up-as-an-engineer">Link</a>]</p>
</blockquote>
<p><strong>Building Trust</strong>:</p>
<ol type="1">
<li>Sincerity — you are honest and transparent, even when it’s
uncomfortable. This includes admitting mistakes early, being upfront
with challenges, and sharing both good and bad news, without
sugar-coating the latter.</li>
<li>Reliability — this is about consistency and following through. You
do what you say you'll do, you set realistic expectations, and
communicate proactively through regular update habits. More on this
later in the <em>updates</em> section.</li>
<li>Care — you have their best interests in mind. This means
understanding their goals and challenges, being proactive in helping
them succeed, and showing empathy when things get tough.</li>
<li>Competence — finally, you deliver results. This goes beyond
technical skills: it's about delivering business value, learning and
growing from feedback, and understanding the big picture.</li>
</ol>
<p><strong>Speaking their language</strong>:</p>
<ol type="1">
<li><p><strong>Map their context</strong></p>
<ol type="1">
<li>What makes <em>you</em> successful? — What are your goals and
concerns?</li>
<li>What makes <em>me</em> successful? — How can I help you reach your
goals?</li>
</ol>
<p>The only way for <em>you</em> to be successful is to make <em>your
manager</em> successful. To do that, you need to be able to map your
goals and concerns into their own.</p></li>
<li><p><strong>Translate impact across altitudes</strong></p>
<p>For any item you report to your manager, the question you should ask
yourself is: <em>why</em> should my manager care about this? And, more
subtly: <em>what</em> does my manager care about this?</p></li>
<li><p><strong>Create explicit agreements</strong></p>
<ol type="1">
<li>Scope of ownership — do you know what decisions you can make
autonomously vs when you need to involve your manager?</li>
<li>Success criteria — how do you know if what you do is successful? Do
you know how impact will be measured?</li>
<li>Mutual expectations — do you know what your manager needs from you?
And do they know what you need from them?</li>
</ol></li>
</ol>
<p><strong>Creating effective updates</strong></p>
<ol type="1">
<li><p><strong>Define your update stack</strong></p>
<ol type="1">
<li>Async messages (daily) — about significant progress or
blockers.</li>
<li>Written reports (weekly) — structured updates about key results and
next steps.</li>
<li>1:1s (weekly or biweekly) — deeper conversations about growth,
wellbeing, and strategy.</li>
</ol></li>
<li><p><strong>Make every update count</strong></p>
<ol type="1">
<li>Why does this matter to my manager?</li>
<li>What should they do with this information?</li>
</ol></li>
<li><p><strong>Build a feedback loop</strong></p>
<p>Use 1:1s, retrospectives, and feedback moments to inspect your update
process: what's working? What feels like noise? What critical
information is missing?</p></li>
</ol>
<blockquote>
<p><strong>JD Vance's AI Summit Paris Speech - Artificial Intelligence
Survey</strong> [<a
target="_blank" rel="noopener" href="https://futuresin.substack.com/p/jd-vance-speech-ai-summit-paris">Link</a>]
[<a target="_blank" rel="noopener" href="https://www.youtube.com/watch?v=64E9O1Gv99o">YouTube</a>]</p>
</blockquote>
<p>Here are some of JD Vance's main points regarding AI, on behalf of
the Trump Administration:</p>
<ul>
<li>Vance emphasizes AI's potential for revolutionary applications and
economic innovation and advocates against being too risk-averse. This is
the main stance of this optimistic speech - more of AI opportunity, less
of AI safety.</li>
<li>He states the administration aims to ensure American AI technology
remains the gold standard and the U.S. is the preferred partner for AI
expansion. The U.S. wants to partner with other countries in the AI
revolution with openness and collaboration, but this requires
international regulatory regimes that foster creation rather than
strangling it.</li>
<li>He expresses concern that excessive regulation could stifle the AI
industry and supports a deregulatory approach. He mentions the
development of an AI action plan that avoids overly precautionary
regulatory regimes, while ensuring that all Americans benefit from the
technology and its transformative potential. The administration is
troubled by foreign governments tightening regulations on U.S. tech
companies with international footprints. Vance states that preserving an
open regulatory environment has encouraged American innovators to
experiment.</li>
<li>He stresses that American AI should not be co-opted for
authoritarian censorship and should be free from ideological bias.</li>
<li>He notes the importance of building the most powerful AI systems in
the U.S. with American-designed and manufactured chips.</li>
<li>He believes AI should be a tool for job creation and making workers
more productive, prosperous, and free. The administration will always
center American workers in its AI policy and ensure that AI makes
workers more productive. For all major AI policy decisions coming from
the federal government, the Trump Administration will guarantee American
workers a seat at the table.</li>
</ul>
<figure>
<img
src="/di-blog/2025/02/02/2025-February/ai_action_submit_jd_tweets.png"
alt="ai_action_submit_jd_tweets" />
<figcaption aria-hidden="true">ai_action_submit_jd_tweets</figcaption>
</figure>
<blockquote>
<p><strong>Elon Musk Blocked a Bill to Stop Amazon from Helping Kids
Kill Themselves - BIG by Matt Stoller</strong> [<a
target="_blank" rel="noopener" href="https://www.thebignewsletter.com/p/elon-musk-blocked-a-bill-to-stop">Link</a>]</p>
</blockquote>
<p>In December, Elon Musk pushed for the reduction of government funding
legislation, which led to the removal of several provisions. One
provision removed due to Musk's intervention was the <strong>Youth
Poisoning Prevention Act</strong>, which would have prevented consumers
from buying concentrated sodium nitrite, a chemical often used in
teenage suicides. This chemical, while used in low concentrations as a
food preservative, is lethal in high concentrations and has no household
uses.</p>
<p>The article highlights that Musk, who has significant political
power, can make harmful mistakes, sometimes unknowingly. The author
notes that the removal of the provision was considered a mistake that
could be fixed. Despite bipartisan support for the priorities, there has
been no action taken to reinstate them. He questions whether anyone will
address and rectify the issues that arise from actions taken by figures
like Musk and Trump.</p>
<blockquote>
<p><strong>Deep Research, information vs. insight, and the nature of
science - Interconnects</strong> [<a
target="_blank" rel="noopener" href="https://www.interconnects.ai/p/deep-research-information-vs-insight-in-science">Link</a>]</p>
</blockquote>
<p>This is a very interesting point: the article considers how AI might
challenge Thomas Kuhn's theories of scientific revolutions. Kuhn's
<em>The Structure of Scientific Revolutions</em> describes how science
evolves, with scientists forming <strong>paradigms</strong> around
theories and using them to gain knowledge until limitations necessitate
a new paradigm. Here's how AI might challenge Kuhn's theories:</p>
<ul>
<li>AI is accelerating scientific progress, potentially faster than
paradigms can be established. The fundamental unit of scientific
progress is reducing so quickly that it redefines experimentation
methods.</li>
<li>Kuhn emphasizes that scientific knowledge is a process, not a set of
fixed ideas. AI's emergence challenges this.</li>
<li>Kuhn suggests science is done by a community that slowly builds out
the frontier of knowledge, rather than filling in a known space. The
article questions how the dynamics of science will change with AI
systems.</li>
<li>Kuhn states that to reject one paradigm requires the simultaneous
substitution of another. The article implies that AI's rapid
advancements may disrupt this process.</li>
</ul>
<blockquote>
<p><em>Check out <a target="_blank" rel="noopener" href="https://www.wired.com/tag/elon-musk/">this
impressive list</a> of stories they’ve broken since Trump took
office:</em></p>
<ul>
<li><em><a
target="_blank" rel="noopener" href="https://www.wired.com/story/plaintext-trump-musk-us-digital-service-doge/">Elon
Musk Plays DOGE Ball—and Hits America’s Geek Squad</a> (Steven Levy,
1/22/25)</em></li>
<li><em><a
target="_blank" rel="noopener" href="https://www.wired.com/story/doge-elon-musk/?_sp=8deced32-408d-4fd0-8b2f-aacda4ff2a0a.1738769208605">DOGE
Will Allow Elon Musk to Surveil the US Government From the Inside</a>
(Vittoria Elliott, 1/24/25)</em></li>
<li><em><a
target="_blank" rel="noopener" href="https://www.wired.com/story/elon-musk-lackeys-office-personnel-management-opm-neuralink-x-boring-stalin/?_sp=246a8187-8e09-45b8-bc25-ec0a6c86df8a.1738769551792">Elon
Musk Lackeys Have Taken Over the Office of Personnel Management</a>
(Vittoria Elliott, 1/28/25)</em></li>
<li><em><a
target="_blank" rel="noopener" href="https://www.wired.com/story/elon-musk-twitter-playbook-federal-government/">Elon
Musk Is Running the Twitter Playbook on the Federal Government</a> (Zoë
Schiffer, 1/28/25)</em></li>
<li><em><a
target="_blank" rel="noopener" href="https://www.wired.com/story/elon-musk-sleeping-doge-office/">Elon
Musk Tells Friends He’s Sleeping at the DOGE Offices in DC</a> (Zoë
Schiffer, 1/29/25)</em></li>
<li><em><a
target="_blank" rel="noopener" href="https://www.wired.com/story/elon-musk-government-tech-workers-gsa-tts/">Government
Tech Workers Forced to Defend Projects to Random Elon Musk Bros</a>
(Makena Kelly, Vittoria Elliott, 1/30/25)</em></li>
<li><em><a
target="_blank" rel="noopener" href="https://www.wired.com/story/elon-musk-lackeys-general-services-administration/">Elon
Musk’s Friends Have Infiltrated Another Government Agency</a> (Makena
Kelly, Zoë Schiffer, 1/31/25)</em></li>
<li><em><a
target="_blank" rel="noopener" href="https://www.wired.com/story/us-government-websites-are-disappearing-in-real-time/">US
Government Websites Are Disappearing in Real Time</a> (Vittoria Elliott,
Dhruv Mehrotra, Dell Cameron, 2/1/25)</em></li>
<li><em><a
target="_blank" rel="noopener" href="https://www.wired.com/story/doge-hr-elon-musk-resignation-fork-road-leaked-staff-meeting/">DOGE
Staff Had Questions About the ‘Resign’ Email. Their New HR Chief Dodged
Them</a> (Makena Kelly, 2/1/25)</em></li>
<li><em><a
target="_blank" rel="noopener" href="https://www.wired.com/story/elon-musk-government-young-engineers/">The
Young, Inexperienced Engineers Aiding Elon Musk’s Government
Takeover</a> (Vittoria Elliott, 2/2/25)</em></li>
<li><em><a
target="_blank" rel="noopener" href="https://www.wired.com/story/pronouns-removed-government-email-signatures/">Pronouns
Are Being Forcibly Removed From Government Signatures</a> (Dell Cameron,
2/3/25)</em></li>
<li><em><a
target="_blank" rel="noopener" href="https://www.wired.com/story/elon-musk-lieutenant-gsa-ai-agency/">Elon
Musk Ally Tells Staff ‘AI-First’ Is the Future of Key Government
Agency</a> (Makena Kelly, 2/3/25)</em></li>
<li><em><a
target="_blank" rel="noopener" href="https://www.wired.com/story/usaid-researchers-email-access/">Elon
Musk’s DOGE Is Still Blocking HIV/AIDS Relief Exempted From Foreign Aid
Cuts</a> (Kate Knibbs, 2/3/25)</em></li>
<li><em><a
target="_blank" rel="noopener" href="https://www.wired.com/story/elon-musk-associate-bfs-federal-payment-system/">A
25-Year-Old With Elon Musk Ties Has Direct Access to the Federal Payment
System</a> (Vittoria Elliott, Dhruv Mehrotra, Leah Feiger, Tim Marchman,
2/4/25)</em></li>
<li><em><a
target="_blank" rel="noopener" href="https://www.wired.com/story/federal-workers-sue-over-doge-server/">Federal
Workers Sue to Disconnect DOGE Server</a> (Dell Cameron,
2/4/25)</em></li>
<li><em><a
target="_blank" rel="noopener" href="https://www.wired.com/story/chaos-usaid-staffers-sent-home/">State
Department Puts ‘All Direct Hire’ USAID Personnel on Administrative
Leave</a> (Kate Knibbs, 2/4/25)</em></li>
<li><em><a
target="_blank" rel="noopener" href="https://www.wired.com/story/trump-aides-concern-musk-takeover/">Elon
Musk’s Takeover Is Causing Rifts in Donald Trump’s Inner Circle</a>
(Jake Lahut, 2/5/25)</em></li>
</ul>
<p><strong>When It Comes to Covering Musk's Government Takeover, WIRED
Is Showing Everyone How It's Done - The Present Age</strong> [<a
target="_blank" rel="noopener" href="https://www.readtpa.com/p/when-it-comes-to-covering-musks-government">Link</a>]</p>
<p><strong>The Media Is Missing the Story: Elon Musk Is Staging a Coup -
The Present Age</strong> [<a
target="_blank" rel="noopener" href="https://www.readtpa.com/p/the-media-is-missing-the-story-elon">Link</a>]</p>
</blockquote>
<p>Mainstream media is refusing to tell the truth. WIRED deserves
support.</p>
<p>"<a
target="_blank" rel="noopener" href="https://bookshop.org/p/books/character-limit-how-elon-musk-destroyed-twitter-kate-conger/21224329"><em>Character
Limit - How Elon Musk Destroyed Twitter</em></a>" by Kate Conger and
Ryan Mac, as a reference.</p>
<blockquote>
<p><strong>2025: the Year of Datacenter Mania - AI Supremacy</strong>
[<a
target="_blank" rel="noopener" href="https://www.ai-supremacy.com/p/2025-year-of-datacenter-mania">Link</a>]</p>
</blockquote>
<p>This is an overview of what's happening and going to happen around
Data Center Construction, covering a wide range of areas.</p>
<p><strong>AI Expansion and Energy Demand:</strong></p>
<p>The AI race is intensifying, leading to significant capital
expenditure by Big Tech and raising concerns about potential harmful
consequences. AI data centers' power demands are rapidly increasing,
with estimates of needing 10 gigawatts of additional capacity in 2025
alone.</p>
<p>Goldman Sachs Research projects a 165% increase in data center power
demand by 2030. By 2027, global AI data center power demand could reach
68 GW and 327 GW by 2030, compared to a total global data center
capacity of 88 GW in 2022. Training AI models could require up to 1 GW
in a single location by 2028 and 8 GW by 2030.</p>
<p><strong>Infrastructure and Logistical Challenges:</strong></p>
<p>Power infrastructure delays are increasing wait times for grid
connections, which can take four to seven years in key regions. Data
centers face struggles with local and state permits, especially for
backup generators and environmental impact assessments.</p>
<p>A lack of data center infrastructure in the U.S. could cause a shift
of construction to other countries. Countries with greater compute
access may gain economic and military advantages.</p>
<p><strong>Environmental and Health Concerns:</strong></p>
<p>There are growing concerns that the impact of data centers on human
health is being overlooked, and one of President Biden's executive
orders acknowledges that data centers are harmful to health.</p>
<p>The environmental cost of AI includes concerns about water
consumption, air pollution, electronic waste, and critical materials, in
addition to public health concerns around pollution.</p>
<p><strong>Energy Solutions and the Nuclear Option:</strong></p>
<p>To meet AI’s growing power needs, some experts advocate for nuclear
energy as the most viable long-term solution. Nuclear energy produces no
carbon emissions during operation and offers a reliable, constant energy
supply. Tech giants like Microsoft and Google are recognizing nuclear
energy’s potential, with Microsoft exploring small modular reactors
(SMRs). The adoption of nuclear energy faces obstacles such as high
upfront costs, regulatory hurdles, and public skepticism.</p>
<p><strong>Global AI Race and Investments:</strong></p>
<p>The EU is mobilizing $200 billion in AI investments, signifying a
global race for AI leadership. The UAE is investing billions in AI data
centers in France and is implicated, along with SoftBank and Oracle, in
OpenAI's data center project in Abilene, Texas.</p>
<p><strong>The Question of Sustainability:</strong></p>
<p>AI's rapid expansion is testing the limits of power infrastructure,
natural resources, and sustainability efforts. If AI continues to expand
at its current rate, there is a risk of a gridlocked future limited by
energy availability. The future of AI depends on sustainability and the
willingness to sacrifice energy for intelligence.</p>
<blockquote>
<p><strong>Amazon: Outspending Everyone - App Economy Insights</strong>
[<a
target="_blank" rel="noopener" href="https://www.appeconomyinsights.com/p/amazon-outspending-everyone">Link</a>]</p>
</blockquote>
<p>Some highlights:</p>
<ol type="1">
<li>Amazon is planning to invest over $100 billion in 2025, primarily in
AI-related infrastructure. This is more than any other company, and a
20% increase from 2024.</li>
<li>AWS revenue grew 19% Y/Y, and roughly half of the growth is
attributed to AI. AWS has a 30% market share in cloud infrastructure.
Amazon is focused on custom silicon (Trainium and Inferentia) to improve
AI efficiency.</li>
<li>The <strong>de minimis exemption</strong>, which allows imports
under $800 to avoid US tariffs, gives companies like Shein and Temu a
competitive edge. <strong>Amazon Haul</strong> was launched last year to
compete directly with these companies. Should the de minimis loophole be
eliminated, Amazon's superior logistics network could give it an
advantage in fulfillment and reliability.</li>
<li><strong>Amazon Prime's multi-faceted membership</strong> is highly
effective at reducing churn. A 2022 <a
target="_blank" rel="noopener" href="https://downloads.ctfassets.net/0o6s67aqvwnu/2cEHaMphwzN7d2L5PtnUZF/05818aacde67374a914e04e7dc024ac7/NRG_ThoughtLeadership-Subscriptions-Final_Version.pdf">study</a>
by the National Research Group found that <strong>Prime has one of the
lowest churn rates</strong>, second only to cloud storage and music
streaming services. Amazon's detailed purchase data provides advertisers
with a valuable advantage, enabling highly targeted CTV ads with
industry-leading returns on ad spend (ROAS).</li>
</ol>
<blockquote>
<p><strong><em>Uber’s Three-Pronged AV Strategy:</em></strong></p>
<ol type="1">
<li><em><strong>Fleet partnerships:</strong> Uber isn’t building its own
AVs. Instead, it partners with companies like Waymo, Motional, and
Aurora, integrating their fleets into Uber’s network.</em></li>
<li><em><strong>Hybrid model:</strong> AVs can’t handle all trips—human
drivers will fill gaps, handling extreme weather, complex routes, and
peak hours for decades.</em></li>
<li><em><strong>Fleet infrastructure:</strong> Uber is investing in
charging depots and fleet management to maximize AV asset
utilization.</em></li>
</ol>
<p><em>While Tesla is vertically integrated, its rideshare strategy may
take a different path. If Tesla adopts an asset-light model, Tesla
owners—not Tesla itself—would decide whether to list their AVs on Uber.
If maximum utilization is the goal, Uber could be the logical
choice.</em></p>
<p><em>When it comes to demand aggregation, Uber remains the undisputed
leader—its network effects ensure that as long as it aggregates supply,
demand will follow, and gross profit will scale.</em></p>
<p><em>While the rideshare market will become more fragmented, Uber
could still be the biggest fish in a much larger pond. After all, Uber
is already the Airbnb for cars.</em></p>
<p><em>Tesla has a massive opportunity once the pieces fall into place.
But with auto sales under pressure and market share declining, it still
faces a long road ahead before claiming the top spot in any
market.</em></p>
<p><strong>― Tesla vs. Uber: Collision Course? - App Economy
Insights</strong> [<a
target="_blank" rel="noopener" href="https://www.appeconomyinsights.com/p/tesla-vs-uber-collision-course">Link</a>]</p>
</blockquote>
<p>Uber's business model is one of my favorite business models. Not only
because it's asset-light, its network effect, etc, but also because it
created millions of jobs.</p>
<p>Uber's AV strategy is designed to balance innovation with
practicality, ensuring that the company remains competitive while
minimizing risks and costs. By leveraging partnerships, maintaining a
hybrid model, and investing in infrastructure, Uber is well-positioned
to lead the transition to autonomous mobility.</p>
<p>While a partnership between Uber and Tesla is possible and could
offer significant synergies, it is not guaranteed. The decision would
depend on whether both companies can align their goals and overcome
competitive tensions. If Tesla decides to prioritize its own
ride-hailing network (Tesla Network), it may choose to compete rather
than collaborate with Uber. However, if Tesla sees more value in
leveraging Uber’s platform and customer base, a partnership could be a
strategic move for both companies.</p>
<figure>
<img src="/di-blog/2025/02/02/2025-February/uber_investor_pre.png"
alt="uber_investor_pre" />
<figcaption aria-hidden="true">uber_investor_pre</figcaption>
</figure>
<blockquote>
<p><strong>Microsoft: AI Efficiency Paradox - App Economy
Insights</strong> [<a
target="_blank" rel="noopener" href="https://www.appeconomyinsights.com/p/microsoft-ai-demand-paradox">Link</a>]</p>
</blockquote>
<blockquote>
<p><strong>Google: Capex Arms Race - App Economy Insights</strong> [<a
target="_blank" rel="noopener" href="https://www.appeconomyinsights.com/p/google-capex-arms-race">Link</a>]</p>
</blockquote>
<blockquote>
<p><strong>The End of Search, The Beginning of Research - One Useful
Thing</strong> [<a
target="_blank" rel="noopener" href="https://www.oneusefulthing.org/p/the-end-of-search-the-beginning-of">Link</a>]</p>
</blockquote>
<blockquote>
<p><strong><em>Huang’s take:</em></strong> <em>“We've really only tapped
consumer AI and search and some amount of consumer generative AI,
advertising, recommenders, kind of the early days of software. […]
Future reasoning models can consume much more compute.”</em></p>
<p><em>DeepSeek-R1, he said, has “ignited global enthusiasm” and will
push reasoning AI into even more compute-intensive
applications.</em></p>
<p><strong>― NVIDIA: AI's 3 Scaling Laws - App Economy Insights</strong>
[<a
target="_blank" rel="noopener" href="https://www.appeconomyinsights.com/p/nvidia-ais-3-scaling-laws">Link</a>]</p>
</blockquote>
<p>Huang introduced a framework for AI’s evolving compute demands,
outlining three scaling laws:</p>
<ul>
<li><strong>Pre-training scaling:</strong> Traditional model growth
through data consumption, now enhanced by multimodal learning and
reasoning-based data.</li>
<li><strong>Post-training scaling:</strong> The fastest-growing compute
demand, driven by reinforcement learning from human and AI feedback.
This phase now exceeds pre-training in compute usage due to the
generation of synthetic data.</li>
<li><strong>Inference &amp; reasoning scaling:</strong> The next major
shift, where AI engages in complex reasoning (e.g., chain-of-thought,
search). Inference already requires 100x more compute than early LLMs
and could scale to millions of times more.</li>
</ul>
<p>Jensen Huang outlined a three-layer AI transformation across
industries:</p>
<ul>
<li><strong>Agentic AI (Enterprise AI):</strong> AI copilots and
automation tools boosting productivity in sectors like automotive,
finance, and healthcare.</li>
<li><strong>Physical AI (AI for Machines):</strong> AI-driven training
systems for robotics, warehouses, and autonomous vehicles.</li>
<li><strong>Robotic AI (AI in the Real World):</strong> AI enabling
real-world interaction and navigation, from self-driving cars to
industrial robots.</li>
</ul>
<blockquote>
<p><strong>Grab: The Uber Slayer - App Economy Insights</strong> [<a
target="_blank" rel="noopener" href="https://www.appeconomyinsights.com/p/grab-the-uber-slayer">Link</a>]</p>
</blockquote>
<blockquote>
<p><em>DeepSeek isn’t a threat—it’s <strong>validation</strong>. If AI
inference costs are falling, Meta stands to benefit more than almost any
other company. Instead of challenging its strategy, DeepSeek reinforces
that heavy AI investments will pay off—not the other way
around.</em></p>
<p><strong>― Meta: DeepSeek Tailwinds - App Economy Insights</strong>
[<a
target="_blank" rel="noopener" href="https://www.appeconomyinsights.com/p/meta-deepseek-tailwinds">Link</a>]</p>
</blockquote>
<blockquote>
<p><strong>Elon Musk and spiky intelligence - Silver Bulletin</strong>
[<a
target="_blank" rel="noopener" href="https://www.natesilver.net/p/elon-musk-and-spiky-intelligence">Link</a>]</p>
</blockquote>
<p>Interesting study on spiky intelligence, using Elon as a case study.
Concepts highlights:</p>
<p><strong>Spiky Intelligence</strong>: This refers to individuals who
exhibit exceptional abilities in certain areas while being deficient in
others. It contrasts with the idea of general intelligence (the "g
factor"), where most cognitive abilities are positively correlated.
Spiky intelligence is often seen in people who excel in abstract,
analytical reasoning but may lack emotional intelligence, empathy, or
practical judgment.</p>
<p><strong>Berkson’s Paradox</strong>: This statistical phenomenon
explains why successful individuals often appear to have significant
weaknesses. In highly competitive fields, it’s rare to find people who
excel in all dimensions, so success often goes to those with a few
standout traits.</p>
<figure>
<img
src="/di-blog/2025/02/02/2025-February/beerkson_paradox_with_selection_effects.png"
alt="beerkson_paradox_with_selection_effects" />
<figcaption
aria-hidden="true">beerkson_paradox_with_selection_effects</figcaption>
</figure>
<h2 id="youtube-and-podcasts">YouTube and Podcasts</h2>
<blockquote>
<p><strong>DOGE vs USAID, Crypto Framework, Google's $75B AI Spend, US
Sovereign Wealth Fund, GLP-1s - All-In Podcast</strong> [<a
target="_blank" rel="noopener" href="https://www.youtube.com/watch?v=R3q5TrwSek0&amp;list=PLn5MTSAqaf8peDZQ57QkJBzewJU1aUokl&amp;ab_channel=All-InPodcast">Link</a>]</p>
</blockquote>
<blockquote>
<p><strong>DeepSeek, China, OpenAI, NVIDIA, xAI, TSMC, Stargate, and AI
Megaclusters - Lex Fridman Podcast #459</strong> [<a
target="_blank" rel="noopener" href="https://www.youtube.com/hashtag/459">Link</a>] [<a
target="_blank" rel="noopener" href="https://lexfridman.com/deepseek-dylan-patel-nathan-lambert-transcript">Transcript</a>]</p>
</blockquote>
<p>This is a very good one. 5 hours intro and overview of current AI
landscape.</p>
<blockquote>
<p><em>Those driver jobs weren't even there 10 years ago. Uber came
along and created all these driver jobs. DoorDash created all these
driver jobs. So what technology does—yes, technology destroys jobs—but
it replaces them with opportunities that are even better. And then,
either you can go capture that opportunity yourself, or an entrepreneur
will come along and create something that allows you to capture those
opportunities. AI is a productivity tool. It increases the productivity
of a worker; it allows them to do more creative work and less repetitive
work. As such, it makes them more valuable. Yes, there is some
retraining involved, but not a lot. These are natural language
computers—you can talk to them in plain English, and they talk back to
you in plain English. But I think David is absolutely right. I think we
will see job creation by AI that will be as fast or faster than job
destruction. You saw this even with the internet. Like, YouTube came
along—look at all these YouTube streamers and influencers. That didn’t
used to be a job. New jobs—really, opportunities—because 'job' is the
wrong word. 'Job' implies someone else has to give it to me, like
they're handed out, as if it's a zero-sum game. Forget all that—it's
opportunities. After COVID, look at how many people are making money by
working from home in mysterious little ways on the internet that you
can't even quite grasp. - Naval Ravikant</em></p>
<p><em>you know as long as you remain adaptive and you keep learning and
you learn how to take advantage of these tools you should do better and
if you wall yourself off from the technology and don't take advantage of
it that's when you put yourself at risk - David Sacks</em></p>
<p><em>If you trained on the open web, your model should be open
source.</em> – Naval Ravikant.</p>
<p><em>To keep the conversation moving, let me segue a point that came
up that was really important into tariffs. And the point is, even though
the internet was open, the U.S. won a lot of the internet—a lot of U.S.
companies won the internet. And they won that because we got there "the
firstest with the mostest," as they say in the military. And that
matters because a lot of technology businesses have scale economies and
network effects underneath, even basic brand-based network effects. If
you go back to the late '90s and early 2000s, very few people would have
predicted that we would have ended up with Amazon basically owning all
of e-commerce. You would have thought it would have been perfect
competition and very spread out. And that applies to how we end up with
Uber as basically one taxi service or how we end up with Airbnb.
Meta—Airbnb—it's just network effects, network effects, network effects
rule the world around me. But when it comes to tariffs and when it comes
to trade, we act like network effects don't exist. The classic Ricardian
comparative advantage dogma says that you should produce what you're
best at, I produce what I'm best at, and we trade. And then, even if you
want to charge me more for it—if you want to impose tariffs for me to
ship to you—I should still keep tariffs down because I'm better off.
You're just selling me stuff cheaply—great. Or if you want to subsidize
your guys—great, you're selling me stuff cheaply. The problem is, that
is not how most modern businesses work. Most modern businesses have
network effects. As a simple thought experiment, suppose that we have
two countries, right? I'm China, you're the U.S. I start out by
subsidizing all of my companies and industries that have network
effects. So I'll subsidize TikTok, I'll ban your social media but push
mine. I will subsidize my semiconductors, which tend to have
winner-take-all dynamics in certain categories. Or I'll subsidize my
drones and then, exactly—BYD, self-driving, whatever. And then, when I
win, I own the whole market and I can raise prices. And if you try to
start up a competitor, it's too late—I've got network effects. Or if
I've got scale economies, I can lower my price to zero, crash you out of
business, no one in their right mind will invest, and then I'll raise
prices right back up. So you have to understand that certain industries
have hysteresis, or they have network effects, or they have economies of
scale—and these are all the interesting ones. These are all the
high-margin businesses. So in those, if somebody is subsidizing or
they're raising tariffs against you to protect their industries and let
them develop, you do have to do something. You can't just completely
back down. - Naval Ravikant</em></p>
<p><em>I think Sam and his team would do better to leave the nonprofit
part alone, leave an actual independent nonprofit board in charge, and
then have a strong incentive plan and a strong fundraising plan for the
investors and the employees. So I think this is workable. It's just that
trying to grab it all seems way off, especially when it was built on
open algorithms from Google, open data from the web, and nonprofit
funding from Elon and others. - Naval Ravikant</em></p>
<p><strong>― JD Vance's AI Speech, Techno-Optimists vs Doomers, Tariffs,
AI Court Cases with Naval Ravikant - All-In Podcast</strong> [<a
target="_blank" rel="noopener" href="https://www.youtube.com/watch?v=AI5qI6ej-yM">Link</a>]</p>
</blockquote>
<p>"AI won't take your job; it's someone using AI that will take your
job." – Richard Baldwin. The discussion around AI's impact on jobs is
often framed as a zero-sum game, but the reality is more nuanced. While
AI will displace certain jobs (e.g., self-driving cars replacing
drivers), it will also create new opportunities and industries that we
can't yet fully envision. The key is adaptability—those who learn to use
AI tools will thrive, while those who resist will fall behind.</p>
<blockquote>
<p><strong>The Stablecoin Future, Milei's Memecoin, DOGE for the DoD,
Grok 3, Why Stripe Stays Private - All-In Podcast</strong> [<a
target="_blank" rel="noopener" href="https://www.youtube.com/watch?v=OxP55dZjqZs">Link</a>]</p>
</blockquote>
<blockquote>
<p><strong>How to build full-stack apps with OpenAI o1 pro - Part 1 -
Mckay Wrigley</strong> [<a
target="_blank" rel="noopener" href="https://www.youtube.com/watch?v=Y4n_p9w8pGY&amp;ab_channel=MckayWrigley">Link</a>]</p>
</blockquote>
<p>Learn app development using OpenAI o1-Pro with a structured
six-prompt workflow.</p>
<blockquote>
<p><strong>Open Deep Research - LangChain</strong> [<a
target="_blank" rel="noopener" href="https://www.youtube.com/watch?v=2mSNIX-l_Zc&amp;ab_channel=LangChain">Link</a>]</p>
</blockquote>
<p>Build and run a deep research agent with LangGraph Studio, customize
configurations, compare architectures, and analyze costs.</p>
<h2 id="paper-and-reports">Paper and Reports</h2>
<blockquote>
<p><strong>Probabilistic weather forecasting with machine
learning</strong> [<a
target="_blank" rel="noopener" href="https://www.nature.com/articles/s41586-024-08252-9">Link</a>]</p>
</blockquote>
<p>GenCast's success stems from its ability to generate ensembles of
sharp, realistic weather trajectories and well-calibrated probability
distributions.</p>
<p>The methodology of GenCast involves several key components:</p>
<ul>
<li>GenCast employs a <strong>second-order Markov assumption</strong>,
meaning it conditions its predictions on the two previous weather
states, rather than just one. This is done because conditioning on two
previous time steps works better than one.</li>
<li>GenCast is implemented as a <strong>conditional diffusion
model</strong>. Diffusion models are generative machine learning methods
that can model the probability distribution of complex data and generate
new samples by iteratively refining a noisy initial state. The model
predicts a residual with respect to the most recent weather state. The
sampling process begins with random noise, which is then refined over a
series of steps.</li>
<li>At each step of the iterative refinement process, GenCast uses a
<strong>denoiser neural network</strong>. This network is trained to
remove noise that has been artificially added to atmospheric states. The
architecture of the denoiser includes an encoder, a processor, and a
decoder. The encoder maps the noisy target state to an internal
representation on a refined icosahedral mesh, the processor is a
<strong>graph transformer</strong>, and the decoder maps the internal
mesh representation back to a denoised target state.</li>
<li>GenCast uses a noise distribution that respects the spherical
geometry of global weather variables. Rather than using independent and
identically distributed (i.i.d.) Gaussian noise on the
latitude-longitude grid, it samples <strong>isotropic Gaussian white
noise</strong> on the sphere and projects it onto the grid.</li>
<li>GenCast's performance is evaluated using various metrics, including:
<ul>
<li><strong>CRPS (Continuous Ranked Probability Score):</strong>
Measures the skill of a probabilistic forecast.</li>
<li><strong>RMSE (Root Mean Squared Error):</strong> Measures how
closely the mean of an ensemble of forecasts matches the ground
truth.</li>
<li><strong>Spread/Skill Ratios and Rank Histograms:</strong> Used to
evaluate the calibration of the forecast distributions.</li>
<li><strong>Brier Skill Score:</strong> Evaluates probabilistic
forecasts of binary events, specifically the prediction of extreme
weather events.</li>
<li><strong>Relative Economic Value (REV):</strong> Characterizes the
potential value of a forecast over a range of probability decision
thresholds.</li>
<li><strong>Spatially Pooled CRPS:</strong> Evaluates forecasts
aggregated over circular spatial regions of varying sizes to assess the
model's ability to capture spatial dependencies.</li>
<li><strong>Regional Wind Power Forecasting:</strong> Evaluates the
model's ability to predict wind power generation at wind farm locations
using a standard idealized power curve.</li>
<li><strong>Tropical Cyclone Track Prediction:</strong> Uses the
TempestExtremes tropical cyclone tracker to extract cyclone trajectories
from the forecast and analysis data. The model's ability to forecast
cyclone tracks is evaluated using position error and track
probability.</li>
</ul></li>
</ul>
<blockquote>
<p><em>The United States currently leads the world in data centers and
AI compute, but unprecedented demand leaves the industry struggling to
find the power capacity needed for rapidly building new data centers.
Failure to address current bottlenecks may compel U.S. companies to
relocate AI infrastructure abroad, potentially compromising the U.S.
competitive advantage in compute and AI and increasing the risk of
intellectual property theft.</em></p>
<p><strong>― AI's Power Requirements Under Exponential Growth -
RAND</strong> [<a
target="_blank" rel="noopener" href="https://www.rand.org/pubs/research_reports/RRA3572-1.html">Link</a>]
[<a
target="_blank" rel="noopener" href="https://www.rand.org/content/dam/rand/pubs/research_reports/RRA3500/RRA3572-1/RAND_RRA3572-1.pdf">pdf</a>]</p>
</blockquote>
<blockquote>
<p><strong>Genome modeling and design across all domains of life with
Evo 2 - Arc Institute</strong> [<a
target="_blank" rel="noopener" href="https://arcinstitute.org/manuscripts/Evo2">Link</a>]</p>
</blockquote>
<p>Evo 2 is a powerful genome modeling and design tool that operates
across all domains of life. It can analyze and generate genetic
sequences from molecular to genome scale. It accurately assigns
likelihood scores to human disease variants, distinguishing between
pathogenic and benign mutations in both coding and noncoding regions. It
can predict whether genes are essential or nonessential using mutational
likelihoods, helping in bacterial and phage gene essentiality studies.
It can generate large-scale DNA sequences with structured features like
tRNAs, promoters, and genes with intronic structures. It provides
zero-shot fitness predictions for protein and non-coding RNA sequences,
correlating well with experimental fitness measurements. It robustly
predicts the pathogenicity of various mutation types, achieving
state-of-the-art performance for noncoding and splice variants.</p>
<blockquote>
<p><strong>Large Action Models: From Inception to
Implementation</strong> [<a
target="_blank" rel="noopener" href="https://arxiv.org/abs/2412.10047v1">Link</a>]</p>
</blockquote>
<p>Microsoft Research published one of the most complete papers in this
area, outlining a complete framework for large action models (LAMs)
models. The core idea is to bridge the gap between the language
understanding capability of LLMs and the need for real-world action
execution.</p>
<figure>
<img src="/di-blog/2025/02/02/2025-February/microsoft_lam.png"
alt="microsoft_lam" />
<figcaption aria-hidden="true">microsoft_lam</figcaption>
</figure>
<blockquote>
<p><strong>Towards an AI co-scientist</strong> [<a
target="_blank" rel="noopener" href="https://storage.googleapis.com/coscientist_paper/ai_coscientist.pdf">Link</a>]</p>
</blockquote>
<blockquote>
<p><strong>Uncovering the Impact of Chain-of-Thought Reasoning for
Direct Preference Optimization: Lessons from Text-to-SQL</strong> [<a
target="_blank" rel="noopener" href="https://arxiv.org/abs/2502.11656">Link</a>]</p>
</blockquote>
<p>Direct Preference Optimization (DPO) does not consistently improve
performance in the Text-to-SQL task and sometimes even degrades it.
Existing Standard Fine-Tuning (SFT) methods are limited by the lack of
high-quality training data, and prompting-based methods are expensive,
slow, and raise data privacy concerns.</p>
<p>To solve the problems, they generate <strong>synthetic CoT
solutions</strong> to improve training datasets, leading to <strong>more
stable and significant performance improvements</strong> in DPO. They
integrate <strong>execution-based feedback</strong> to refine the
model’s SQL generation process, making the optimization process more
reliable. And they create a <strong>quadruple-based preference
dataset</strong> to help the model learn to distinguish between correct
and incorrect SQL responses more effectively.</p>
<blockquote>
<p><strong>MONA: Myopic Optimization with Non-myopic Approval Can
Mitigate Multi-step Reward Hacking</strong> [<a
target="_blank" rel="noopener" href="https://arxiv.org/abs/2501.13011">Link</a>]</p>
</blockquote>
<p>Google DeepMind developed an innovative approach - Myopic
Optimization with Non-myopic Approval (MONA), to mitigate multi-step
reward hacking. This MONA methodology is built on two key principles.
The first is <strong>myopic optimization</strong>, where agents focus on
maximizing rewards for immediate actions rather than planning multi-step
strategies. This ensures that agents do not develop complex,
unintelligible tactics. The second principle is <strong>non-myopic
approval</strong>, where human overseers assess the agent's actions
based on their expected long-term utility. These evaluations serve as
the primary mechanism for guiding agents toward behavior aligned with
human-defined objectives, without relying on direct feedback from
outcomes.</p>
<figure>
<img src="/di-blog/2025/02/02/2025-February/google_deepmind_mona.png"
alt="google_deepmind_mona" />
<figcaption aria-hidden="true">google_deepmind_mona</figcaption>
</figure>
<blockquote>
<p><strong>The Ultra-Scale Playbook: Training LLMs on GPU Clusters -
Hugging Face</strong> [<a
target="_blank" rel="noopener" href="https://huggingface.co/spaces/nanotron/ultrascale-playbook?section=high_level_overview">Link</a>]</p>
</blockquote>
<p>This book from Hugging Face explains 5D parallelism, ZeRO, CUDA
kernel optimizations, and compute-communication overlap in large-scale
AI training. It breaks down scaling bottlenecks, PyTorch internals, and
parallelism techniques like ZeRO-3, pipeline, sequence, and context
parallelism.</p>
<h2 id="articles-and-blogs">Articles and Blogs</h2>
<blockquote>
<p><em>The research found six distinct leadership styles, each springing
from different components of emotional intelligence. The styles, taken
individually, appear to have a direct and unique impact on the working
atmosphere of a company, division, or team, and in turn, on its
financial performance. And perhaps most important, the research
indicates that leaders with the best results do not rely on only one
leadership style; they use most of them in a given week—seamlessly and
in different measure—depending on the business situation. Imagine the
styles, then, as the array of clubs in a golf pro’s bag. Over the course
of a game, the pro picks and chooses clubs based on the demands of the
shot. Sometimes he has to ponder his selection, but usually it is
automatic. The pro senses the challenge ahead, swiftly pulls out the
right tool, and elegantly puts it to work. That’s how high-impact
leaders operate, too.</em></p>
<p><em>Leaders who have mastered four or more—especially the
authoritative, democratic, affiliative, and coaching styles—have the
very best climate and business performance.</em></p>
<p><em>The leader can build a team with members who employ styles she
lacks.</em></p>
<p><strong>― Leadership That Gets Results - Harvard Business
Review</strong> [<a
target="_blank" rel="noopener" href="https://hbr.org/2000/03/leadership-that-gets-results">Link</a>]</p>
</blockquote>
<blockquote>
<p><strong>WeatherNext - Google DeepMind</strong> [<a
target="_blank" rel="noopener" href="https://deepmind.google/technologies/weathernext/#access-weathernext">Link</a>]</p>
</blockquote>
<blockquote>
<p><strong>GenCast predicts weather and the risks of extreme conditions
with state-of-the-art accuracy - Google DeepMind</strong> [<a
target="_blank" rel="noopener" href="https://deepmind.google/discover/blog/gencast-predicts-weather-and-the-risks-of-extreme-conditions-with-sota-accuracy/">Link</a>]</p>
</blockquote>
<blockquote>
<p><em>Morgan Stanley stated that ASICs perform exceptionally well in
certain specific application scenarios, but are highly dependent on the
custom needs of particular clients; the development cost of ASICs is
usually lower, but their system costs and Software deployment costs may
be much higher than GPUs that can be commercially scaled, leading to a
higher total cost of ownership. In addition, NVIDIA's CUDA ecosystem is
very mature and widely used in Global Cloud Computing Services, with a
market position that remains as solid as ever.</em></p>
<p><strong>― Morgan Stanley: ASICs are overheated, and NVIDIA's position
is difficult to shake. - moomoo</strong> [<a
target="_blank" rel="noopener" href="https://www.moomoo.com/news/post/49238491/morgan-stanley-asics-are-overheated-and-nvidia-s-position-is?level=1&amp;data_ticket=1739666344971762">Link</a>]</p>
</blockquote>
<p>NVIDIA possesses a robust competitive advantage in the AI chip market
due to its mature ecosystem, continuous R&amp;D investments, and strong
technical capabilities.</p>
<ul>
<li><strong>NVIDIA's CUDA ecosystem</strong> is well-established,
enabling clients to easily deploy and run various workloads. The
maturity of this ecosystem means that customers may find it easier to
use NVIDIA products compared to adapting software for ASICs or other
alternatives.</li>
<li>NVIDIA has a <strong>leading position in the AI chip
market</strong>, which is reinforced by its <strong>presence on every
cloud platform across the globe</strong>. Investments within NVIDIA's
ecosystem benefit from global dissemination, further solidifying its
market dominance.</li>
<li>NVIDIA <strong>invests significantly in R&amp;D</strong>. The
company is expected to invest approximately <span
class="math inline">\(\$16\)</span> billion in R&amp;D this year. This
level of investment allows NVIDIA to <strong>maintain a 4-5 year
development cycle</strong> and continuously introduce leading
high-performance chips. Custom ASIC development budgets are typically
smaller (less than <span class="math inline">\(\$1\)</span> billion),
giving NVIDIA an edge in innovation.</li>
<li>NVIDIA is difficult to surpass in providing <strong>high-end
training capabilities</strong>. The company focuses on training
multi-modal AGI models.</li>
</ul>
<blockquote>
<p><em>This means DeepResearch can identify cross-domain links or
examples that might otherwise be overlooked, offering fresh
perspectives. In professional settings, this can support more
well-rounded decision-making – for example, a product manager can
quickly gather insights from scientific research, market data, and
consumer opinions in one place, rather than relying on multiple teams or
lengthy research processes. It makes you multifaceted!</em></p>
<p><strong>― #87: Why DeepResearch Should Be Your New Hire - Turing
Post</strong> [<a
target="_blank" rel="noopener" href="https://www.turingpost.com/p/fod87?_bhlid=b5475ffe865a70cea5fc76bc1589c7fbada04657&amp;utm_campaign=87-why-deepresearch-should-be-your-new-hire&amp;utm_medium=newsletter&amp;utm_source=www.turingpost.com">Link</a>]</p>
</blockquote>
<blockquote>
<p><strong>Deep Research and Knowledge Value - Stratechery</strong> [<a
target="_blank" rel="noopener" href="https://stratechery.com/2025/deep-research-and-knowledge-value/">Link</a>]</p>
</blockquote>
<p>OpenAI launched Deep Research in ChatGPT, which is an agentic
capability that conducts multi-step research on the internet for complex
tasks. It synthesizes knowledge in an economically valuable way but does
not create new knowledge.</p>
<p>As demonstrated in the article, it can be useful for researching
people and companies before conducting interviews. However, it can also
produce reports that are completely wrong by missing major entities in
an industry.</p>
<p>This is a good point - <strong>The Internet revealed that news was
worthless in terms of economic value because the societal value does not
translate to economic value. Deep Research reveals how much more could
be known, but the increasing amount of "slop" makes it more difficult to
find the right information. Information that matters and is not on the
Internet has future economic value wrapped up in it.</strong></p>
<p>Proprietary data is valuable, and AI tools like Deep Research make it
more difficult to harvest alpha from reading financial filings.
Prediction markets may become more important as AI increases the
incentive to keep things secret.</p>
<p>As a summary of the impact - Deep Research is a good value, but
<strong>it is limited by the quality of information on the Internet and
the quality of the prompt.</strong> There is value in the search for and
sifting of information, and this may be lost with on-demand reports. AI
will replace knowledge work. Secrecy is a form of friction that imposes
scarcity on valuable knowledge. Deep Research is not yet good at
understanding some things.</p>
<blockquote>
<p><strong>Massive Foundation Model for Biomolecular Sciences Now
Available via NVIDIA BioNeMo - NVIDIA Blog</strong> [<a
target="_blank" rel="noopener" href="https://blogs.nvidia.com/blog/evo-2-biomolecular-ai/">Link</a>]</p>
</blockquote>
<blockquote>
<p><strong>Grok 3: Intelligence, Performance &amp; Price Analysis -
Artificial Analysis</strong> [<a
target="_blank" rel="noopener" href="https://artificialanalysis.ai/models/grok-3">Link</a>]</p>
</blockquote>
<blockquote>
<p><strong>Grok resets the AI race - The Verge</strong> [<a
target="_blank" rel="noopener" href="https://www.theverge.com/command-line-newsletter/617780/grok-3-elon-musk-ai-race-chatgpt">link</a>]</p>
</blockquote>
<p>Grok-3 (chocolate) is the first-ever model to break 1400 score and is
now #1 in <a
target="_blank" rel="noopener" href="https://huggingface.co/spaces/lmarena-ai/chatbot-arena-leaderboard">Arena</a>.</p>
<blockquote>
<p><strong>Grok 3 Beta — The Age of Reasoning Agents - Grok
Blog</strong> [<a target="_blank" rel="noopener" href="https://x.ai/blog/grok-3">Link</a>]</p>
</blockquote>
<blockquote>
<p><em>Motivated by unmet needs in the modern scientific discovery
process and building on <a
target="_blank" rel="noopener" href="https://arxiv.org/abs/2403.05530">recent AI advances</a>,
including the ability to synthesize across complex subjects and to
perform <a
target="_blank" rel="noopener" href="https://deepmind.google/technologies/gemini/flash-thinking/">long-term
planning and reasoning</a>, we developed an <a
target="_blank" rel="noopener" href="https://storage.googleapis.com/coscientist_paper/ai_coscientist.pdf">AI
co-scientist system</a>. The AI co-scientist is a multi-agent AI system
that is intended to function as a collaborative tool for scientists.
Built on <a
target="_blank" rel="noopener" href="https://blog.google/technology/google-deepmind/google-gemini-ai-update-december-2024/">Gemini
2.0, AI co-scientist is</a> designed to mirror the reasoning process
underpinning the scientific method. Beyond standard literature review,
summarization and “deep research” tools, the AI co-scientist system is
intended to uncover new, original knowledge and to formulate
demonstrably novel research hypotheses and proposals, building upon
prior evidence and tailored to specific research objectives.</em></p>
<p><strong>― Accelerating scientific breakthroughs with an AI
co-scientist - Google Blog</strong> [<a
target="_blank" rel="noopener" href="https://research.google/blog/accelerating-scientific-breakthroughs-with-an-ai-co-scientist/">Link</a>]</p>
</blockquote>
<figure>
<img
src="/di-blog/2025/02/02/2025-February/AICoScientist-1-Components.png"
alt="AICoScientist-1-Components" />
<figcaption aria-hidden="true">AICoScientist-1-Components</figcaption>
</figure>
<blockquote>
<p><strong>An Interview with Uber CEO Dara Khosrowshahi About
Aggregation and Autonomy - Stratechery</strong> [<a
target="_blank" rel="noopener" href="https://stratechery.com/2025/an-interview-with-uber-ceo-dara-khosrowshahi-about-aggregation-and-autonomy/">Link</a>]</p>
</blockquote>
<blockquote>
<p><strong>OpenAI Deep Research Guide - DAIR.AI</strong> [<a
target="_blank" rel="noopener" href="https://docs.google.com/document/d/1vLaEMu5jirQT5RK0cW8RUXNFQyszMQ-xrjxUZF2wOg4/edit?pli=1&amp;tab=t.0#heading=h.2y9eo2rdwxv2">Link</a>]</p>
</blockquote>
<p>This is a super helpful guide to Deep Research Tools.</p>
<p>You provide use cases and examples, very inspiring, and tips,
etc.</p>
<figure>
<img src="/di-blog/2025/02/02/2025-February/usecases_examples.png"
alt="usecases_examples" />
<figcaption aria-hidden="true">usecases_examples</figcaption>
</figure>
<figure>
<img
src="/di-blog/2025/02/02/2025-February/claude_deepresearch_usecases_chart.png"
alt="claude_deepresearch_usecases_chart" />
<figcaption
aria-hidden="true">claude_deepresearch_usecases_chart</figcaption>
</figure>
<blockquote>
<p><em>Studies on the brain affirm the benefits of Tom’s visualization
technique: Imagining something in vivid detail can fire the same brain
cells actually involved in doing that activity. The new brain circuitry
appears to go through its paces, strengthening connections, even when we
merely repeat the sequence in our minds. So to alleviate the fears
associated with trying out riskier ways of leading, we should first
visualize some likely scenarios. Doing so will make us feel less awkward
when we actually put the new skills into practice.</em></p>
<p><strong>― Primal Leadership: The Hidden Driver of Great Performance -
Harvard Business Review</strong> [<a
target="_blank" rel="noopener" href="https://hbr.org/2001/12/primal-leadership-the-hidden-driver-of-great-performance">Link</a>]</p>
</blockquote>
<p>Imagine it, fake it, and make it.</p>
<blockquote>
<p><em>Our research tells us that three conditions are essential to a
group’s effectiveness: trust among members, a sense of group identity,
and a sense of group efficacy.</em></p>
<p><strong>― Building the Emotional Intelligence of Groups - Harvard
Business Review</strong> [<a
target="_blank" rel="noopener" href="https://hbr.org/2001/03/building-the-emotional-intelligence-of-groups">Link</a>]</p>
</blockquote>
<p>Team is so important to leaders.</p>
<blockquote>
<p><em>Interrupt the ascent.</em></p>
<p><em>When people are continually promoted within their areas of
expertise, they don’t have to stray far from their comfort zones, so
they seldom need to ask for help, especially if they’re good problem
solvers. Accordingly, they may become overly independent and fail to
cultivate relationships with people who could be useful to them in the
future. What’s more, they may rely on the authority that comes with rank
rather than learning how to influence people. A command-and-control
mentality may work in certain situations, particularly in lower to
middle management, but it’s usually insufficient in more senior
positions, when peer relationships are critical and success depends more
on the ability to move hearts and minds than on the ability to develop
business solutions.</em></p>
<p><strong>― The Young and the Clueless - Harvard Business
Review</strong> [<a
target="_blank" rel="noopener" href="https://hbr.org/2002/12/the-young-and-the-clueless">Link</a>]</p>
</blockquote>
<p>Don't fall into the independence trap.</p>
<blockquote>
<p><strong>Accelerating scientific breakthroughs with an AI co-scientist
- Google Research</strong> [<a
target="_blank" rel="noopener" href="https://research.google/blog/accelerating-scientific-breakthroughs-with-an-ai-co-scientist/">Link</a>]</p>
</blockquote>
<h2 id="news-and-comments">News and Comments</h2>
<blockquote>
<p><strong>Introducing deep research - Open AI</strong> [<a
target="_blank" rel="noopener" href="https://openai.com/index/introducing-deep-research/">Link</a>]</p>
</blockquote>
<blockquote>
<p><strong>Introducing Perplexity Deep Research - Perplexity</strong>
[<a
target="_blank" rel="noopener" href="https://www.perplexity.ai/hub/blog/introducing-perplexity-deep-research">Link</a>]</p>
</blockquote>
<p>Trend is on deep research.</p>
<blockquote>
<p><strong>Shopify Tells Employees to Just Say No to Meetings -
Bloomberg</strong> [<a
target="_blank" rel="noopener" href="https://www.bloomberg.com/news/articles/2023-01-03/shopify-ceo-tobi-lutke-tells-employees-to-just-say-no-to-meetings">Link</a>]</p>
</blockquote>
<blockquote>
<p><strong>Who will control the future of AI? - The Washington
Post</strong> [<a
target="_blank" rel="noopener" href="https://www.washingtonpost.com/opinions/2024/07/25/sam-altman-ai-democracy-authoritarianism-future/">Link</a>]</p>
</blockquote>
<p>Sam promotes a U.S.-led strategy to ensure AI development aligns with
democratic values and remains under the leadership of the U.S. and its
allies.</p>
<blockquote>
<p><em>This new architecture used to develop the Majorana 1 processor
offers a clear path to fit a million qubits on a single chip that can
fit in the palm of one’s hand.</em></p>
<p><em>Microsoft is now one of two companies to be <a
target="_blank" rel="noopener" href="https://www.darpa.mil/news/2025/quantum-computing-approaches">invited
to move to the final phase</a> of DARPA’s Underexplored Systems for
Utility-Scale Quantum Computing (US2QC) program – one of the programs
that makes up DARPA’s larger <a
target="_blank" rel="noopener" href="https://www.darpa.mil/research/programs/quantum-benchmarking-initiative">Quantum
Benchmarking Initiative</a> – which aims to deliver the industry’s first
utility-scale fault-tolerant quantum computer, or one whose
computational value exceeds its costs.</em></p>
<p><strong>― Microsoft’s Majorana 1 chip carves new path for quantum
computing - Microsoft</strong> [<a
target="_blank" rel="noopener" href="https://news.microsoft.com/source/features/ai/microsofts-majorana-1-chip-carves-new-path-for-quantum-computing/">Link</a>]</p>
</blockquote>
<p>In the near term, Google’s approach with superconducting qubits (like
Willow) is more mature. This technology has already demonstrated
impressive benchmarks and is backed by years of incremental
improvements. Its error correction techniques, while still challenging,
are well‑studied, and scaling up using transmon qubits is an area where
significant progress has been made.</p>
<p>On the other hand, Microsoft’s topological approach with Majorana 1
aims to use a completely new type of qubit—one that is “protected by
design” thanks to its topological nature. In theory, this means lower
error rates and potentially a much more scalable architecture with fewer
physical qubits needed per logical qubit. However, this method is still
very experimental, and questions remain over whether true Majorana zero
modes have been reliably created and controlled.</p>
<p>In summary, for near‑term practical applications, Google’s path
appears to be the safer bet. But if Microsoft’s topological qubit
platform can overcome its technical hurdles, it may ultimately provide a
more efficient and scalable route to fault‑tolerant quantum
computing.</p>
<blockquote>
<p><strong>Tencent's Weixin app, Baidu launch DeepSeek search testing -
Reuters</strong> [<a
target="_blank" rel="noopener" href="https://www.reuters.com/technology/artificial-intelligence/tencents-messaging-app-weixin-launches-beta-testing-with-deepseek-2025-02-16/">Link</a>]</p>
</blockquote>
<blockquote>
<p><strong>OpenAI tries to ‘uncensor’ ChatGPT - Techcrunch</strong> [<a
target="_blank" rel="noopener" href="https://techcrunch.com/2025/02/16/openai-tries-to-uncensor-chatgpt/">Link</a>]</p>
</blockquote>
<blockquote>
<p><strong>Elon Musk Ally Tells Staff ‘AI-First’ Is the Future of Key
Government Agency - WIRED</strong> [<a
target="_blank" rel="noopener" href="https://www.wired.com/story/elon-musk-lieutenant-gsa-ai-agency/">Link</a>]</p>
</blockquote>
<p>Thomas Shedd, a former Tesla engineer and ally of Elon Musk, is
implementing an "AI-first strategy" at the General Services
Administration's Technology Transformation Services (TTS). Shedd
envisions the agency operating like a software startup, automating tasks
and centralizing federal data. This shift is causing concern among GSA
staff, who report being thrown into unexpected meetings and facing
potential workforce cuts. Shedd is promoting collaboration between TTS
and the United States Digital Services (DOGE), though specifics about
the new AI-driven projects and data repository remain unclear. A
cybersecurity expert expressed concern that automating government tasks
is difficult and the attempt is raising red flags. Employees also voiced
concerns regarding working hours and potential job losses.</p>
<blockquote>
<p><strong>OpenAI o3-mini - OpenAI</strong> [<a
target="_blank" rel="noopener" href="https://openai.com/index/openai-o3-mini/">Link</a>]</p>
</blockquote>
<blockquote>
<p><strong>Introducing deep research - OpenAI</strong> [<a
target="_blank" rel="noopener" href="https://openai.com/index/introducing-deep-research/">Link</a>]</p>
</blockquote>
<blockquote>
<p><strong>Gemini 2.0 is now available to everyone - Google
DeepMind</strong> [<a
target="_blank" rel="noopener" href="https://blog.google/technology/google-deepmind/gemini-model-updates-february-2025/">Link</a>]</p>
</blockquote>
<blockquote>
<p><strong>The all new le Chat: Your AI assistant for life and work -
Mistral AI</strong> [<a
target="_blank" rel="noopener" href="https://mistral.ai/news/all-new-le-chat">Link</a>]</p>
</blockquote>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://jokerdii.github.io/di-blog/2025/02/01/DeepSeek-R1-Pivotal-Moment/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/di-blog/images/avatar.gif">
      <meta itemprop="name" content="Di Zhen">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Di's Blog">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Di's Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/di-blog/2025/02/01/DeepSeek-R1-Pivotal-Moment/" class="post-title-link" itemprop="url">DeepSeek-R1: Pivotal Moment</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2025-02-01 21:21:58" itemprop="dateCreated datePublished" datetime="2025-02-01T21:21:58-05:00">2025-02-01</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>My thoughts regarding the AI landscape at the current stage:</p>
<p>As open-source AI becomes more affordable, it is poised to become as
ubiquitous and accessible as electricity—financially viable for
everyone. The AI and AGI arms race, whether between nations, open- and
closed-source models, or competing companies, is effectively over or
should be over, and the outcome is clear. Compute power still remains
essential, but semiconductor giants like NVIDIA should look beyond
language model training and inference, shifting their focus to the next
frontiers, such as robotics and world models. Now is the time for
developers and startups to concentrate on the vertical integration of
AI, where real economic value can be realized.</p>
<h2 id="deepseek---background">DeepSeek - Background</h2>
<p>DeepSeek began as a research offshoot of
<strong>High-Flyer</strong>—a hedge fund that had already amassed a
large GPU inventory (reportedly 10,000 Nvidia A100s in 2021). Over time,
this resource base appears to have grown, with estimates suggesting
that—when you account for research, ablation experiments, and shared
infrastructure with trading—the effective pool might be closer to 50,000
GPUs. This expansive compute power enables DeepSeek to run many
experiments simultaneously and quickly iterate on new architectures.</p>
<p>By leveraging a shared infrastructure with its hedge fund operations,
DeepSeek can reinvest profits from quant trading into AI research. This
model of “doing more with less” not only challenges the notion that
massive, multibillion-dollar compute expenditures are necessary to build
world-class AI models but also has broader implications for the
industry. It raises questions about the future economics of AI
development and the potential for more cost-efficient, research-driven
models to shift market dynamics, as seen by the notable impact on
Nvidia’s stock and market sentiment.</p>
<h2 id="export-controls-on-gpus-to-china">Export Controls on GPUs to
China</h2>
<p>In essence, the U.S. government originally imposed limits on chips
that exceed certain thresholds in both <strong>interconnect
bandwidth</strong> and <strong>compute (FLOPs)</strong> to restrict
China’s ability to train massive AI models. Early on, chips that
combined high interconnect speeds with high FLOPs were off‐limits.</p>
<p>For example, the H100—one of Nvidia’s top GPUs—was deemed too
powerful. In response, Nvidia developed the H800, which maintained the
same floating point performance (FLOPs) as the H100 but had its
interconnect bandwidth intentionally reduced to meet U.S. export
criteria. However, when the government later decided to tighten controls
further (targeting chips solely on FLOPs), even the H800 was banned.
This led Nvidia to innovate once again with the H20, a chip that now
offers full interconnect bandwidth (and even improved memory
characteristics over the H100) but with a deliberate cut in overall
FLOPs to satisfy export rules.</p>
<p>The strategic rationale behind these controls is to “decap” China’s
compute—especially for large-scale AI training—by limiting how many of
the most advanced GPUs (and thus the overall density of compute) can be
legally acquired. While Chinese companies can still purchase GPUs to
train models, the overall capacity available for training (which is
critical for developing super-powerful AI) is being capped. This is seen
as a way to maintain U.S. and allied leadership in AI, particularly in a
world where super-powerful AI may soon offer decisive military and
economic advantages.</p>
<h3 id="sidenote---gpus-for-ai">Sidenote - GPUs for AI</h3>
<p><strong>Keys GPU Specifications:</strong></p>
<ul>
<li><strong>FLOPS (Compute Power)</strong>: Critical for training large
models (e.g., GPT-4) but less critical for inference tasks like
reasoning.</li>
<li><strong>Memory Bandwidth/Capacity</strong>: Determines how much data
(e.g., KV cache in transformers) can be stored and accessed quickly,
crucial for long-sequence tasks.</li>
<li><strong>Interconnect Speed</strong>: Affects communication between
GPUs in clusters, important for distributed training but less regulated
now.</li>
</ul>
<p><strong>H20 vs. H100: Tradeoffs for AI Workloads:</strong></p>
<ul>
<li><p><strong>H20 (China-Specific):</strong> has its strength in higher
memory bandwidth and capacity than H100, making it better suited for
<strong>reasoning tasks</strong> (e.g., long-context inference,
chain-of-thought). However, FLOPS (≈1/3 of H100 on paper, ≈50-60% in
practice) is reduced, limiting its utility for training.</p>
<p><strong>Regulatory Context</strong>: Designed to comply with U.S.
export controls that focus on FLOPS, allowing Nvidia to ship 1M units to
China in 2023 (20-25% of total GPUs).</p></li>
<li><p><strong>H100</strong>: Optimized for FLOPS-heavy training but
less efficient for memory-bound inference tasks</p></li>
</ul>
<p><strong>Why Memory Matters for Reasoning:</strong></p>
<ul>
<li><strong>KV Cache in Transformers</strong> stores keys/values of all
tokens in a sequence for attention mechanisms. Memory demands grow
<strong>quadratically</strong> with sequence length (e.g., 10K+ tokens
in reasoning tasks).</li>
<li><strong>Autoregressive Generation</strong>: Output tokens require
sequential processing, forcing repeated KV cache access. This limits
parallelism and increases memory pressure. Tasks like agentic AI or
chain-of-thought involve generating long outputs (10K+ tokens),
stressing memory bandwidth/capacity.</li>
</ul>
<h2 id="deepseek---technical-comments">DeepSeek - Technical
Comments</h2>
<p>Paper: <a target="_blank" rel="noopener" href="https://arxiv.org/abs/2412.19437">DeepSeek-V3
Technical Report</a></p>
<p><strong>GPU Infrastructure with Nvidia Hardware</strong></p>
<ul>
<li>DeepSeek trains on <strong>Nvidia GPUs</strong>. These are equipped
with many cores (organized into streaming multiprocessors, or SMs) that
perform the heavy lifting during both training and inference.</li>
<li>The GPUs they used were those <strong>legally available in
China</strong>, which imposed certain limitations—especially on
interconnect bandwidth between units. This meant that DeepSeek needed to
overcome hardware constraints that might not be present with the very
latest high-end GPUs elsewhere.</li>
</ul>
<p><strong>Custom Low-Level Optimization</strong></p>
<ul>
<li>Instead of relying solely on Nvidia’s standard NCCL (Nvidia
Communications Collectives Library) for handling inter-GPU
communications, DeepSeek’s engineers developed custom scheduling
techniques. They even <strong>scheduled communications at the SM
level</strong>, which is more granular than the typical approach.</li>
<li>Their implementation involved programming approaches that went deep
into the hardware—down to using <strong>PTX</strong> (an intermediate
assembly-like language for CUDA). This allowed them to squeeze extra
efficiency from each GPU by reducing the overhead in communication
between layers of the model.</li>
</ul>
<p><strong>Efficiency via Architectural Choices</strong></p>
<ul>
<li>One of the key innovations was using a <strong>sparse Mixture of
Experts (MoE) architecture</strong>. With a model that can have hundreds
of billions of parameters overall but only activates a fraction (e.g.,
around 37 billion at a time), the compute and memory demands are
dramatically reduced. This architectural choice means that even if the
hardware isn’t the absolute latest, it can still be very cost-effective
by not needing to run every parameter for every token.</li>
<li>DeepSeek's novel attention mechanism <strong>MLA (Multi-Head Latent
Attention)</strong> reduces memory usage by 80–90% compared to
traditional transformer attention. This optimization lowers
computational costs, especially for long-context processing, without
sacrificing performance.</li>
<li>By optimizing both the hardware usage (through custom scheduling and
low-level programming) and the model architecture (via MoE and MLA),
DeepSeek manages to cut down on the cost of training. This is crucial
given the significant compute expense associated with large-scale
language models.</li>
</ul>
<p><strong>Pre-Training and Context Window Extension</strong></p>
<ul>
<li>Pre-trained on 14.8 trillion tokens drawn from a multilingual corpus
(primarily English and Chinese) with a higher proportion of math and
programming content compared to previous iterations.</li>
<li>Utilizes a two-phase extension (via the YaRN framework) to expand
the context length from 4K tokens to 32K and finally to 128K
tokens.</li>
<li>Reported training cost for V3 is approximately $5.58 million,
consuming about 2.788 million GPU-hours on Nvidia H800 GPUs. This figure
is significantly lower than the hundreds of millions typically reported
by US rivals.</li>
</ul>
<p><strong>Post-Training: Supervised Fine-Tuning &amp; Reinforcement
Learning</strong></p>
<ul>
<li>V3 is fine-tuned on a carefully curated dataset of approximately 1.5
million examples (both reasoning and non-reasoning tasks) to improve
instruction-following and output formatting.</li>
<li>DeepSeek employs <strong>GRPO</strong>—a <strong>group relative
policy optimization method</strong>—to reward outputs based on
correctness (accuracy rewards) and presentation (format rewards).</li>
<li>R1 leverages RL to fine-tune the reasoning process, rewarding
chain-of-thought quality and encouraging the model to generate
self-reflective “aha moments.”</li>
</ul>
<p><strong>Speed-to-Market and Safety Tradeoffs</strong></p>
<ul>
<li><p>DeepSeek prioritizes rapid deployment over extensive safety
testing, avoiding delays and costs associated with ethical reviews
(common in Western firms like Anthropic). This "ship-first" approach
reduces development cycle expenses.</p></li>
<li><p>Releasing model weights publicly attracts third-party hosting and
innovation, indirectly expanding reach without bearing full
infrastructure costs.</p></li>
</ul>
<h2 id="the-tech-and-business-perspective"><strong>The Tech and Business
Perspective</strong></h2>
<p>The release of DeepSeek-R1 marks a pivotal moment in the AI industry,
igniting discussions about open-source dominance, market disruption, and
geopolitical implications.</p>
<p><strong>Industry Leaders Weigh In</strong>:</p>
<p><strong>Yann LeCun (Meta’s Chief AI Scientist)</strong></p>
<p>LeCun emphasized the growing power of open-source models over
proprietary approaches:</p>
<blockquote>
<p><em>"To people who see the performance of DeepSeek and think China is
surpassing the US in AI. You are reading this wrong. The correct reading
is: Open source models are surpassing proprietary ones."</em></p>
</blockquote>
<p><strong>Andrej Karpathy (OpenAI Co-founder)</strong></p>
<p>Karpathy pointed out the continued need for large-scale computing
while praising DeepSeek’s efficiency:</p>
<blockquote>
<p><em>"Does this mean you don't need large GPU clusters for frontier
LLMs? No, but you have to ensure that you're not wasteful with what you
have, and this looks like a nice demonstration that there's still a lot
to get through with both data and algorithms."</em></p>
</blockquote>
<p><strong>Satya Nadella (Microsoft CEO)</strong></p>
<p>Nadella underscored the significance of DeepSeek, highlighting its
role in making AI reasoning more accessible:</p>
<blockquote>
<p><em>"We should take the developments out of China very, very
seriously."</em> <em>"DeepSeek has had some real innovations. …
Obviously, now all that gets commoditized."</em> <em>"When token prices
fall, inference computing prices fall, that means people can consume
more, and there will be more apps written."</em></p>
</blockquote>
<p><strong>Mark Zuckerberg (Meta CEO)</strong></p>
<p>Zuckerberg acknowledged DeepSeek's novel infrastructure
optimizations:</p>
<blockquote>
<p><em>"DeepSeek had a few pretty novel infrastructure optimization
advances, which, fortunately, they published them, so we can not only
observe what they did, but we can read about it and implement it, so
that'll benefit us."</em> <em>"Always interesting when there's someone
who does something better than you. Let's make sure we are on
it."</em></p>
</blockquote>
<p><strong>Aravind Srinivas (Perplexity AI CEO)</strong></p>
<p>Srinivas stressed the importance of foundational innovation:</p>
<blockquote>
<p><em>"We need to build, not just wrap existing AI."</em></p>
</blockquote>
<p><strong>Marc Andreessen (Andreessen Horowitz Co-founder)</strong></p>
<p>He likened DeepSeek-R1 to a historic milestone:</p>
<blockquote>
<p><em>"DeepSeek R1 is AI's Sputnik moment."</em></p>
</blockquote>
<p><strong>Tim Cook (Apple CEO)</strong></p>
<p>Cook gave a measured response during an earnings call:</p>
<blockquote>
<p><em>"In general, I think innovation that drives efficiency is a good
thing."</em></p>
</blockquote>
<h2 id="academic-and-research-perspectives"><strong>Academic and
Research Perspectives</strong></h2>
<p><strong>AI Researchers on DeepSeek-R1</strong>:</p>
<p><strong>Timnit Gebru (AI Ethics Researcher)</strong></p>
<p>Gebru reflected on past AI development priorities:</p>
<blockquote>
<p><em>"At Google, I asked why they were fixated on building THE LARGEST
model. Why are you going for size? What function are you trying to
achieve? They responded by firing me."</em></p>
</blockquote>
<p><strong>Ethan Mollick (Wharton AI Professor)</strong></p>
<p>Mollick focused on accessibility rather than capabilities:</p>
<blockquote>
<p><em>"DeepSeek is a really good model, but it is not generally a
better model than o1 or Claude. But since it is both free and getting a
ton of attention, I think a lot of people who were using free 'mini'
models are being exposed to what an early 2025 reasoner AI can do and
are surprised."</em></p>
</blockquote>
<p><strong>Andrew Ng (AI Researcher and Entrepreneur)</strong></p>
<p>Ng saw the market reaction as an opportunity for developers:</p>
<blockquote>
<p><em>"Today's 'DeepSeek selloff' in the stock market—attributed to
DeepSeek V3/R1 disrupting the tech ecosystem—is another sign that the
application layer is a great place to be. The foundation model layer
being hyper-competitive is great for people building
applications."</em></p>
</blockquote>
<p><strong>Global Academic Community Response</strong>:</p>
<p>Huan Sun from Ohio State University noted that DeepSeek's
affordability is expanding LLM adoption in research. Cong Lu from the
University of British Columbia highlighted R1’s rapid adoption,
surpassing 3 million downloads on Hugging Face in a week. Meanwhile,
safety concerns emerged as studies revealed R1 is 11 times more likely
to generate harmful content compared to OpenAI models, prompting calls
for better safeguards.</p>
<h2 id="impact-discussion">Impact Discussion</h2>
<p><strong>Market and Industry Impact</strong></p>
<p>The release of DeepSeek-R1 caused massive shifts in financial
markets. U.S. tech stocks collectively lost <span
class="math inline">\(\$1\)</span> trillion, with Nvidia suffering
record losses due to the rising competition from this cost-efficient
model. Investors are recalibrating AI development strategies as DeepSeek
achieved comparable performance to OpenAI’s models at just <span
class="math inline">\(\$6\)</span> million versus OpenAI’s <span
class="math inline">\(\$100\)</span> million.</p>
<p><strong>Integration into Cloud Ecosystems</strong></p>
<p>AWS and Microsoft Azure have incorporated DeepSeek-R1, enabling
developers to explore its capabilities securely and cost-effectively.
The emergence of cost-effective models like DeepSeek R1 is forcing a
shift in AI economics, emphasizing efficiency over massive capital
investments. As a result, competition in the AI sector is intensifying,
ushering in a “warring states era” where companies are scrambling for
innovation in cost-effective models.</p>
<p><strong>Geopolitical and National Security Implications</strong></p>
<p>The success of DeepSeek R1 has intensified concerns that the U.S. is
losing its technological edge to China. Policymakers are reassessing
export controls on advanced chips in light of DeepSeek's ability to
innovate using restricted hardware. Security concerns have also prompted
the U.S. Navy to ban the use of DeepSeek R1 due to potential security
and ethical risks, fueling debates over the implications of adopting
foreign-developed AI systems.</p>
<p><strong>Open-Source vs Proprietary Models</strong></p>
<p>DeepSeek R1 is accelerating the democratization of AI by lowering
barriers for smaller developers and researchers, fostering innovation.
However, transparency concerns remain as DeepSeek has not disclosed its
training data, raising ethical and bias-related questions.</p>
<p><strong>Ethical and Technical Questions</strong></p>
<p>Concerns have emerged regarding potential censorship, as some
versions of DeepSeek R1 appear to align with Chinese narratives.
Additionally, skepticism exists over whether DeepSeek’s reported costs
and capabilities are fully accurate, with some experts questioning the
factors that contributed to its success.</p>
<p><strong>Public Sentiment and the Future of AI</strong></p>
<p>Public reaction to DeepSeek-R1 has been mixed. Some view this as a
“Sputnik moment,” encouraging U.S. firms to accelerate AI innovation
while leveraging open-source models to stay competitive. Others see it
as a wake-up call, with former President Donald Trump urging U.S.
industries to adapt quickly to maintain leadership in AI
development.</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://jokerdii.github.io/di-blog/2025/01/24/Persisting-Agent-State/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/di-blog/images/avatar.gif">
      <meta itemprop="name" content="Di Zhen">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Di's Blog">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Di's Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/di-blog/2025/01/24/Persisting-Agent-State/" class="post-title-link" itemprop="url">Persisting Agent State</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2025-01-24 22:25:22" itemprop="dateCreated datePublished" datetime="2025-01-24T22:25:22-05:00">2025-01-24</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h2 id="persistence-in-langgraph">Persistence in LangGraph</h2>
<p><a
target="_blank" rel="noopener" href="https://langchain-ai.github.io/langgraph/concepts/persistence/">Persistence</a>
is a cornerstone for building robust and production-grade applications.
LandGraph introduces a game-changing feature that ensures application
states are stored and retrievable at any point. This redefines
reliability and scalability in workflow management. This capability is
especially vital when executing workflows involving interruptions, user
inputs, or debugging. Whether you're building a simple app or an
enterprise-grade system, persistence ensures your application is always
ready to handle interruptions and user interactions gracefully.</p>
<p>The "Persisting Agent Stage" enables seamless workflows, especially
in user-facing applications. Here’s why this feature is critical:</p>
<ol type="1">
<li><strong>Human-in-the-Loop Workflows:</strong> Many applications rely
on user input to make decisions or advance processes. With persistence,
LandGraph allows the graph execution to pause, checkpoint the state into
persistent storage, and resume later. This means the application can
wait for user input and continue without losing context.</li>
<li><strong>Debugging and History</strong>: Persistence creates a robust
mechanism for saving the application state after every step. This makes
debugging easier and enables the creation of detailed execution
histories.</li>
<li><strong>Support for Multi-Session Scenarios</strong>: Applications
often require users to switch between sessions while maintaining their
progress. Persistence ensures continuity by saving states into
persistent storage.</li>
</ol>
<p>At the heart of this feature is the <strong><a
target="_blank" rel="noopener" href="https://langchain-ai.github.io/langgraph/reference/checkpoints/">CheckPointer</a></strong>
object, a persistence layer implemented by LandGraph. Here’s how it
works:</p>
<ul>
<li><p><strong>Integration with Databases</strong> The CheckPointer can
save states into various database types, including:</p>
<ul>
<li><strong>Document databases</strong>: Firestore, MongoDB</li>
<li><strong>Relational databases</strong>: PostgreSQL, SQLite,
MySQL</li>
<li><strong>Graph databases</strong>: Neo4j, AWS Neptune</li>
</ul>
<p>For example, the following section will focus on persisting states
into an SQLite database, a popular choice for local environments. The
process can also be extended to managed cloud databases like Google
Cloud SQL or AWS RDS.</p></li>
<li><p><strong>State Management</strong> As each node in the graph
executes, the CheckPointer saves the updated state into the database.
This ensures that states are recoverable after interruptions, enabling
the graph to resume execution from exactly where it left off.</p></li>
</ul>
<p>To implement persistence, follow these simple steps:</p>
<ol type="1">
<li>Import the <strong>CheckPointer</strong> object from LandGraph.</li>
<li>Create an instance of CheckPointer and configure it with a
connection string (local or cloud-based database).</li>
<li>Pass the CheckPointer instance to your graph during creation.
LandGraph will handle state persistence automatically after each node
execution.</li>
</ol>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> langgraph.checkpoint.sqlite <span class="keyword">import</span> SqliteSaver</span><br><span class="line"></span><br><span class="line">memory = SqliteSaver.from_conn_string(<span class="string">&quot;:checkpoints.sqlite:&quot;</span>)</span><br><span class="line">graph = workflow.complie(checkpointer=memory)</span><br></pre></td></tr></table></figure>
<p>The result is that you can pause the graph, fetch user input, and
continue execution seamlessly, all while ensuring states are securely
stored in your chosen database.</p>
<h2 id="memorysaver-interrupts-human-in-the-loop">MemorySaver +
Interrupts = Human In The Loop</h2>
<p>Human-in-the-loop systems are essential to modern applications,
allowing seamless integration of human feedback into automated
workflows. With the help of the <strong>MemorySaver</strong> feature,
you can build applications using LangGraph that pause, capture user
input, and resume execution effortlessly.</p>
<p>In workflows involving human interaction, there are moments where the
application needs to pause, gather feedback from the user, and then
continue processing. For instance, consider a sequence of tasks
where:</p>
<ol type="1">
<li>A process executes its initial steps.</li>
<li>The system pauses to collect human input.</li>
<li>The workflow resumes, incorporating the user’s feedback.</li>
</ol>
<p>This type of flow requires <strong>interrupts</strong> to halt the
execution and <strong>persistence</strong> to save the current state of
the workflow. Langraph provides the tools to manage both seamlessly.</p>
<h3 id="implementation">Implementation</h3>
<p>To illustrate, let’s build a straightforward graph with the following
steps:</p>
<ol type="1">
<li>Start with a simple initial node.</li>
<li>Execute a task and pause for human feedback.</li>
<li>Resume execution with the updated state and complete the
workflow.</li>
</ol>
<p>We use Langraph's <strong>MemorySaver</strong>, a checkpointing tool
that saves the workflow’s state in memory after each node’s execution.
This ephemeral storage method is perfect for local testing and
prototyping. Here’s a simplified version of the setup:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> dotenv <span class="keyword">import</span> load_dotenv</span><br><span class="line"></span><br><span class="line">load_dotenv()</span><br><span class="line"><span class="keyword">from</span> typing <span class="keyword">import</span> TypedDict</span><br><span class="line"><span class="keyword">from</span> langgraph.graph <span class="keyword">import</span> StateGraph, START, END</span><br><span class="line"><span class="keyword">from</span> langgraph.checkpoint.memory <span class="keyword">import</span> MemorySaver</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">State</span>(<span class="title class_ inherited__">TypedDict</span>):</span><br><span class="line">    <span class="built_in">input</span>: <span class="built_in">str</span></span><br><span class="line">    user_feedback: <span class="built_in">str</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">step_1</span>(<span class="params">state: State</span>) -&gt; <span class="literal">None</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;---Step 1---&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">human_feedback</span>(<span class="params">state: State</span>) -&gt; <span class="literal">None</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;---human_feedback---&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">step_3</span>(<span class="params">state: State</span>) -&gt; <span class="literal">None</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;---Step 3--&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">builder = StateGraph(State)</span><br><span class="line">builder.add_node(<span class="string">&quot;step_1&quot;</span>, step_1)</span><br><span class="line">builder.add_node(<span class="string">&quot;human_feedback&quot;</span>, human_feedback)</span><br><span class="line">builder.add_node(<span class="string">&quot;step_3&quot;</span>, step_3)</span><br><span class="line">builder.add_edge(START, <span class="string">&quot;step_1&quot;</span>)</span><br><span class="line">builder.add_edge(<span class="string">&quot;step_1&quot;</span>, <span class="string">&quot;human_feedback&quot;</span>)</span><br><span class="line">builder.add_edge(<span class="string">&quot;human_feedback&quot;</span>, <span class="string">&quot;step_3&quot;</span>)</span><br><span class="line">builder.add_edge(<span class="string">&quot;step_3&quot;</span>, END)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">memory = MemorySaver()</span><br><span class="line"></span><br><span class="line">graph = builder.<span class="built_in">compile</span>(checkpointer=memory, interrupt_before=[<span class="string">&quot;human_feedback&quot;</span>])</span><br><span class="line"></span><br><span class="line">graph.get_graph().draw_mermaid_png(output_file_path=<span class="string">&quot;graph.png&quot;</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>The graph visualization by using <a
target="_blank" rel="noopener" href="https://python.langchain.com/api_reference/core/runnables/langchain_core.runnables.graph.MermaidDrawMethod.html">Mermaid.ink</a>
is here:</p>
<figure>
<img src="/di-blog/2025/01/24/Persisting-Agent-State/hitl-graph.png"
alt="hitl-graph" />
<figcaption aria-hidden="true">hitl-graph</figcaption>
</figure>
<h2 id="memorysaver-implementations">MemorySaver Implementations</h2>
<p>Integrating human feedback into automated systems is a growing trend
in AI development. It bridges the gap between machine automation and
human judgment, enabling better decision-making, improved accuracy, and
adaptability. In this section, we explore how to incorporate
human-in-the-loop functionality into a graph-based system while
leveraging memory storage to track execution states. This walkthrough
showcases the process from initialization to final execution.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> dotenv <span class="keyword">import</span> load_dotenv</span><br><span class="line"></span><br><span class="line">load_dotenv()</span><br><span class="line"><span class="keyword">from</span> typing <span class="keyword">import</span> TypedDict</span><br><span class="line"><span class="keyword">from</span> langgraph.graph <span class="keyword">import</span> StateGraph, START, END</span><br><span class="line"><span class="keyword">from</span> langgraph.checkpoint.memory <span class="keyword">import</span> MemorySaver</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">State</span>(<span class="title class_ inherited__">TypedDict</span>):</span><br><span class="line">    <span class="built_in">input</span>: <span class="built_in">str</span></span><br><span class="line">    user_feedback: <span class="built_in">str</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">step_1</span>(<span class="params">state: State</span>) -&gt; <span class="literal">None</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;### Step 1 ###&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">human_feedback</span>(<span class="params">state: State</span>) -&gt; <span class="literal">None</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;### Human Feedback ###&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">step_3</span>(<span class="params">state: State</span>) -&gt; <span class="literal">None</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;### Step 3 ###&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">builder = StateGraph(State)</span><br><span class="line">builder.add_node(<span class="string">&quot;step_1&quot;</span>, step_1)</span><br><span class="line">builder.add_node(<span class="string">&quot;human_feedback&quot;</span>, human_feedback)</span><br><span class="line">builder.add_node(<span class="string">&quot;step_3&quot;</span>, step_3)</span><br><span class="line">builder.add_edge(START, <span class="string">&quot;step_1&quot;</span>)</span><br><span class="line">builder.add_edge(<span class="string">&quot;step_1&quot;</span>, <span class="string">&quot;human_feedback&quot;</span>)</span><br><span class="line">builder.add_edge(<span class="string">&quot;human_feedback&quot;</span>, <span class="string">&quot;step_3&quot;</span>)</span><br><span class="line">builder.add_edge(<span class="string">&quot;step_3&quot;</span>, END)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">memory = MemorySaver()</span><br><span class="line"></span><br><span class="line">graph = builder.<span class="built_in">compile</span>(checkpointer=memory, interrupt_before=[<span class="string">&quot;human_feedback&quot;</span>])</span><br><span class="line"></span><br><span class="line">graph.get_graph().draw_mermaid_png(output_file_path=<span class="string">&quot;graph.png&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    thread = &#123;<span class="string">&quot;configurable&quot;</span>: &#123;<span class="string">&quot;thread_id&quot;</span>: <span class="string">&quot;1&quot;</span>&#125;&#125;</span><br><span class="line"></span><br><span class="line">    initial_input = &#123;<span class="string">&quot;input&quot;</span>: <span class="string">&quot;hello world&quot;</span>&#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> event <span class="keyword">in</span> graph.stream(initial_input, thread, stream_mode=<span class="string">&quot;values&quot;</span>):</span><br><span class="line">        <span class="built_in">print</span>(event)</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(graph.get_state(thread).<span class="built_in">next</span>)</span><br><span class="line"></span><br><span class="line">    user_input = <span class="built_in">input</span>(<span class="string">&quot;How do you want to update the state? &quot;</span>)</span><br><span class="line"></span><br><span class="line">    graph.update_state(thread, &#123;<span class="string">&quot;user_feedback&quot;</span>: user_input&#125;, as_node=<span class="string">&quot;human_feedback&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;### State after update ###&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(graph.get_state(thread))</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(graph.get_state(thread).<span class="built_in">next</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> event <span class="keyword">in</span> graph.stream(<span class="literal">None</span>, thread, stream_mode=<span class="string">&quot;values&quot;</span>):</span><br><span class="line">        <span class="built_in">print</span>(event)</span><br></pre></td></tr></table></figure>
<p>The graph’s execution is tied to a <code>thread</code> variable, a
dictionary initialized with a <code>thread_id</code>. This serves as a
session or conversation identifier, distinguishing various graph runs.
For simplicity, the <code>thread_id</code> is set to <code>1</code>,
though a more robust implementation would use a UUID. The graph
processes events using <code>graph.stream()</code>, which accepts the
initial input and thread details. Events are streamed in value mode, and
each event is printed for transparency.</p>
<p>During execution:</p>
<ul>
<li>Input is processed.</li>
<li>Node executions are logged.</li>
<li>Interruptions allow for dynamic human input.</li>
</ul>
<p>Running the graph in debug mode provides insights into:</p>
<ul>
<li>Memory storage (<code>memory.storage</code>) containing nested
objects that log the graph state.</li>
<li>Transition logs for each node, showing updates or lack thereof.</li>
</ul>
<p>At an interrupt, human feedback is solicited using Python's built-in
<code>input()</code> function. This input updates the state dynamically.
Once human input is integrated, the graph resumes execution. Subsequent
steps process the updated state, leading to the graph’s completion.</p>
<h2 id="sqlitesaver">SqliteSaver</h2>
<p>Switching from an ephemeral memory-based state saver to a persistent
database saver can significantly enhance the durability and traceability
of your graph’s execution. In this section, we’ll explore how to replace
the in-memory <code>MemorySaver</code> with an <code>SQLiteSaver</code>
for long-term storage and easy debugging.</p>
<p>The <code>MemorySaver</code> is transient, meaning all state
information vanishes after the program stops. By using an SQLite
database, you can:</p>
<ul>
<li>Persist graph states across runs.</li>
<li>Debug and troubleshoot using a structured database.</li>
<li>Resume executions exactly where they were interrupted.</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> sqlite3</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> dotenv <span class="keyword">import</span> load_dotenv</span><br><span class="line"><span class="keyword">from</span> langgraph.checkpoint.sqlite <span class="keyword">import</span> SqliteSaver</span><br><span class="line"></span><br><span class="line">load_dotenv()</span><br><span class="line"><span class="keyword">from</span> typing <span class="keyword">import</span> TypedDict</span><br><span class="line"><span class="keyword">from</span> langgraph.graph <span class="keyword">import</span> StateGraph, START, END</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">State</span>(<span class="title class_ inherited__">TypedDict</span>):</span><br><span class="line">    <span class="built_in">input</span>: <span class="built_in">str</span></span><br><span class="line">    user_feedback: <span class="built_in">str</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">step_1</span>(<span class="params">state: State</span>) -&gt; <span class="literal">None</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;### Step 1 ###&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">human_feedback</span>(<span class="params">state: State</span>) -&gt; <span class="literal">None</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;### Human Feedback ###&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">step_3</span>(<span class="params">state: State</span>) -&gt; <span class="literal">None</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;### Step 3 ###&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">builder = StateGraph(State)</span><br><span class="line">builder.add_node(<span class="string">&quot;step_1&quot;</span>, step_1)</span><br><span class="line">builder.add_node(<span class="string">&quot;human_feedback&quot;</span>, human_feedback)</span><br><span class="line">builder.add_node(<span class="string">&quot;step_3&quot;</span>, step_3)</span><br><span class="line">builder.add_edge(START, <span class="string">&quot;step_1&quot;</span>)</span><br><span class="line">builder.add_edge(<span class="string">&quot;step_1&quot;</span>, <span class="string">&quot;human_feedback&quot;</span>)</span><br><span class="line">builder.add_edge(<span class="string">&quot;human_feedback&quot;</span>, <span class="string">&quot;step_3&quot;</span>)</span><br><span class="line">builder.add_edge(<span class="string">&quot;step_3&quot;</span>, END)</span><br><span class="line"></span><br><span class="line">conn = sqlite3.connect(<span class="string">&quot;checkpoints.sqlite&quot;</span>, check_same_thread=<span class="literal">False</span>)</span><br><span class="line">memory = SqliteSaver(conn)</span><br><span class="line">graph = builder.<span class="built_in">compile</span>(checkpointer=memory, interrupt_before=[<span class="string">&quot;human_feedback&quot;</span>])</span><br><span class="line"></span><br><span class="line">graph.get_graph().draw_mermaid_png(output_file_path=<span class="string">&quot;graph.png&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    thread = &#123;<span class="string">&quot;configurable&quot;</span>: &#123;<span class="string">&quot;thread_id&quot;</span>: <span class="string">&quot;1&quot;</span>&#125;&#125;</span><br><span class="line"></span><br><span class="line">    initial_input = &#123;<span class="string">&quot;input&quot;</span>: <span class="string">&quot;hello world&quot;</span>&#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> event <span class="keyword">in</span> graph.stream(initial_input, thread, stream_mode=<span class="string">&quot;values&quot;</span>):</span><br><span class="line">        <span class="built_in">print</span>(event)</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(graph.get_state(thread).<span class="built_in">next</span>)</span><br><span class="line"></span><br><span class="line">    user_input = <span class="built_in">input</span>(<span class="string">&quot;How do you want to update the state: &quot;</span>)</span><br><span class="line"></span><br><span class="line">    graph.update_state(thread, &#123;<span class="string">&quot;user_feedback&quot;</span>: user_input&#125;, as_node=<span class="string">&quot;human_feedback&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;### State after update ###&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(graph.get_state(thread))</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(graph.get_state(thread).<span class="built_in">next</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> event <span class="keyword">in</span> graph.stream(<span class="literal">None</span>, thread, stream_mode=<span class="string">&quot;values&quot;</span>):</span><br><span class="line">        <span class="built_in">print</span>(event)</span><br></pre></td></tr></table></figure>
<p>We start by importing the required modules. Then Initialize a
connection to your SQLite database. The
<code>check_same_thread=False</code> flag ensures thread-safe database
operations, essential for stopping and restarting execution across
different threads. After that we create an instance of
<code>SQLiteSaver</code> and pass it the SQLite connection. This saver
integrates seamlessly with the graph execution pipeline, persisting
states to the SQLite database.</p>
<ol type="1">
<li><strong>Initial Execution</strong>: Run the graph with the
<code>SQLiteSaver</code>. After execution, you’ll see a new file,
<code>checkpoints.sqlite</code>, created in your project directory.</li>
<li><strong>Inspect the Database</strong>: Use your IDE’s database tools
(e.g. SQLite3 Editor for VS Code) to load and inspect the
<code>checkpoints.sqlite</code> file. You’ll find a table storing graph
states, similar to what you’d see with <code>MemorySaver</code>, but now
it’s persistent.</li>
</ol>
<figure>
<img
src="/di-blog/2025/01/24/Persisting-Agent-State/screenshot_sqlite_ide.png"
alt="screenshot_sqlite_ide" />
<figcaption aria-hidden="true">screenshot_sqlite_ide</figcaption>
</figure>
<p>Changing the <code>thread_id</code> allows you to simulate a new
session while retaining access to previous runs. When resuming, the
graph starts from the last recorded state. You can verify this by
inspecting the database entries for the new <code>thread_id</code>.</p>
<p>For enhanced traceability, integrate Langsmith for tracking and
debugging. Langsmith provides detailed insights, including thread
metadata and execution traces.</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://jokerdii.github.io/di-blog/2025/01/04/2025-January/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/di-blog/images/avatar.gif">
      <meta itemprop="name" content="Di Zhen">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Di's Blog">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Di's Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/di-blog/2025/01/04/2025-January/" class="post-title-link" itemprop="url">2025 January - What I Have Read</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2025-01-04 00:05:36" itemprop="dateCreated datePublished" datetime="2025-01-04T00:05:36-05:00">2025-01-04</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h2 id="substack">Substack</h2>
<blockquote>
<p><strong>How Meta Plans To Crank the Dopamine Machine With Infinite
AI-Generated Content - The Algorithmic Bridge</strong> [<a
target="_blank" rel="noopener" href="https://www.thealgorithmicbridge.com/p/how-meta-plans-to-crank-the-dopamine">Link</a>]</p>
</blockquote>
<p>This article discussed AI’s most dangerous potential - its ability to
manipulate and addict humans through hyper-targeted entertainment. This
trend, spearheaded by companies like Meta, risks reshaping human
cognition and agency, raising existential questions about freedom,
pleasure, and the future of society.</p>
<p>One good point is that the killer robots are brain-hacking
entertainment. A very plausible dystopia involves technology (e.g.,
AI-driven entertainment) manipulating human attention and cognition for
profit. Traditional TV was a prototype of mental manipulation but lacked
personalization. Current platforms such as Netflix and TikTok use
algorithms to cater to preferences but still feel limited. Future AI
will create hyper-personalized content tailored to individual
preferences in real-time, exploiting human psychology. Meta’s generative
AI plans are the next step toward addictive, manipulative entertainment.
Meta announced that AI content creators will be designed to enhance
engagement on platforms like Facebook and Instagram. Connor Hayes,
Meta’s VP for generative AI, explained how AI accounts will create and
share engaging content.</p>
<blockquote>
<p><strong>The Five Stages of AGI Grief - Marcus on AI</strong> [<a
target="_blank" rel="noopener" href="https://garymarcus.substack.com/p/the-five-stages-of-agi-grief">Link</a>]</p>
</blockquote>
<p>Marcus uses the framework of the Kübler-Ross model of grief to
describe the emotional responses people are having (or will likely have)
to the ongoing developments in Artificial General Intelligence (AGI). He
argues that many people are not yet facing the reality of AGI and are
likely to go through similar stages of grief as it gets closer.</p>
<ol type="1">
<li>Denial: Many people, including some experts, are still in denial
about the possibility and speed of AGI development. They dismiss the
progress, underestimate its potential, or claim it's decades away.</li>
<li>Anger: Once denial fades, anger emerges, often directed at those
perceived as enabling or hyping AGI. This can be targeted at AI
researchers, tech companies, or even the technology itself.</li>
<li>Bargaining: In this stage, people try to find ways to control or
mitigate AGI, often through unrealistic expectations or proposed
solutions.</li>
<li>Depression: As bargaining fails, a sense of profound unease and
hopelessness may set in. This is the realization that AGI could
fundamentally change society in ways that are difficult to predict or
control, leading to feelings of powerlessness.</li>
<li>Acceptance: This is the final stage, where people begin to accept
the reality of AGI and its potential impact. This isn't necessarily
cheerful, but it's characterized by a shift from denial and fear towards
a more realistic view.</li>
</ol>
<blockquote>
<p><strong>The Taiwan posts - Noahpinion</strong> [<a
target="_blank" rel="noopener" href="https://www.noahpinion.blog/p/the-taiwan-posts">Link</a>]</p>
</blockquote>
<blockquote>
<p><strong>Disney Paid Off Trump for a Reason - BIG by Matt
Stoller</strong> [<a
target="_blank" rel="noopener" href="https://www.thebignewsletter.com/p/disney-paid-off-trump-for-a-reason">Link</a>]</p>
</blockquote>
<p>Fubo, a sports streaming service, had previously won a preliminary
injunction against a joint venture between Disney, Fox, and Warner Bros,
arguing that the venture was an illegal merger. However, Fubo's stock
wasn't performing well, leading Fubo CEO David Gandler to sell a
controlling stake in his company to Disney.</p>
<p>Here are the rationales behind this decision, according to the
sources:</p>
<ul>
<li>Fubo's CEO, David Gandler, profited from winning an antitrust suit
and joined forces with a large corporation. Instead of being an underdog
fighting against major corporations, Fubo has now joined forces with one
of them. Fubo will now have Disney's resources, while its leaders
imagine that it will operate somewhat independently.</li>
<li>Disney made a $16 million payment for defamation against Trump,
which is considered questionable by legal analysts, in order to gain
credibility with Trump. The aim of this was to ensure that government
enforcers would not interfere with the deal.</li>
<li>Fubo's leaders may be ignoring the risks involved in the merger.
They are potentially exhibiting a kind of "malevolent naivete" and
airbrushing away their own violation of the law.</li>
</ul>
<p>The sources suggest that Fubo's leadership may not be considering
some of the risks associated with mergers. Mergers carry significant
risk, and they can fall apart for a variety of reasons. During the 18-24
months that it takes to clear financing and regulatory hurdles, a
company under contract to be sold cannot make significant strategic
decisions or investments, while the purchaser can do whatever they want.
If the deal falls apart, the company that was to be sold could be in a
significantly worse position.</p>
<p>The sources point out that there is a possibility that another
private litigant could take Fubo's place and sue, using the legal
precedent set by Fubo. This is evidenced by a letter sent by EchoStar to
the court, in which the company states that it's considering suing along
the same lines as Fubo. This may not matter to Disney, since they now
control Fubo, but it should be a source of concern for Fubo's leadership
team who have essentially bet their company on a violation of the
law.</p>
<p>A private litigant, such as EchoStar, could take Fubo's place and sue
Disney, Fox, and Warner Bros, using the same legal arguments that Fubo
successfully used to win a preliminary injunction. This is a possibility
because the legal precedent set by Fubo remains, even though Fubo is now
under Disney's control.</p>
<p>Here's why this could be problematic for Fubo but not necessarily for
Disney:</p>
<ul>
<li>Fubo is in a vulnerable position due to the merger agreement. While
the deal is pending, Fubo is restricted in its strategic decision-making
and investments, effectively putting the company in "limbo". This means
Fubo cannot make significant moves to respond to a new lawsuit.</li>
<li>Disney, as the purchaser, is not similarly restricted. They can
continue to operate as they see fit. They have the resources to handle a
new legal challenge.</li>
<li>If the merger fails, Fubo will have wasted 18-24 months with the
potential for no significant strategic moves. It could end up in a
weakened state compared to competitors who were not in a merger process.
The company might even become "a limping and probably dead company".
Failed mergers can also lead to leadership changes, such as the CEO
getting fired.</li>
<li>Disney has already taken steps to ensure the deal's success,
including a payment to gain credibility with the current administration.
While another lawsuit could present a challenge, Disney has the
resources and political connections to navigate it, which Fubo does
not.</li>
<li>The incentive to complete the deal is different for Disney and Fubo.
Disney will remain a major player regardless of the deal's outcome.
However, Fubo's future is heavily dependent on the merger. This makes
Fubo more vulnerable if the deal is challenged.</li>
</ul>
<blockquote>
<p><strong>The rise and fall of "fact-checking" - Silver
Bulletin</strong> [<a
target="_blank" rel="noopener" href="https://www.natesilver.net/p/the-rise-and-fall-of-fact-checking">Link</a>]</p>
</blockquote>
<p>The main opinion of this article is that Meta's decision to replace
fact-checkers with a community notes system is justifiable because
fact-checkers have been politically biased and have not effectively
addressed the issue of misinformation.</p>
<p>While the author agrees with Zuckerberg's decision, they also
acknowledge that Zuckerberg's motivations may not be high-minded, but
rather driven by political pressure and business incentives. Despite
that, the author thinks the move is "pointing in the right direction,"
and agrees with Zuckerberg's claim that fact-checkers have been too
politically biased. The author also admits their own biases and that
Community Notes is a new program that might also have problems.</p>
<blockquote>
<p><strong>US Banks: Profits Surge - App Economy Insights</strong> [<a
target="_blank" rel="noopener" href="https://www.appeconomyinsights.com/p/us-banks-profits-surge">Link</a>]</p>
</blockquote>
<blockquote>
<p><strong>CES 2025: AI Takes Over - App Economy Insights</strong> [<a
target="_blank" rel="noopener" href="https://www.appeconomyinsights.com/p/ces-2025-ai-takes-over">Link</a>]</p>
</blockquote>
<blockquote>
<p><strong>a16z's big ideas in tech for 2025 - ben lang's notes</strong>
[<a
target="_blank" rel="noopener" href="https://benlangsnotes.substack.com/p/a16zs-big-ideas-in-tech-for-2025">Link</a>]</p>
</blockquote>
<p>Andreessen Horowitz’s list of big ideas in tech for 2025:</p>
<figure>
<img src="/di-blog/2025/01/04/2025-January/a16z_big_idea_2025.png"
alt="a16z_big_idea_2025" />
<figcaption aria-hidden="true">a16z_big_idea_2025</figcaption>
</figure>
<blockquote>
<p><strong>How AI-assisted coding will change software engineering: hard
truths - The Pragmatic Engineer</strong> [<a
target="_blank" rel="noopener" href="https://newsletter.pragmaticengineer.com/p/how-ai-will-change-software-engineering">Link</a>]</p>
</blockquote>
<p>Great article!</p>
<blockquote>
<p><em>This "70% problem" suggests that current AI coding tools are best
viewed as:</em></p>
<ul>
<li><em>Prototyping accelerators for experienced developers</em></li>
<li><em>Learning aids for those committed to understanding
development</em></li>
<li><em>MVP generators for validating ideas quickly</em></li>
</ul>
<p><em>Current tools mostly wait for our commands. But look at newer
features like Anthropic's computer use in Claude, or Cline's ability to
automatically launch browsers and run tests. These aren't just glorified
autocomplete - they're actually understanding tasks and taking
initiative to solve problems.</em></p>
<p><em>Think about debugging: Instead of just suggesting fixes, these
agents can:</em></p>
<ul>
<li><em>Proactively identify potential issues</em></li>
<li><em>Launch and run test suites</em></li>
<li><em>Inspect UI elements and capture screenshots</em></li>
<li><em>Propose and implement fixes</em></li>
<li><em>Validate the solutions work (this could be a big deal)</em></li>
</ul>
<p><strong>― The 70% problem: Hard truths about AI-assisted coding -
Elevate</strong> [<a
target="_blank" rel="noopener" href="https://addyo.substack.com/p/the-70-problem-hard-truths-about">Link</a>]</p>
</blockquote>
<p>Great pragmatic article! And it's well-said in the end:
"<strong><em>Software quality was (perhaps) never primarily limited by
coding speed...The goal isn't to write more code faster. It's to build
better software.</em></strong> "</p>
<p>AI tools help experienced developers more than beginners. This is
similar to the fact that AI helps top biologists to be successful more
than normal biologists. The results and efficiency of AI usage differ
based on users' domain expertise. This is called 'knowledge paradox'. AI
can help to get the first 70% job done quickly, but the efforts on the
final 30% have diminishing returns. This is called 'AI learning curve
paradox'.</p>
<blockquote>
<p><strong>o1 isn’t a chat model (and that’s the point) - Latent
Space</strong> [<a
target="_blank" rel="noopener" href="https://www.latent.space/p/o1-skill-issue?utm_source=%2Finbox%2Fsaved&amp;utm_medium=reader2">Link</a>]</p>
</blockquote>
<ul>
<li><p>Provide Extensive Context: Give 10x more context than you think
is necessary. This includes details about previous attempts, database
schemas, and company-specific information. Think of o1 like a new hire
that needs all the relevant information to understand the task. Put the
context at the end of your prompt.</p>
<p>Use tools like voice memos to capture context and paste transcripts.
You can also save reusable segments of context for future use. AI
assistants within other products can help extract context.</p></li>
<li><p>Focus on the Desired Output: Instead of telling o1 <em>how</em>
to answer, clearly describe <em>what</em> you want the output to be. Let
o1 plan and resolve its own steps, leveraging its autonomous
reasoning.</p></li>
<li><p>Define Clear Evaluation Criteria: Develop specific criteria for
what constitutes a "good" output so that o1 can evaluate its own output
and improve. This moves the LLM-as-Judge into the prompt itself. Ask for
one specific output per prompt.</p></li>
<li><p>Be Explicit About Output Format: o1 often defaults to a
report-style output with numbered headings. Be clear if you need
complete files or other specific formats.</p></li>
<li><p>Manage Context and Expect Latency: Since o1 is not a chat model,
it will not respond in real time, like email. Make sure you can manage
and see the context you are providing to the model. o1 is better suited
to high-latency, long-running tasks.</p></li>
</ul>
<blockquote>
<p><strong>The Deep Roots of DeepSeek: How It All Began - Recode China
AI</strong> [<a
target="_blank" rel="noopener" href="https://recodechinaai.substack.com/p/the-deep-roots-of-deepseek-how-it">Link</a>]</p>
</blockquote>
<p>Liang's Visions from his first public interview in May 2023:</p>
<p><strong>AI Development:</strong></p>
<ul>
<li>Liang aims to build AGI, not just improve existing models like
ChatGPT.</li>
<li>He prioritizes deep research over quick applications, requiring more
resources.</li>
<li>He sees AI as a way to test ideas about human intelligence, like
whether language is key to thought.</li>
<li>He plans to share DeepSeek’s results publicly to keep AI accessible
and affordable.</li>
</ul>
<p><strong>Company Culture &amp; Innovation:</strong></p>
<ul>
<li>He hires based on ability, creativity, and passion, preferring fresh
graduates for key roles.</li>
<li>Employees should have freedom to explore and learn from
mistakes.</li>
<li>It can't be forced or taught.</li>
<li>A shared pace and curiosity drive the team, not strict rules or
KPIs.</li>
</ul>
<p><strong>Competition:</strong></p>
<ul>
<li>Startups can still challenge big companies since AI tech is
evolving.</li>
<li>No one has a clear lead in AI yet.</li>
<li>LLM applications will become easier, creating startup opportunities
for decades.</li>
<li>AI believers stay in for the long run.</li>
<li>Unconventional approaches can be a game-changer.</li>
</ul>
<p><strong>Resources &amp; Funding:</strong></p>
<ul>
<li>Securing GPUs and a strong engineering team is crucial.</li>
<li>Traditional VC funding may not fit DeepSeek’s research-heavy
approach.</li>
<li>Innovation is costly, and some waste is inevitable.</li>
<li>GPUs are a solid investment as they hold value.</li>
</ul>
<blockquote>
<p><strong>Is DeepSeek the new DeepMind? - AI Supremacy</strong> [<a
target="_blank" rel="noopener" href="https://www.ai-supremacy.com/p/deepseek-the-new-google-deepmind">Link</a>]</p>
</blockquote>
<p><strong>Implications for the AI Industry:</strong></p>
<ul>
<li>DeepSeek's emergence challenges the dominance of Western AI firms
like Google DeepMind, Meta, and OpenAI. The success of DeepSeek suggests
that open-source models can outperform proprietary ones. It also calls
into question the massive spending on AI infrastructure by Big Tech
companies.</li>
<li>Its cost-effectiveness is causing enterprises to rethink their AI
strategies. The availability of high-performing, cheaper models could
disrupt the business model of companies that rely on expensive,
proprietary models.</li>
<li>Its achievements indicate that China is becoming a leader in AI,
particularly in inference-time compute and compute efficiency. This
development raises concerns about America's shrinking lead in artificial
intelligence.</li>
<li>Its open-source approach is seen as essential to keeping AI
inclusive and accessible. The ability to run powerful models on a laptop
could decentralize AI development and reduce reliance on Big Tech.</li>
</ul>
<p><strong>Arguments about US vs. China in AI:</strong></p>
<ul>
<li>The article suggests that the U.S. is losing its lead in AI
innovation due to its focus on "Tycoon capitalism" and protectionist
policies. The U.S. government's export controls on semiconductors, while
intended to slow China's progress, may be inadvertently fueling China's
self-reliance and innovation.</li>
<li>China has advantages in areas such as manufacturing, go-to-market
strategies, talent (STEM programs and ML researchers), and patents.
China's progress in various overlapping industries creates a "mutually
reinforcing feedback loop". The article implies that Chinese work
culture of empowering workers with autonomy and collaboration is a
strong contrast to the grueling work schedules, rigid hierarchies, and
internal competition that are common in Chinese tech firms.</li>
<li>The article criticizes the massive AI infrastructure projects in the
U.S. (dubbed "Project Oracle") as a scheme by the financial elite to
control the future of AI. The author argues that these projects
prioritize the interests of Big Tech and the financial elite over those
of regular citizens and that these AI infrastructure projects are
primarily intended to redistribute wealth globally to the elite.</li>
</ul>
<p><strong>Concerns about AI's Impact:</strong></p>
<ul>
<li>The author acknowledges concerns that AI could lead to wage
deflation, particularly in white-collar jobs where AI can automate
tasks.</li>
<li>It questions the assumption that AI will create more jobs than it
displaces, noting that AI coding tools could negatively impact software
engineers.</li>
<li>It also raises concerns about the potential for misuse of AI,
including the use of AI for "authoritarian" control and as a weapon in
trade wars. There are also concerns about the potential for backdoors,
Trojans, model inversion attacks, sensitive information inference, and
automated social engineering via the release of attractive but cheap AI
services.</li>
</ul>
<p><strong>Additional Info:</strong></p>
<ul>
<li>DeepSeek is an offshoot of a quantitative hedge fund, High-Flyer,
and is fully funded by them.</li>
<li>It is noted for being more transparent about its methods compared to
some Western AI firms.</li>
<li>Its mission is to "unravel the mystery of Artificial General
Intelligence (AGI) with curiosity". They focus on open-source
development, research-driven innovation, and making advanced AI
accessible to all.</li>
</ul>
<blockquote>
<p><strong>Monopoly Round-Up: China Embarrasses U.S. Big Tech - BIG by
Matt Stoller</strong> [<a
target="_blank" rel="noopener" href="https://www.thebignewsletter.com/p/monopoly-round-up-china-embarrasses">Link</a>]</p>
</blockquote>
<ul>
<li>DeepSeek, a Chinese AI firm, developed cost-effective AI models that
rival U.S. models and released them on an open-source basis. This is a
significant accomplishment, especially since the U.S. has placed export
controls that prevent China from accessing the best chips. DeepSeek's
approach focused on efficiency, rather than raw computing power, which
challenges the assumption that computing power is the primary
competitive barrier in AI. This development is considered
<strong>embarrassing and threatening to big tech and U.S.
security.</strong></li>
<li>The U.S. has heavily invested in AI, with tech giants spending
billions on data centers and infrastructure, betting that these
investments will provide a competitive advantage. However, DeepSeek’s
success suggests that this approach may be flawed. The sources suggest
that <strong>the U.S. strategy of denying top chips to China may also be
ineffective.</strong></li>
<li>The sources argue that betting on monopolistic national champions is
a disastrous national security strategy. It points out that history
shows that <strong>monopolies are slow to innovate. The U.S. needs to
prioritize competition over protecting monopolies.</strong> The sources
criticize large U.S. tech firms (Meta, Microsoft, Google, Amazon, Apple)
for becoming slothful bureaucracies that are not very good at developing
and deploying technology.</li>
<li>Chinese policy is noted to be more aggressive in forcing competition
in some sectors. China's electric vehicle industry is cited as an
example of this. The Chinese government's crackdown on its big tech
firms and financial sector is also mentioned as a move that has
seemingly benefited the economy by driving innovation. The success of
companies like ByteDance and DeepSeek is mentioned as evidence of
this.</li>
<li>The sources highlight that U.S. anti-monopoly laws take too long to
take effect. It uses the example of the Federal Trade Commission's case
against Facebook for its acquisition of Instagram and WhatsApp. This
case highlights how companies like Facebook acquire and bury innovative
competitors rather than compete. It argues that <strong>if Facebook had
been broken up, there would be tremendous innovation in social
networking.</strong></li>
<li>The sources express uncertainty about the future of AI, noting it
might not live up to expectations. It also notes that the
<strong>competitive advantages in AI are not as straightforward as
previously thought</strong>.</li>
</ul>
<blockquote>
<p><em>In a <a target="_blank" rel="noopener" href="https://archive.is/JnE4j">rare interview</a> for
AnYong Waves, a Chinese media outlet, DeepSeek CEO Liang Wenfeng
emphasized innovation as the cornerstone of his ambitious
vision:</em></p>
<p><em>. . . we believe the most important thing now is to participate
in the global innovation wave. For many years, Chinese companies are
used to others doing technological innovation, while we focused on
application monetization—but this isn’t inevitable. In this wave, our
starting point is not to take advantage of the opportunity to make a
quick profit, but rather to reach the technical frontier and drive the
development of the entire ecosystem.</em></p>
<p><strong>― 7 Implications of DeepSeek’s Victory Over American AI
Companies - The Algorithmic Bridge</strong> [<a
target="_blank" rel="noopener" href="https://www.thealgorithmicbridge.com/p/7-implications-of-deepseeks-victory">Link</a>]</p>
</blockquote>
<blockquote>
<p><em>"Every job is a bundle of tasks.</em></p>
<p><em>Every new technology wave (including the ongoing rise of Gen AI)
attacks this bundle.</em></p>
<p><em>New technology may <strong>substitute</strong> a specific task
<strong>(Automation)</strong> or it may <strong>complement</strong> a
specific task <strong>(Augmentation)</strong>"</em></p>
<p><em>Extend this analogy far enough, and you get this:</em></p>
<p><em>Once technology has substituted all tasks in a job bundle, it can
effectively displace the job itself.</em></p>
<p><em>Of course, there are limits to this logic. This can only be true
for a small number of jobs, which involve task execution only.</em></p>
<p><em>But most jobs require a lot more than mere task
execution.</em></p>
<p><em>They require ‘getting things done’. They require achievement of
objectives, accomplishment of outcomes.</em></p>
<p><em>In other words, <strong>most jobs involve
goal-seeking.</strong></em></p>
<p><em>This is precisely why previous generations of technologies
haven’t fully substituted most jobs. They chip away at tasks in the job
bundle without really substituting the job entirely.</em></p>
<p><em>Because humans retain their right to play because of their
ability to plan and sequence tasks together to achieve goals.</em></p>
<p><em>In most previous instances, technology augments humans far more
than automating an entire job away.</em></p>
<p><strong><em>And that is because humans possess a unique advantage:
goal-seeking.</em></strong></p>
<p><strong>― Slow-burn AI: When augmentation, not automation, is the
real threat - Platforms, AI, and the Economics of BigTech</strong> [<a
target="_blank" rel="noopener" href="https://platforms.substack.com/p/slow-burn-ai-when-augmentation-not">Link</a>]</p>
</blockquote>
<blockquote>
<p><em>AI agents are the first instance of technology directly attacking
and substituting goals within a role or a team.</em></p>
<p><em>In doing so, they directly impact power dynamics within an
organization, empowering some roles and weakening others, empowering
some teams and weakening others.</em></p>
<p><strong>― How AI agents rewire the organization - Platforms, AI, and
the Economics of BigTech</strong> [<a
target="_blank" rel="noopener" href="https://platforms.substack.com/p/ai-wont-eat-your-job-but-it-will-880">Link</a>]</p>
</blockquote>
<p>This is a brilliant article.</p>
<p>Goal-seeking, for the first time, can be performed by technology.</p>
<ol type="1">
<li>Scope of the role: Effectively, a goal-seeking AI agent can unbundle
a goal from the role. They reduce the scope of the role.</li>
<li>Scope of the team: They displace the role entirely in a team if the
team can now achieve the same goal using an AI agent.</li>
<li>Rebundling of roles: Role B is eliminated not because its tasks were
fully substituted by technology, nor because its goals were fully
substituted by technology, but because the scope of the role no longer
justified a separate role.</li>
<li>Reworking power structures: Teams have voting rights on the
relevance of Roles. The fewer teams speaking to a role’s contributions,
the lower the negotiating power for that role within the
organization.</li>
<li>Roles unbundle, teams rebundle: this cycle of unbundling and
rebundling across roles and teams is inherent to the organization of
work. AI isn’t fundamentally changing goal-seeking and resource
allocation. It is merely inserting itself into the organization and
re-organization of work.</li>
</ol>
<h2 id="youtube-and-podcasts">YouTube and Podcasts</h2>
<blockquote>
<p><strong>2025 Predictions with bestie Gavin Baker - All-In
Podcasts</strong> [<a
target="_blank" rel="noopener" href="https://www.youtube.com/watch?v=HxNUAwBWX4I&amp;ab_channel=All-InPodcast">Link</a>]</p>
</blockquote>
<p>Interesting discussions about new year predictions. Here is a summary
of the predictions:</p>
<p><strong>Chamath Palihapitiya:</strong></p>
<ul>
<li><strong>Biggest Political Winner:</strong> Fiscal conservatives. He
believes austerity will reveal waste and fraud in the US government and
that this will spill over to state elections.</li>
<li><strong>Biggest Political Loser:</strong> Progressivism. He predicts
a repudiation of class-based identity politics in multiple Western
countries.</li>
<li><strong>Biggest Business Winner:</strong> Dollar-denominated
stablecoins, which he believes will grow substantially and challenge the
dominance of Visa and Mastercard.</li>
<li><strong>Biggest Business Loser:</strong> The "MAG 7" companies will
see a drawdown in absolute dollars due to high concentration in the
indices. He suggests that these companies may not be able to maintain
their high valuations, though they are good businesses.</li>
<li><strong>Biggest Business Deal:</strong> The collapse of traditional
auto OEMs and a wave of auto mega-mergers, triggered by Tesla's strong
position.</li>
<li><strong>Most Contrarian Belief:</strong> A banking crisis in a major
mainline bank, triggered by the total indebtedness of Pax America and
the impact of higher interest rates.</li>
<li><strong>Best Performing Asset:</strong> Credit Default Swaps (CDS)
as an insurance policy against a potential default event.</li>
<li><strong>Worst Performing Asset:</strong> The software industrial
complex, or large, bloated enterprise software companies.</li>
<li><strong>Most Anticipated Trend:</strong> Small, arcane regulatory
changes related to the supplemental loss ratio that allow the US to kick
the debt can down the road.</li>
<li><strong>Most Anticipated Media:</strong> The enormity of files that
will be declassified and released by the Trump administration.</li>
<li><strong>Prediction Market:</strong> The MAG 7 representation in the
S&amp;P 500 shrinks below 30%.</li>
</ul>
<p><strong>David Friedberg:</strong></p>
<ul>
<li><strong>Biggest Political Winner</strong>: Young political
candidates, marking a trend of a shift towards younger leaders.</li>
<li><strong>Biggest Political Loser:</strong> Pro-war neoconservatives.
He believes they will lose out to figures like JD Vance and Elon
Musk.</li>
<li><strong>Biggest Business Winner:</strong> Autonomous hardware and
robotics, citing the rise of humanoid robots and their
applications.</li>
<li><strong>Biggest Business Loser</strong>: Old defense and aerospace
providers, like Boeing and Lockheed Martin. He predicts a shift towards
more tech-oriented and rationalized spending in defense. He also thinks
Vertical SaaS companies will struggle as AI replaces their
services.</li>
<li><strong>Biggest Business Deal:</strong> Massive funding deals for
hardware-based manufacturing buildout in the United States, potentially
involving government support.</li>
<li><strong>Most Contrarian Belief:</strong> A dramatic rise in
socialist movements in the United States, fueled by economic inequality
and disruption from AI.</li>
<li><strong>Best Performing Asset:</strong> Chinese tech stocks or ETFs,
based on potential deals between the US and China and the strong
fundamentals of Chinese tech companies.</li>
<li><strong>Worst Performing Asset:</strong> Vertical SaaS companies
again as AI replaces the practices. Also legacy car companies and real
estate because of overbuilding and high debt.</li>
<li><strong>Most Anticipated Trend:</strong> The announcement of
buildout of nuclear power in the United States.</li>
<li><strong>Most Anticipated Media:</strong> AI Video Games with dynamic
story lines</li>
<li><strong>Prediction Market</strong>: Microsoft, AWS, and Google Cloud
Revenue Growth.</li>
</ul>
<p><strong>Gavin Baker:</strong></p>
<ul>
<li><strong>Biggest Political Winner:</strong> Trump and centrism; also
Gen X and Elder Millennials.</li>
<li><strong>Biggest Political Loser:</strong> Putin, due to Europe
rearming, which shifts US resources to the Pacific, and Trump's likely
tougher stance.</li>
<li><strong>Biggest Business Winner:</strong> Big businesses that use AI
thoughtfully, and the robotics industry, as well as companies that make
high bandwidth memory.</li>
<li><strong>Biggest Business Loser:</strong> Government service
providers with over 35% of their revenue coming from the US government.
He also thinks Enterprise application software will be hurt by AI
agents</li>
<li><strong>Biggest Business Deal:</strong> A wave of M&amp;A after a
period of inactivity and something significant happening with Intel.
Also, he thinks independent AI labs will get acquired.</li>
<li><strong>Most Contrarian Belief:</strong> The US will experience at
least one year of greater than 5% real GDP growth due to AI and
deregulation. He also thinks frontier AI labs will stop releasing their
leading-edge models.</li>
<li><strong>Best Performing Asset:</strong> Companies that make high
bandwidth memory (HBM).</li>
<li><strong>Worst Performing Asset:</strong> Enterprise application
software.</li>
<li><strong>Most Anticipated Trend:</strong> AI will make more progress
per quarter in 2025 than it did per year in 2023 and 2024, due to
scaling performance through reasoning, pre-training, and test time
compute.</li>
<li><strong>Most Anticipated Media:</strong> Season 2 of 1923</li>
<li><strong>Prediction Market</strong>: US Treasury Market Report on
Federal Debt in December 2025 above or below $38 trillion</li>
<li><strong>UFOs:</strong> Believes there is a 25% chance the US
government is sitting on knowledge of extraterrestrial life.</li>
</ul>
<p><strong>Jason Calacanis:</strong></p>
<ul>
<li><strong>Biggest Business Winner:</strong> Tesla and Google for AI
and Robotics</li>
<li><strong>Biggest Business Loser:</strong> Open AI</li>
<li><strong>Biggest Business Deal:</strong> Partnerships between Amazon,
Uber, Tesla, and Waymo for autonomy, delivery, and e-commerce</li>
<li><strong>Most Contrarian Belief:</strong> Open AI will lose its lead
and its nonprofit-to-for-profit transition and become the number four
player in AI.</li>
<li><strong>Best Performing Asset:</strong> MAG 7 stocks</li>
<li><strong>Worst Performing Asset:</strong> Legacy car companies and
Real Estate.</li>
<li><strong>Most Anticipated Trend:</strong> Exits and DPI will shower
down, along with a surge in M&amp;A and IPOs</li>
<li><strong>Most Anticipated Media:</strong> Legacy media outlets owned
by billionaires attempting to steer towards the middle</li>
<li><strong>Prediction Market:</strong> Over or under 750,000
deportations by Trump in the first year of office</li>
</ul>
<blockquote>
<p><strong>Building Anthropic | A conversation with our co-founders -
Anthropic</strong> [<a
target="_blank" rel="noopener" href="https://www.youtube.com/watch?v=om2lIWXLLN4&amp;ab_channel=Anthropic">Link</a>]</p>
</blockquote>
<blockquote>
<p><strong>WTF is Artificial Intelligence Really? | Yann LeCun x Nikhil
Kamath | People by WTF Ep #4 - Nikhil Kamath</strong> [<a
target="_blank" rel="noopener" href="https://www.youtube.com/watch?v=JAgHUDhaTU0&amp;ab_channel=NikhilKamath">Link</a>]</p>
</blockquote>
<blockquote>
<p><strong>The Next Frontier: Sam Altman on the Future of A.I. and
Society - New York Times Events</strong> [<a
target="_blank" rel="noopener" href="https://www.youtube.com/watch?v=tn0XpTAD_8Q&amp;ab_channel=NewYorkTimesEvents">Link</a>]</p>
</blockquote>
<blockquote>
<p><strong>LA's Wildfire Disaster, Zuck Flips on Free Speech, Why Trump
Wants Greenland</strong> [<a
target="_blank" rel="noopener" href="https://www.youtube.com/watch?v=is1QAZ7ShRU&amp;ab_channel=All-InPodcast">Link</a>]</p>
</blockquote>
<blockquote>
<p><strong>Text, camera, action! Frontiers in controllable video
generation - William (Bill) Peebles</strong> [<a
target="_blank" rel="noopener" href="https://icml.cc/virtual/2024/workshop/29968">Link</a>]</p>
</blockquote>
<blockquote>
<p><strong>Best of 2024 in Agents (from #1 on SWE-Bench Full, Prof.
Graham Neubig of OpenHands/AllHands) - Latent Space</strong> [<a
target="_blank" rel="noopener" href="https://www.youtube.com/watch?v=B6PKVZq2qqo&amp;ab_channel=LatentSpace">Link</a>]</p>
</blockquote>
<blockquote>
<p><strong>The State of AI Startups in 2024 [LS Live @ NeurIPS] - Latent
Space</strong> [<a
target="_blank" rel="noopener" href="https://www.youtube.com/watch?v=HM1d7kMebEI&amp;ab_channel=LatentSpace">Link</a>]</p>
</blockquote>
<blockquote>
<p><strong>Best of 2024 in Vision [LS Live @ NeurIPS] - Latent
Space</strong> [<a
target="_blank" rel="noopener" href="https://www.youtube.com/watch?v=76EL7YVAwVo&amp;t=4s&amp;ab_channel=LatentSpace">Link</a>]</p>
</blockquote>
<blockquote>
<p><strong>Red-pilled Billionaires, LA Fire Update, Newsom's Price Caps,
TikTok Ban, Jobless MBAs - All-In Podcast</strong> [<a
target="_blank" rel="noopener" href="https://www.youtube.com/watch?v=WQ35G6XI8Uw&amp;ab_channel=All-InPodcast">Link</a>]</p>
</blockquote>
<blockquote>
<p><strong>NVIDIA CEO Jensen Huang Keynote at CES 2025 - NVIDIA</strong>
[<a
target="_blank" rel="noopener" href="https://www.youtube.com/watch?v=k82RwXqZHY8&amp;ab_channel=NVIDIA">Link</a>]</p>
</blockquote>
<p>CES 2025 is the world's biggest tech expo. Each January, CES kicks
off the tech year by highlighting everything from groundbreaking gadgets
to the processors driving our digital world.</p>
<p>NVIDIA's CES announcements showcased its dominance in the AI chip
market while highlighting its bold expansion into emerging, high-growth
sectors. By emphasizing robotics, autonomous vehicles, and broader
accessibility to AI, NVIDIA demonstrated its commitment to staying
central to this wave of innovation.</p>
<p><strong>Highlights</strong>:</p>
<ol type="1">
<li><p><strong>GeForce RTX 50 Series GPUs</strong></p>
<p>NVIDIA unveiled its latest GeForce RTX 50 series GPUs, powered by the
advanced Blackwell architecture and set to launch in January. These GPUs
deliver significant improvements in gaming and AI performance, with the
flagship RTX 5090 priced at <span class="math inline">\(\$1,999\)</span>
and the RTX 5070 at <span class="math inline">\(\$549\)</span>,
surpassing the RTX 4090, which debuted at <span
class="math inline">\(\$1,599\)</span> in 2022.</p>
<p>The 50 series also introduces DLSS 4, a cutting-edge Deep Learning
Super Sampling technology that employs a transformer-based architecture
to generate three AI-rendered frames for every traditionally rendered
one, enhancing graphics quality and gaming experiences. NVIDIA partnered
with Micron to supply memory chips for these GPUs.</p>
<p>Although GeForce RTX GPUs contributed only 9% of NVIDIA’s revenue in
the October quarter, the company’s primary growth continues to come from
its Data Center segment, driven by AI demand.</p></li>
<li><p><strong>AI Advancements</strong></p>
<p>NVIDIA introduced Nemotron, a new family of AI models derived from
Meta’s Llama models, including Llama Nemotron Nano, Super, and Ultra,
aimed at advancing AI agent capabilities. CEO Jensen Huang projects that
the AI agent market could be worth trillions of dollars.</p>
<p>Additionally, NVIDIA confirmed that its Blackwell AI accelerators are
in full production and are being adopted by leading cloud providers and
PC manufacturers, further solidifying its position in AI
technology.</p></li>
<li><p><strong>Robotics and Autonomous Vehicles</strong></p>
<p>NVIDIA debuted Cosmos, the "world's first physical AI model,"
designed to advance robotics. Trained on 20 million hours of video,
Cosmos is open-licensed on GitHub and integrates seamlessly with
NVIDIA’s Omniverse platform to provide physics-based simulations for AI
model training in robotics and autonomous systems.</p>
<p>In partnership with Toyota, NVIDIA is collaborating on developing the
automaker's latest autonomous vehicles. Huang sees robotics and
autonomous technology as a <span class="math inline">\(\$1\)</span>
trillion market opportunity, expecting NVIDIA’s automotive revenue to
grow from <span class="math inline">\(\$4\)</span> billion in FY25 to
<span class="math inline">\(\$5\)</span> billion in FY26, spanning Data
Center and OEM segments.</p></li>
<li><p><strong>Project DIGITS</strong></p>
<p>NVIDIA announced Project DIGITS, a personal AI supercomputer aimed at
democratizing access to powerful AI tools. Starting at <span
class="math inline">\(\$3,000\)</span>, the system features the GB10
Grace Blackwell Superchip, 128GB of unified memory, and up to 4TB of
NVMe storage. Users can connect two systems for enhanced processing
capabilities.</p>
<p>Designed for AI researchers and data scientists, Project DIGITS
provides a cost-effective solution for building complex AI models
without relying on large-scale data center resources.</p></li>
</ol>
<p><strong>A not comprehensive summary of NVIDIA's efforts on AI, not a
summary of this YouTube video</strong>:</p>
<ol type="1">
<li><p><strong>AI Compute Hardware:</strong></p>
<p>This category includes the physical processing units that perform the
core calculations for AI models. These are primarily GPUs, but also
include specialized CPUs and other accelerators.</p>
<p><strong>Focus:</strong> High-performance, parallel processing, low
latency, memory bandwidth, energy efficiency for AI workloads.</p>
<p><strong>Examples</strong>:</p>
<p>NVIDIA A100 Tensor Core GPU NVIDIA A40 Tensor Core GPU NVIDIA A10
Tensor Core GPU NVIDIA H100 Tensor Core GPU NVIDIA L40 GPU NVIDIA L4 GPU
NVIDIA B100 "Blackwell" Data Center GPU NVIDIA Grace CPU Superchip
GeForce RTX 30 Series (Desktop) - Ampere (Relevance for model
development) GeForce RTX 50 Series (Desktop) - Blackwell (Relevance for
model development) Project DIGITS - Hardware system (personal AI
supercomputer).</p></li>
<li><p><strong>AI Platforms &amp; Systems:</strong></p>
<p>This category includes integrated hardware and software solutions
designed to simplify the development and deployment of AI applications.
It encompasses both edge and data center solutions.</p>
<p><strong>Focus:</strong> Ease of use, scalability, optimized
performance for specific AI tasks, deployment solutions.</p>
<p><strong>Examples</strong>:</p>
<p>NVIDIA DGX A100 System NVIDIA Jetson AGX Xavier NX NVIDIA Jetson Orin
NVIDIA Jetson Orin Nano NVIDIA Omniverse Platform</p></li>
<li><p><strong>AI Software &amp; Development Tools:</strong></p>
<p>This category includes the software libraries, frameworks, and tools
that allow developers to build, train, and deploy AI models. It covers
both open source and proprietary tools.</p>
<p><strong>Focus:</strong> Developer productivity, model performance,
framework support, customization.</p>
<p><strong>Examples</strong>:</p>
<p>NVIDIA Merlin (Software Library) NVIDIA NeMo Framework NVIDIA TAO
Toolkit</p></li>
<li><p><strong>AI Applications &amp; Solutions:</strong></p>
<p>This category focuses on specific, industry-focused AI applications
built on top of NVIDIA hardware and software.</p>
<p><strong>Focus:</strong> Pre-built solutions, vertical market
expertise, end-to-end solutions.</p>
<p><strong>Examples</strong>: Intelligent Video Analytics (IVA),
autonomous vehicle solutions, AI-driven healthcare, generative
AI.</p></li>
<li><p><strong>AI Research and Frameworks</strong></p>
<p>While related to AI Software and development tools, it deserves its
own category because of the open source nature of much of the research
based tools and APIs, allowing for community contributions and new
technology development.</p>
<p><strong>Focus:</strong> Next-generation tools, advanced research,
pushing the limits of AI, new technologies and algorythms.</p>
<p><strong>Examples</strong>: Nemotron NVIDIA FLARE (Federated Learning
Application Runtime Environment) NVIDIA Research Publications and
Open-Source Projects TensorFlow and PyTorch (With NVIDIA's
Extensions)</p></li>
</ol>
<blockquote>
<p><em>So, my takeaway was entirely different. It was not a commentary
on Masa, or Larry, or Sam. I think all of those three companies are,
frankly, very good. It was more a comment that you have to be very
careful to protect the president's legacy, if I were them, to make sure
that the things that get announced are actually further down the
technical spectrum and are actually going to be real. Because if they
achieve these things, but it costs you a billion dollars and you only
hire 50 people, there's going to be a little bit of egg on the face. And
so, that was sort of my own takeaway. I think that the things were
decoupled. It just seemed more like marketing and sizzle and kind of
hastily put together. I think it would be great if OpenAI builds another
incredible model, whatever comes after o3, o4, o5. But it's not clear
that you have to spend $500 billion to do it. - Chamath
Palihapitiya</em></p>
<p><strong>― Trump's First Week: Inauguration Recap, Executive Actions,
TikTok, Stargate + Sacks is Back! - All-In Podcast</strong> [<a
target="_blank" rel="noopener" href="https://www.youtube.com/watch?v=e1pTCSFrkbk&amp;ab_channel=All-InPodcast">Link</a>]</p>
</blockquote>
<blockquote>
<p><em>There's a thing called <a
target="_blank" rel="noopener" href="https://www.wikiwand.com/en/articles/Jevons_paradox">Jevons
Paradox</a>, which kind of speaks to this concept. SAA actually tweeted
about it. It's an economic concept where, as the cost of a particular
use goes down, the aggregate demand for all consumption of that thing
goes up. So, the basic idea is that as the price of AI gets cheaper and
cheaper, we're going to want to use more and more of it. You might
actually get more spending on it in the aggregate. That's right—because
more and more applications will become economically feasible. Exactly.
That is, I think, a powerful argument for why companies are going to
want to continue to innovate on frontier models. You guys are taking a
very strong point of view that open source is definitely going to win,
that the leading model companies are all going to get commoditized, and
therefore, there will be no return on capital—essentially forcing
continued innovation on the frontier. - David Sacks</em></p>
<p><em>But then there's this dark horse that nobody's talking about—it's
called electricity. It's called power. And all these vehicles are
electric vehicles. If you said, 'You know, I just did some quick
back-of-the-envelope calculations,' if all of the miles in California
went to EV ride-sharing, you would need to double the energy capacity of
California. Right? Let's not even talk about what it would take to
double the energy capacity of the grid and things like that in
California. Let's not even go there. Even getting 10% or 20% more
capacity is going to be a gargantuan, five-to-ten-year exercise. Look, I
live in LA—in a nice area in LA—and we have power outages all the
freaking time because the grid is messed up. They're sort of upgrading
it as things break. That's literally where we're at in LA, in one of the
most affluent neighborhoods. That’s just the reality. So, I think the
dark horse, kind of hot take, is combustion engine AVs. Because I don’t
know how you can scale AVs really, really massively with the electric
grid as it is. - Travis Kalanick</em></p>
<p><em>I just wanted to read a message from Brian Yutko, who's the CEO
of Wisk, which is building a lot of these autonomous systems. He said:
'First, automatic traffic collision avoidance systems do exist right
now. These aircraft will not take control from the pilot to save the
aircraft, even if the software and systems on the aircraft know that
it’s going to collide. That’s the big flip that needs to happen in
aviation—automation can actually kick in and take over, even in piloted
aircraft, to prevent a crash. That’s the minimum of where we need to go.
Some fighter jets have something called Automatic Ground Collision
Avoidance Systems that do exactly this when fighter pilots pass out.
It’s possible for commercial aviation as well.' And then, the second
thing he said is: 'We need to have better ATC (Air Traffic Control)
software and automation. Right now, we use VHF radio communications for
safety and critical instructions, and that’s kind of insane. We should
be using data links, etc. The whole ATC system runs on 1960s technology.
They deserve better software and automation in the control towers—it’s
totally ripe for change. The problem is that attempts at reform have
failed.' - Chamath Palihapitiya</em></p>
<p><strong>― DeepSeek Panic, US vs China, OpenAI $40B?, and Doge
Delivers with Travis Kalanick and David Sacks - All-In Podcast</strong>
[<a
target="_blank" rel="noopener" href="https://www.youtube.com/watch?v=8RkgkOqWs0s&amp;ab_channel=All-InPodcast">Link</a>]</p>
</blockquote>
<h2 id="articles-and-blogs">Articles and Blogs</h2>
<blockquote>
<p><strong>The Art of Leading Teammates - Harvard Business
Review</strong> [<a
target="_blank" rel="noopener" href="https://hbr.org/2024/09/tom-brady-on-the-art-of-leading-teammates">Link</a>]</p>
</blockquote>
<p>A Team-Focused Philosophy</p>
<ul>
<li>Put the team first, always, even when facing personal
adversity.</li>
<li>Show appreciation for unsung colleagues.</li>
<li>Set the standard and create a culture of 100% effort.</li>
<li>Recognize teammates’ individual psychology and the best ways to
motivate them.</li>
<li>Understand and complement the style of the formal leader.</li>
<li>Recognize and counteract the external forces that can cause selfish
behavior.</li>
<li>Create opportunities to connect as people outside the office.</li>
</ul>
<p>What Helps—and What Gets in the Way</p>
<ul>
<li>The emotions and behaviors that define individuals are formed
early.</li>
<li>Leaders work within a system.</li>
<li>It can be hard for individual team leaders to influence change
across large organizations.</li>
<li>A leader’s style and influence will take time to evolve.</li>
</ul>
<blockquote>
<p><em>Early adopters of gen AI can eclipse rivals by using it to
identify entirely new product opportunities, automate routine decisions
and processes, deliver customized professional services, and communicate
with customers more quickly and cheaply than was possible with
human-driven processes.</em></p>
<p><em>Far from being a source of advantage, even in sectors where its
impact will be profound, gen AI will be more likely to erode a
competitive advantage than to confer one, because its very nature makes
new insights and data patterns almost immediately transparent to anyone
using gen AI tools.</em></p>
<p><em>If you already have a competitive advantage that rivals cannot
replicate using gen AI, the technology may amplify the value you derive
from that advantage.</em></p>
<p><em>Businesses that try to deny the power of gen AI will certainly
fail. Those that adopt it will stay in the fight. But at this stage it
looks likely that the only ones that will actually win with it will be
those that can apply it to amplify the advantages they already
have.</em></p>
<p><strong>― AI Won’t Give You a New Sustainable Advantage - Harvard
Business Review</strong> [<a
target="_blank" rel="noopener" href="https://hbr.org/2024/09/ai-wont-give-you-a-new-sustainable-advantage">Link</a>]</p>
</blockquote>
<blockquote>
<table style="width:100%;">
<colgroup>
<col style="width: 34%" />
<col style="width: 28%" />
<col style="width: 37%" />
</colgroup>
<thead>
<tr>
<th style="text-align: left;"><em>To prevent this problem:</em></th>
<th style="text-align: left;"><em>Ask about this:</em></th>
<th style="text-align: left;"><em>Sample questions:</em></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;"><em>Conflating Correlation And
Causation</em></td>
<td style="text-align: left;"><em>Approach to determining
causality</em></td>
<td style="text-align: left;"><em>Was this analysis based on an
experiment? If not, are there confounders (variables that affect the
independent and dependent variables)?To what extent were they addressed
in the analysis?</em></td>
</tr>
<tr>
<td style="text-align: left;"><em>Misjudging The Potential Magnitude Of
Effects</em></td>
<td style="text-align: left;"><em>Sample size and the precision of the
results</em></td>
<td style="text-align: left;"><em>What was the average effect of the
change? What was the sample size and the confidence interval (or range
of likely values the true effect would fall into, and the degree to
which one is certain it would fall into that range)? How would our
course of action change, depending on where the true effect might
lie?</em></td>
</tr>
<tr>
<td style="text-align: left;"><em>A Disconnect Between What Is Measured
And What Matters</em></td>
<td style="text-align: left;"><em>Outcome measures</em></td>
<td style="text-align: left;"><em>What outcomes were measured? Were they
broad enough? Did they capture key intended and unintended consequences?
Were they tracked for an appropriate period of time? Were all relevant
outcomes reported? How do we think they map to broader organizational
goals?</em></td>
</tr>
<tr>
<td style="text-align: left;"><em>Misjudging Generalizability</em></td>
<td style="text-align: left;"><em>Empirical setting and subgroup
analysis</em></td>
<td style="text-align: left;"><em>How similar is the setting of this
study to our business context? Does the context or time period of the
analysis make it more or less relevant to our decision? What is the
composition of the sample being studied, and how does it influence the
applicability of the results? Does the effect vary across subgroups or
settings? Does this tell us anything about the generalizability of the
results?</em></td>
</tr>
<tr>
<td style="text-align: left;"><em>Overweighting A Specific
Result</em></td>
<td style="text-align: left;"><em>Broader evidence and further data
collection</em></td>
<td style="text-align: left;"><em>Are there other analyses that validate
the results and approach? What additional data could we collect, and
would the benefit of gathering it outweigh the cost of collecting it?
How might this change our interpretation of the results?</em></td>
</tr>
</tbody>
</table>
<p><strong>― Where Data-Driven Decision-Making Can Go Wrong - Harvard
Business Review</strong> [<a
target="_blank" rel="noopener" href="https://hbr.org/2024/09/where-data-driven-decision-making-can-go-wrong">Link</a>]</p>
</blockquote>
<blockquote>
<p><strong>Will Psychedelics Propel Your Career? - Harvard Business
Review</strong> [<a
target="_blank" rel="noopener" href="https://hbr.org/2024/09/will-psychedelics-propel-your-career">Link</a>]</p>
</blockquote>
<p>Do you want to take a 'trip'? lol</p>
<blockquote>
<p><strong>How Scalable Compute Resources Can Boost LLM Performance -
HuggingFace</strong> [<a
target="_blank" rel="noopener" href="https://huggingface.co/spaces/HuggingFaceH4/blogpost-scaling-test-time-compute">Link</a>]</p>
</blockquote>
<p>This blog explains how to scale test-time compute for models like
OpenAI's o1 - apply dynamic inference strategies to improve performance
without increasing pretraining budgets. These techniques allow smaller
models to outperform larger models on tasks such as math problems.</p>
<blockquote>
<p><em>We introduce deliberative alignment, a training paradigm that
directly teaches reasoning LLMs the text of human-written and
interpretable safety specifications, and trains them to reason
explicitly about these specifications before answering. We used
deliberative alignment to align OpenAI’s o-series models, enabling them
to use chain-of-thought (CoT) reasoning to reflect on user prompts,
identify relevant text from OpenAI’s internal policies, and draft safer
responses.</em></p>
<p><strong>― Deliberative alignment: reasoning enables safer language
models - OpenAI</strong> [<a
target="_blank" rel="noopener" href="https://openai.com/index/deliberative-alignment/">Link</a>]</p>
</blockquote>
<blockquote>
<p><em>Moravec’s paradox is the observation by artificial intelligence
and robotics researchers that, contrary to traditional assumptions,
reasoning requires very little computation, but sensorimotor and
perception skills require enormous computational resources. The
principle was articulated by Hans Moravec, Rodney Brooks, Marvin Minsky,
and others in the 1980s.</em></p>
<p><strong>― Common misconceptions about the complexity in robotics vs
AI - Harimus Blog</strong> [<a
target="_blank" rel="noopener" href="https://harimus.github.io//2024/05/31/motortask.html">Link</a>]</p>
</blockquote>
<p>Yes, as Yann LeCun mentioned in one of his previous campus lectures,
LLM might help but it is not the right solution for robotics. This
article made several good points:</p>
<ul>
<li>Sensorimotor Tasks Are More Complex. The source emphasizes that
sensorimotor tasks are harder than many people realize. It was once
assumed that perception and action were simple compared to reasoning,
but this has turned out to be incorrect. This idea is known as Moravec's
Paradox.</li>
<li>Real-World Interaction is the challenge. Robotics requires robots to
interact with a dynamic, chaotic, and complex real world. Tasks that
seem simple for humans, like picking up a coffee cup, involve complex,
unconscious processes that are hard to program for a robot. Even small
changes in the environment can require a complete rewrite of the robot's
"move commands". Robots need to break down movements into muscle
contractions and forces, which is more complex than it seems.</li>
<li>Data Requirements is another challenge. LLMs thrive on massive
amounts of data, like text and images from the internet. Robotics
requires precise, high-quality data that is hard to collect. The variety
and preciseness of the data are also important. Unlike LLMs where
quantity of data is key, in robotics, the quality of the data collected
matters more than the quantity.</li>
</ul>
<p>Regarding the question "do we need better hardware to learn", I think
we need a system of sensors that can capture every physical movement of
a body and every angle a body can perceive. In terms of a world model,
the system needs to be on a larger scale.</p>
<blockquote>
<p><strong>OpenAI has created an AI model for longevity science - MIT
Technology Review</strong> [<a
target="_blank" rel="noopener" href="https://www.technologyreview.com/2025/01/17/1110086/openai-has-created-an-ai-model-for-longevity-science/">Link</a>]</p>
</blockquote>
<p>OpenAI's success with GPT-4b micro demonstrates the potential of LLMs
to go beyond natural language processing and address highly specialized
scientific problems. The model's ability to redesign Yamanaka factors to
improve their effectiveness by 50x could be a game-changer in stem cell
research, accelerating advancements in regenerative medicine. This
development highlights a significant milestone in the use of AI for
scientific discovery, particularly in the field of protein engineering
and regenerative medicine.</p>
<blockquote>
<p><em>A classic pattern in technology economics, identified by Joel
Spolsky, is layers of the stack attempting to become monopolies while
turning other layers into perfectly-competitive markets which are
commoditized, in order to harvest most of the consumer surplus;
discussion and examples.</em></p>
<p><strong>― Laws of Tech: Commoditize Your Complement -</strong> [<a
target="_blank" rel="noopener" href="https://gwern.net/complement">Link</a>]</p>
</blockquote>
<p>This is exactly Meta's strategy initially competing with close-source
AI model businesses - <strong>commoditize their complements</strong> to
increase demand for their own products. And there are more examples
mentioned in this article.</p>
<ul>
<li><p><strong>Core Concept:</strong></p>
<p>Products have substitutes and complements. A substitute is an
alternative product that can be bought if the first product is too
expensive. A complement is a product usually bought together with
another product. Demand for a product increases when the price of its
complements decreases. Companies strategically try to
<strong>commoditize their complements</strong> to increase demand for
their own products. Commoditizing a complement means driving its price
down to a point where many competitors offer indistinguishable goods.
This strategy allows a company to become a quasi-monopolist and divert
the majority of the consumer surplus to themselves.</p></li>
<li><p><strong>How it works</strong>:</p>
<p>A company seeks a chokepoint or quasi-monopoly in a product composed
of multiple layers. It dominates one layer of the stack while fostering
competition in another layer. This drives down prices in the
commoditized layer, increasing overall demand. The company profits from
increased demand for its core product while the competitors in the
commoditized layer struggle with low margins. The goal is to make a
complement free or very cheap, to increase profits elsewhere. This
strategy is an alternative to vertical integration.</p></li>
<li><p><strong>Examples of Commoditization:</strong></p>
<ul>
<li><strong>Microsoft commoditized PC hardware</strong> by licensing its
OS to many manufacturers, making the PC itself a commodity and
increasing demand for MS-DOS.</li>
<li><strong>IBM commoditized the add-in market</strong> by using
off-the-shelf parts and documenting the interfaces, allowing other
manufacturers to produce add-on cards for their PCs, which increased the
demand for PCs.</li>
<li><strong>Netscape open-sourced its web browser</strong> to
commoditize browsers and increase demand for its server software.</li>
<li><strong>Various companies contribute to open-source
software</strong> to commoditize software and increase demand for
hardware and IT consulting services.</li>
<li><strong>Sun developed Java</strong> to make hardware more of a
commodity.</li>
<li><strong>The Open Game License (OGL)</strong> was created to
commoditize the <em>Dungeons and Dragons</em> system and drive sales of
core rulebooks.</li>
</ul></li>
<li><p><strong>Open Source as a Strategic Weapon:</strong></p>
<p>Open source can be a way for companies to commoditize their
complements. It allows companies to share development costs and compete
with dominant players. It can also neutralize advantages held by
competitors and shift the focus of competition. Open sourcing can
prevent a single company from locking up a technology.</p></li>
<li><p><strong>Generalization:</strong></p>
<p>Many products are composed of layers, each necessary but not
sufficient for the final product. The final product is valuable, but the
distribution of revenue among the different layers is contentious.
Commoditizing complements is a way to control the market without
vertical integration. The division of revenue is influenced by power
plays and market dynamics.</p></li>
<li><p><strong>Additional Examples:</strong></p>
<p>The sources list many examples of commoditization in various
industries, including hardware vs. software, banks vs. merchants, apps
vs. OSes, game portals vs. game devs, telecom vs. users, and many more.
The examples illustrate the breadth of this strategy across various tech
and non-tech sectors. There are examples of companies commoditizing
themselves, such as Stability AI, who commoditized image-generation
models and saw little profit themselves.</p></li>
<li><p><strong>Counter-Examples:</strong></p>
<ul>
<li>Sun Microsystems' strategy of making both hardware and software a
commodity was not successful.</li>
<li>Some companies, like Apple, try to control both the hardware and
software aspects of their products, which goes against the
commoditization strategy.</li>
</ul></li>
<li><p><strong>Other Factors:</strong></p>
<p>Antitrust actions can influence companies and prevent them from
crushing competitors. Fear of antitrust actions may have stopped
Microsoft from crushing Google.</p></li>
<li><p><strong>Consequences</strong>:</p>
<p>The commoditization of complements can lead to intense competition in
certain layers of the tech stack. It can also lead to a concentration of
power and revenue in the hands of companies that control key
chokepoints.</p></li>
</ul>
<h2 id="reports-and-papers">Reports and Papers</h2>
<blockquote>
<p><strong>Mixtral of Experts</strong> [<a
target="_blank" rel="noopener" href="https://arxiv.org/abs/2401.04088">Link</a>]</p>
</blockquote>
<p>Key innovation: Sparse Mixture of Experts (SMoE) with TopK=2.</p>
<blockquote>
<p><strong>The state of Generative AI and Machine Learning at the end of
2023 - Intel Tiber AI Studio</strong> [<a
target="_blank" rel="noopener" href="https://cnvrg.io/ml-insider-results-2023/?utm_source=alphasignal&amp;utm_medium=newsletter&amp;utm_campaign=ml+insider">Link</a>]</p>
</blockquote>
<p>Trends and insights of AI development and deployment in the
enterprise - a survey result.</p>
<blockquote>
<p><strong>Does Prompt Formatting Have Any Impact on LLM
Performance?</strong> [<a
target="_blank" rel="noopener" href="https://arxiv.org/abs/2411.10541">Link</a>]</p>
</blockquote>
<p>Prompt formats significantly affect LLM performance, with differences
as high as 40% observed in code translation tasks for GPT-3.5-turbo.
Larger models like GPT-4 demonstrate more resilience to prompt format
changes.</p>
<p>JSON format outperformed Markdown in certain tasks, boosting accuracy
by 42%. GPT-4 models exhibited higher consistency in responses across
formats compared to GPT-3.5 models.</p>
<blockquote>
<p><strong>Deliberative Alignment: Reasoning Enables Safer Language
Models</strong> [<a
target="_blank" rel="noopener" href="https://arxiv.org/abs/2412.16339">Link</a>]</p>
</blockquote>
<p>Their training methodology has two stages: 1) supervised fine-tuning
on (prompt, CoT, output) datasets where CoTs explicitly reference safety
policies, 2) high-compute RL using a reward model informed by safety
policies, improving reasoning and adherence.</p>
<figure>
<img src="/di-blog/2025/01/04/2025-January/deliberative_alignment.png"
alt="deliberative_alignment" />
<figcaption aria-hidden="true">deliberative_alignment</figcaption>
</figure>
<blockquote>
<p><em>Genesis is a comprehensive physics simulation platform designed
for general purpose Robotics, Embodied AI, &amp; Physical AI
applications. It is simultaneously multiple things:</em></p>
<ul>
<li><em>A universal physics engine re-built from the ground up, capable
of simulating a wide range of materials and physical
phenomena.</em></li>
<li><em>A lightweight, ultra-fast, pythonic, and user-friendly robotics
simulation platform.</em></li>
<li><em>A powerful and fast photo-realistic rendering system.</em></li>
<li><em>A generative data engine that transforms user-prompted natural
language description into various modalities of data.</em></li>
</ul>
<p><strong>― Genesis: A Generative and Universal Physics Engine for
Robotics and Beyond</strong> [<a
target="_blank" rel="noopener" href="https://genesis-embodied-ai.github.io/">Link</a>]</p>
</blockquote>
<blockquote>
<p><strong>Agents - Julia Wiesinger, Patrick Marlow, and Vladimir
Vuskovic - Google</strong> [<a
target="_blank" rel="noopener" href="https://drive.google.com/file/d/1oEjiRCTbd54aSdB_eEe3UShxLBWK9xkt/view">Link</a>]</p>
</blockquote>
<blockquote>
<p><strong>Agent AI: Surveying the Horizons of Multimodal
Interaction</strong> [<a
target="_blank" rel="noopener" href="https://arxiv.org/abs/2401.03568">Link</a>]</p>
</blockquote>
<blockquote>
<p><strong>Foundations of Large Language Models</strong> [<a
target="_blank" rel="noopener" href="https://arxiv.org/pdf/2501.09223">Link</a>]</p>
</blockquote>
<blockquote>
<p><strong>Atlas of Gray Matter Volume Differences Across Psychiatric
Conditions: A Systematic Review With a Novel Meta-Analysis That
Considers Co-Occurring Disorders</strong> [<a
target="_blank" rel="noopener" href="https://www.sciencedirect.com/science/article/pii/S0006322324017293#sec3">Link</a>]</p>
</blockquote>
<p>"Gray matter volume (GMV) differences across major mental disorders"
refers to variations in the amount or density of gray matter in the
brain when comparing individuals with mental disorders to those without.
Gray matter consists of neuronal cell bodies, dendrites, and synapses
and is essential for processing information, controlling movements, and
supporting higher cognitive functions like memory, attention, and
decision-making.</p>
<p><strong>Structural Abnormalities</strong>: Mental disorders are often
associated with changes in the brain's structure. GMV differences can
highlight specific brain regions that are smaller, larger, or
differently shaped in individuals with mental disorders.</p>
<p><strong>Neurobiological Insights</strong>: Identifying GMV changes
helps researchers understand the neurobiological basis of mental
disorders and how these changes may contribute to symptoms like mood
dysregulation, cognitive impairment, or altered behavior.</p>
<p><strong>Target for Interventions</strong>: Understanding these
differences can inform treatments such as targeted therapies,
neurostimulation, or cognitive training to address the affected brain
regions.</p>
<blockquote>
<p><strong>From Efficiency Gains to Rebound Effects: The Problem of
Jevons’ Paradox in AI’s Polarized Environmental Debate</strong> [<a
target="_blank" rel="noopener" href="https://arxiv.org/abs/2501.16548">Link</a>]</p>
</blockquote>
<blockquote>
<p><strong>DeepSeek-R1: Incentivizing Reasoning Capability in LLMs via
Reinforcement Learning</strong> [<a
target="_blank" rel="noopener" href="https://arxiv.org/abs/2501.12948">Link</a>]</p>
</blockquote>
<p>DeepSeek-R1 is an open-source reasoning model that matches OpenAI-o1
in math, reasoning, and code tasks.</p>
<h2 id="news">News</h2>
<blockquote>
<p><strong>NVIDIA Project DIGITS, A Grace Blackwell AI Supercomputer on
your desk - NVIDIA</strong> [<a
target="_blank" rel="noopener" href="https://www.nvidia.com/en-us/project-digits/">Link</a>]</p>
</blockquote>
<blockquote>
<p><strong>Constellation inks $1 billion deal to supply US government
with nuclear power - Yahoo</strong> [<a
target="_blank" rel="noopener" href="https://finance.yahoo.com/news/constellation-secures-1-billion-contracts-154447132.html?guccounter=1&amp;guce_referrer=aHR0cHM6Ly9zdWJzdGFjay5jb20v&amp;guce_referrer_sig=AQAAAB8KGM1c2Hoot4gsRD6v4xoHeHMYfu-vMzHMF8z5iJayPDPoaH0OeKiFQ3r0ORie_l9_FVbSeGIoJebg9sJ7Et8CFvDV3M14yxsop0E427ezu6aGm_mb6iQgaCaICBiH_exivFtpSvEoU_LNPjB1UQsaTtKZa2R6T2tuBdF78n1k">Link</a>]</p>
</blockquote>
<blockquote>
<p><strong>Why 2025 will be the year of AI orchestration</strong> [<a
target="_blank" rel="noopener" href="https://venturebeat.com/ai/three-ways-2025-will-be-the-year-of-agentic-productivity/">Link</a>]</p>
</blockquote>
<p>2025 is anticipated to be the year of AI orchestration for several
reasons:</p>
<ul>
<li>In 2024, there was broad experimentation in AI, particularly with
agentic use cases. In 2025, these pilot programs, experiments, and new
use cases are expected to converge, leading to a greater focus on return
on investment.</li>
<li>As organizations deploy more AI agents into their workflows, the
need for infrastructure to manage them becomes more critical. This
includes managing both internal workflows and those that interact with
other services.</li>
<li>Decision-makers, especially those outside of the technology sector,
are seeking tangible results from their AI investments. They are moving
beyond experimentation and expect to see a return on their investment in
2025.</li>
<li>There will be a greater emphasis on productivity, which involves
understanding how multiple agents can be made more effective. This will
require a focus on accuracy and achieving higher productivity.</li>
<li>Many new orchestration options are emerging to address the
limitations of existing tools such as LangChain. Companies are building
orchestration layers to manage AI applications. These frameworks are
still early in development, and the field is expected to grow.</li>
<li>There will be a focus on integrating agents across different systems
and platforms, such as AWS's Bedrock and Slack, to allow for the
transfer of context between platforms.</li>
<li>The emergence of powerful reasoning models like OpenAI's o3 and
Google's Gemini 2.0 will make orchestrator agents more powerful.</li>
</ul>
<blockquote>
<p><strong>Perplexity AI makes a bid to merge with TikTok U.S. -
CNBC</strong> [<a
target="_blank" rel="noopener" href="https://www.cnbc.com/2025/01/18/perplexity-ai-makes-a-bid-to-merge-with-tiktok-us.html">Link</a>]</p>
</blockquote>
<blockquote>
<p><em>OpenAI, Alphabet Inc.’s Google, AI media company Moonvalley and
several other AI companies are collectively paying hundreds of content
creators for access to their unpublished videos, according to people
familiar with the negotiations.</em></p>
<p><strong>― YouTubers Are Selling Their Unused Video Footage to AI
Companies - Bloomberg</strong> [<a
target="_blank" rel="noopener" href="https://www.bloomberg.com/news/articles/2025-01-10/youtubers-are-selling-their-unused-video-footage-to-ai-companies?embedded-checkout=true">Link</a>]</p>
</blockquote>
<blockquote>
<p><strong>Stavridis says Trump’s plan for Greenland ‘not a crazy idea’
- The Hill</strong> [<a
target="_blank" rel="noopener" href="https://thehill.com/policy/international/5081040-stavridis-says-trumps-plan-for-greenland-not-a-crazy-idea/">Link</a>]</p>
</blockquote>
<blockquote>
<p><strong>California’s Wildfire Insurance Catastrophe - WSJ</strong>
[<a
target="_blank" rel="noopener" href="https://www.wsj.com/opinion/california-fires-los-angeles-insurance-regulation-premiums-risk-fair-victoria-roach-gavin-newsom-1306d0a1">Link</a>]</p>
</blockquote>
<p>Rising premiums and limited coverage options could significantly
impact Californians, particularly in wildfire-prone areas. The article
calls out state leadership for failing to adapt policies to address
climate-related risks effectively.</p>
<blockquote>
<p>“<em>Our robotics team is focused on unlocking general-purpose
robotics and pushing towards AG</em> –<em>level intelligence in dynamic,
real-world settings. Working across the entire model stack, we integrate
cutting-edge hardware and software to explore a broad range of robotic
form factors. We strive to seamlessly blend high-level AI capabilities
with the physical constraints of physical.</em>“</p>
<p><strong>― OpenAI has begun building out its robotics team -
VentureBeat</strong> [<a
target="_blank" rel="noopener" href="https://venturebeat.com/ai/openai-has-begun-building-out-its-robotics-team/">Link</a>]</p>
</blockquote>
<p>It's surprising because I kind of remember in a public interview Sam
said he is not going to go hardware as it's going to be as efficient on
that as those companies with hardware foundations like Tesla, NVIDIA,
Meta, etc. Now, it's hiring its first hardware robotics roles as
announced by Caitlin Kalinowski.</p>
<blockquote>
<p><strong>OpenAI’s $500B ‘Stargate Project’ could aid Pentagon’s own AI
efforts, official says - Breaking Defense</strong> [<a
target="_blank" rel="noopener" href="https://breakingdefense.com/2025/01/openais-500b-stargate-project-could-aid-pentagons-own-ai-efforts-official-says/">Link</a>]</p>
</blockquote>
<p>This article highlights OpenAI's ambitious Stargate Project and its
potential impact on both commercial and government sectors, particularly
the U.S. Department of Defense (DoD). Stargate represents a bold step in
building the next generation of AI infrastructure, and its success could
profoundly influence the future of both private AI development and
national security capabilities. The collaboration between industry
leaders and government stakeholders will be key to overcoming technical
and financial hurdles.</p>
<p>Here are key takeaways:</p>
<p><strong>OpenAI's Stargate Project:</strong></p>
<ul>
<li><strong>Objective:</strong> Build $500 billion worth of AI
infrastructure, including new data centers and power solutions,
primarily aimed at training and operating large AI models.</li>
<li><strong>Initial Funding:</strong> $100 billion to be deployed
immediately, with ongoing development starting in Texas and other
potential sites in the U.S.</li>
<li><strong>Collaborators:</strong> Japan-based SoftBank, Oracle,
UAE-based MGX, NVIDIA, Microsoft, and Arm.</li>
</ul>
<p><strong>DoD Implications:</strong></p>
<ul>
<li><strong>AI Challenges in Defense:</strong> The DoD faces significant
bottlenecks in computing power to meet the demands of modern AI
applications, from battlefield decision-making to intelligence analysis
and coordinating multi-domain operations (CJADC2).</li>
<li><strong>Reliance on Private Sector:</strong> Stargate could provide
essential computing power to address the Pentagon's high-tech needs,
especially where DoD lacks in-house capacity.</li>
<li><strong>Field Applications:</strong> Supercomputing resources are
essential for training and retraining AI models in dynamic environments,
such as battlefield conditions where new inputs may arise.</li>
</ul>
<p><strong>Challenges:</strong></p>
<ul>
<li><strong>Energy Demands:</strong> Generative AI models like ChatGPT
consume immense electricity. The DoD must consider scalable and portable
power sources, such as compact nuclear plants.</li>
<li><strong>Funding Scrutiny:</strong> Despite public commitments,
concerns about the financial capability of Stargate’s backers, including
SoftBank, have raised questions.</li>
<li><strong>Technical Constraints:</strong> Effective use of AI in
military applications depends on robust, secure, and reliable
infrastructure to handle high-bandwidth connections and avoid
vulnerabilities to jamming.</li>
</ul>
<p><strong>Political and Economic Context:</strong></p>
<ul>
<li>The Stargate Project was announced at a high-profile White House
event, underscoring its perceived importance to national interests.</li>
<li>Skepticism from figures like Elon Musk about the financial
feasibility of such an enormous project adds to the intrigue surrounding
its rollout.</li>
</ul>
<blockquote>
<p><strong>Trump is planning 100 executive orders starting Day 1 on
border, deportations and other priorities - AP News</strong> [<a
target="_blank" rel="noopener" href="https://apnews.com/article/trump-day-one-border-executive-actions-30f78c3c983ae74555f281446fe22710">Link</a>]</p>
</blockquote>
<blockquote>
<p><em>A new neural-network architecture developed by researchers at
Google might solve one of the great challenges for large language models
(LLMs): extending their memory at inference time without exploding the
costs of memory and compute. Called <a
target="_blank" rel="noopener" href="https://arxiv.org/abs/2501.00663">Titans</a>, the architecture
enables models to find and store during inference small bits of
information that are important in long sequences.</em></p>
<p><em>Titans combines traditional LLM attention blocks with “neural
memory” layers that enable models to handle both short- and long-term
memory tasks efficiently. According to the researchers, LLMs that use
neural long-term memory can scale to millions of tokens and outperform
both classic LLMs and alternatives such as Mamba while having many fewer
parameters.</em></p>
<p><strong>― Google’s new neural-net LLM architecture separates memory
components to control exploding costs of capacity and compute</strong>
[<a
target="_blank" rel="noopener" href="https://venturebeat.com/ai/googles-new-neural-net-architecture-separates-memory-components-to-control-exploding-costs/">Link</a>]</p>
</blockquote>
<blockquote>
<p><strong>TikTok restoring service after Trump vows to delay ban -
AXIOS</strong> [<a
target="_blank" rel="noopener" href="https://www.axios.com/2025/01/19/trump-tiktok-ban-delay-executive-order">Link</a>]</p>
<p><strong>TikTok's response to the Supreme Court decision</strong> [<a
target="_blank" rel="noopener" href="https://www.axios.com/2025/01/19/trump-tiktok-ban-delay-executive-order">Link</a>]</p>
</blockquote>
<blockquote>
<p><strong>Amazon bought more renewable power last year than any other
company - TechCrunch</strong> [<a
target="_blank" rel="noopener" href="https://techcrunch.com/2025/01/17/amazon-bought-more-renewable-power-last-year-than-any-other-company/?guccounter=1&amp;guce_referrer=aHR0cHM6Ly9zdWJzdGFjay5jb20v&amp;guce_referrer_sig=AQAAANgCe1tykMadeEH0yFtH9v_1g1GHsiJbFLgO77KwSQXHCpKAtX9XhhHufD_tUMK3Ekb7DDCuCQkjjoKJGv82u-C33K3kS5qyquoxotmWs7jRHfA7ppjxj3_HtivS7GDsqSk-PuXlj-G7s58VcuPCq-DR88TNQcyMK1mUSqcHD9Oc">Link</a>]</p>
</blockquote>
<blockquote>
<p><strong>Ozempic, Wegovy and other drugs are among 15 selected for
Medicare’s price negotiations</strong> [<a
target="_blank" rel="noopener" href="https://apnews.com/article/drug-prices-medicare-biden-trump-aae2271614f5959b484e5f081313f2e1">Link</a>]</p>
</blockquote>
<blockquote>
<p><strong>Waymo Finds a Way Around US Restrictions Targeting Chinese
Cars</strong> [<a
target="_blank" rel="noopener" href="https://www.wired.com/story/waymo-finds-a-way-around-us-restrictions-on-chinese-evs/">Link</a>]</p>
</blockquote>
<blockquote>
<p><strong>More Speech and Fewer Mistakes - Meta News</strong> [<a
target="_blank" rel="noopener" href="https://about.fb.com/news/2025/01/meta-more-speech-fewer-mistakes/">Link</a>]</p>
</blockquote>
<blockquote>
<p><strong>NVIDIA Cosmos - NVIDIA</strong> [<a
target="_blank" rel="noopener" href="https://www.nvidia.com/en-in/ai/cosmos/">Link</a>]</p>
</blockquote>
<blockquote>
<p><strong>Announcing The Stargate Project - OpenAI</strong> [<a
target="_blank" rel="noopener" href="https://openai.com/index/announcing-the-stargate-project/">Link</a>]</p>
</blockquote>
<p>OpenAI announces the Stargate Project, a <span
class="math inline">\(\$500\)</span> billion effort to create advanced
AI infrastructure. The project begins with an immediate <span
class="math inline">\(\$100\)</span> billion deployment for data
centers, starting in Texas. It supports OpenAI’s goal of scaling
artificial general intelligence (AGI) and training advanced AI models.
Focus on high-value fields like personalized medicine and
biotechnology.</p>
<p>NVIDIA GPUs power compute-intensive workloads. Oracle provides
high-capacity cloud infrastructure. Microsoft Azure supports scalable
distributed AI model training.</p>
<blockquote>
<p><strong>Introducing Operator - OpenAI</strong> [<a
target="_blank" rel="noopener" href="https://openai.com/index/introducing-operator/">Link</a>]</p>
</blockquote>
<p>It's an AI agent that automates tasks directly in a web browser. You
can use Operator to complete repetitive tasks like filling out forms,
booking travel, or ordering items online. It uses a new model called
Computer-Using Agent (CUA), which integrates GPT-4's vision capabilities
with reinforcement learning to interact with graphical user interfaces
(GUIs).</p>
<blockquote>
<p><strong>Introducing Citations on the Anthropic API -
Anthropic</strong> [<a
target="_blank" rel="noopener" href="https://www.anthropic.com/news/introducing-citations-api">Link</a>]</p>
</blockquote>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://jokerdii.github.io/di-blog/2024/12/29/Understanding-RLHF/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/di-blog/images/avatar.gif">
      <meta itemprop="name" content="Di Zhen">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Di's Blog">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Di's Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/di-blog/2024/12/29/Understanding-RLHF/" class="post-title-link" itemprop="url">Understanding RLHF</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2024-12-29 13:14:49" itemprop="dateCreated datePublished" datetime="2024-12-29T13:14:49-05:00">2024-12-29</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>Happy New Year (/≧▽≦)/</p>
<p>There is a lot to talk about Reinforcement Learning from Human
Feedback (RLHF). How about starting with Reinforcement Learning (RL)
basics.</p>
<p><em>Warning: Extremely long article ahead :)</em></p>
<h2 id="overview">Overview</h2>
<p>The process of training a model using reinforcement learning from
human feedback (RLHF) involves three key steps, as outlined in the paper
titled “<a target="_blank" rel="noopener" href="https://arxiv.org/abs/2203.02155">Training language
models to follow instructions with human feedback</a>” by OpenAI.</p>
<figure>
<img
src="/di-blog/2024/12/29/Understanding-RLHF/instructGPT_overview_RLHF.png"
alt="instructGPT_overview_RLHF" />
<figcaption aria-hidden="true">instructGPT_overview_RLHF</figcaption>
</figure>
<h2 id="reinforcement-learning">Reinforcement Learning</h2>
<h3 id="introduction">Introduction</h3>
<p>Reinforcement Learning (RL) is a machine learning approach where an
agent learns to make decisions by interacting with an environment to
maximize cumulative rewards.</p>
<p>The <strong>agent</strong> is the decision-maker or learner in the RL
framework. It performs actions in the environment and learns from the
feedback it receives. The <strong>environment</strong> represents
everything external to the agent that it interacts with. It provides
feedback in response to the agent’s actions. The <strong>state</strong>
is a representation of the current situation of the environment as
perceived by the agent. An <strong>action</strong> is a decision or move
taken by the agent at each step based on its policy (a mapping from
states to actions). The <strong>reward</strong> is a scalar feedback
signal provided by the environment to indicate how good or bad an action
was in achieving the agent’s goal.</p>
<p>An RL problem is typically formalized as a <strong>Markov Decision
Process (MDP)</strong>, which includes:</p>
<ul>
<li><strong>States (<span class="math inline">\(S\)</span>)</strong>:
The set of all possible situations in which the agent can find
itself.</li>
<li><strong>Actions (<span class="math inline">\(A\)</span>)</strong>:
The set of all possible moves or decisions available to the agent.</li>
<li><strong>Transition Dynamics (<span
class="math inline">\(P(s&#39;|s,a)\)</span>)</strong>: The probability
of transitioning to a new state <span
class="math inline">\(s&#39;\)</span> given the current state <span
class="math inline">\(s\)</span> and action <span
class="math inline">\(a\)</span>.</li>
<li><strong>Rewards (<span
class="math inline">\(R(s,a)\)</span>)</strong>: The immediate feedback
received after taking action <span class="math inline">\(a\)</span> in
state <span class="math inline">\(s\)</span>.</li>
<li><strong>Policy (<span
class="math inline">\(\pi(a|s)\)</span>)</strong>: A strategy that
defines how the agent selects actions based on states.</li>
</ul>
<p>The goal of RL is to find an optimal policy <span
class="math inline">\(\pi^*\)</span> that maximizes cumulative rewards
(also called return). This involves balancing short-term rewards with
long-term planning using trial-and-error interactions with the
environment.</p>
<figure>
<img
src="/di-blog/2024/12/29/Understanding-RLHF/agent_env_rewards_RL_intro.png"
alt="agent_env_rewards_RL_intro" />
<figcaption aria-hidden="true">agent_env_rewards_RL_intro</figcaption>
</figure>
<p>The challenges arised from the <strong>nature of environment and its
dynamics</strong> are non-stationary environments, stochastic rewards,
and random states:</p>
<ul>
<li>In non-stationary environments, the dynamics of the environment
(e.g., transition probabilities or reward functions) change over time.
This forces RL agents to continuously adapt their policies, which can
lead to a drop in performance during the readjustment phase and
forgetting previously learned policies.</li>
<li>Stochastic rewards occur when the reward function is probabilistic
rather than deterministic. This introduces noise into the feedback
signal, making it harder for the agent to discern which actions truly
lead to higher rewards.</li>
<li>Random states refer to situations where the agent’s observations are
noisy or partially observable, making it harder to infer the true state
of the environment. Such randomness complicates policy learning because
the agent may need to rely on memory or belief states (e.g., Partially
Observable Markov Decision Processes, POMDPs) to make decisions. It
increases the dimensionality and complexity of the state space.</li>
</ul>
<p>The challenges related to <strong>algorithmic design and
computational feasibility</strong> are:</p>
<ul>
<li>RL algorithms require a significant amount of interaction with the
environment to learn effectively, making them data-intensive. Many RL
algorithms, particularly model-free methods like policy gradient
techniques, require a large number of samples to converge.</li>
<li>RL agents face the <strong>exploration-exploitation
dilemma</strong>, where they need to balance trying new actions to
discover potentially better rewards (<strong>Exploration</strong>) and
using known actions that yield high rewards
(<strong>Exploitation</strong>).</li>
<li>Many RL problems involve enormous state and action spaces, such as
games like Go or real-world robotics tasks. The exponential growth of
possible states and actions makes it computationally challenging for RL
algorithms to find optimal solutions.</li>
<li>Poorly designed rewards can lead to unintended behaviors (e.g., an
agent exploiting loopholes in the reward structure). Sparse or delayed
rewards make it difficult for the agent to associate its actions with
outcomes.</li>
<li>RL agents often struggle to generalize learned behaviors across
different tasks or environments. Agents trained in specific simulations
(e.g., driving simulators) may fail to perform well in real-world
scenarios due to differences in dynamics, noise, or variability.</li>
<li>RL algorithms are highly sensitive to hyperparameter choices (e.g.,
learning rate, discount factor). Poor tuning can lead to slow
convergence or failure to converge at all, making training unpredictable
and requiring significant expertise.</li>
<li>RL agents often use complex models (e.g., deep neural networks),
making their decisions difficult to interpret. This lack of transparency
is problematic in safety-critical applications like healthcare or
autonomous driving, where understanding the reasoning behind decisions
is essential.</li>
</ul>
<h3 id="multi-armed-bandit-mab">Multi-Armed Bandit (MAB)</h3>
<p>The multi-armed bandit (MAB) problem is a classic RL problem that
exemplifies the exploration-exploitation tradeoff. It provides a
simplified framework for decision-making under uncertainty.</p>
<p>Here is a simple scenario to help understand the Multi-Armed Bandit
(MAB) problem. Imagine a doctor has three types of prescription drugs to
treat a particular disease and <span class="math inline">\(N\)</span>
patients to treat. At the beginning, the doctor has no knowledge about
which drug is the most effective. The goal is to identify the
<strong>best action</strong>—the drug that can cure the highest number
of patients.</p>
<p>To achieve this goal, we can define <strong>action values</strong>
as:</p>
<p><span class="math display">\[
Q_t(a) = E[R_t \mid A_t = a],
\]</span></p>
<p>where: - <span class="math inline">\(R_t\)</span> is a random
variable representing whether a patient is cured (reward), - <span
class="math inline">\(a\)</span> is an action, which in this case
corresponds to selecting a specific type of drug for the patients.</p>
<p>The <strong>best action</strong> is the one that maximizes the
expected reward:</p>
<p><span class="math display">\[
a^* = \arg\max_a Q(a).
\]</span></p>
<p>It’s important to note that an expectation, <span
class="math inline">\(E[x]\)</span>, is typically calculated as:</p>
<p><span class="math display">\[
E[x] = \sum x p(x),
\]</span></p>
<p>where <span class="math inline">\(p(x)\)</span> represents the
probability distribution of <span class="math inline">\(x\)</span>.
However, in real-world scenarios where <span
class="math inline">\(p(x)\)</span> is unknown and data is limited, the
expectation can be approximated using sample averages:</p>
<p><span class="math display">\[
E[x] \approx \frac{\sum x}{N},
\]</span></p>
<p>where <span class="math inline">\(N\)</span> is the total number of
observations of <span class="math inline">\(x\)</span>. This
approximation process is known as <strong>Monte Carlo
estimation</strong>.</p>
<p>The action value <span class="math inline">\(Q_t(a)\)</span> can be
estimated by <strong>Sample-Average Method</strong> using the following
formula:</p>
<p><span class="math display">\[
Q_t(a) = \frac{\text{Total rewards received when action } a \text{ was
taken before time } t}{\text{Number of times action } a \text{ was taken
before time } t}.
\]</span></p>
<p>Mathematically, this can be expressed as:</p>
<p><span class="math display">\[
Q_t(a) = \frac{\sum_{i=1}^{t-1} R_i \cdot I_{A_i = a}}{\sum_{i=1}^{t-1}
I_{A_i = a}},
\]</span></p>
<p>where: - <span class="math inline">\(R_i\)</span> is the reward
received at time step <span class="math inline">\(i\)</span>, - <span
class="math inline">\(I_{A_i = a}\)</span> is an indicator function that
equals 1 if action <span class="math inline">\(a\)</span> was selected
at time step <span class="math inline">\(i\)</span> and 0 otherwise.</p>
<p>The best action can be select by <strong>Greedy Approach</strong>:
<span class="math display">\[
a^* = \arg\max_a Q(a).
\]</span> In our case as demonstrated in the diagram below, after 4
times, <span class="math inline">\(Q_t(1)=0.5, Q_t(2)=0.75,
Q_t(3)=0.25\)</span>, the best action is determined by <span
class="math inline">\(\arg \max_a Q_t(a)\)</span> which is Action <span
class="math inline">\(A_2\)</span> (<span
class="math inline">\(a=2\)</span>).</p>
<p>However, this approach has some drawbacks such as small sample size
and non-stationary environment (e.g. patients are in different
consitions). An intuitive alternative is to give Action <span
class="math inline">\(A_1\)</span> and Action <span
class="math inline">\(A_3\)</span> more opportunities. This is called
<strong>Exploration - Exploitation Tradeoff</strong>, which means to
balance trying new actions to discover potentially better rewards
(<strong>Exploration</strong>) and using known actions that yield high
rewards (<strong>Exploitation</strong>).</p>
<p>A better approach is called <strong>Epsilon-Greedy Strategy</strong>
which is a simple yet effective method for addressing the
exploration-exploitation tradeoff in RL. It involves:</p>
<ol type="1">
<li><strong>Exploration</strong>: With a probability of <span
class="math inline">\(\epsilon\)</span>, the agent chooses a random
action, allowing it to explore the environment and gather new
information.</li>
<li><strong>Exploitation</strong>: With a probability of <span
class="math inline">\(1-\epsilon\)</span>, the agent selects the action
that has the highest estimated reward (greedy action) based on its
current knowledge.</li>
</ol>
<p>In our case, let <span class="math inline">\(\epsilon =
20\%\)</span>, <span class="math inline">\(Q_t(1)\)</span> and <span
class="math inline">\(Q_t(3)\)</span> each is given <span
class="math inline">\(10\%\)</span>, and <span
class="math inline">\(Q_t(2)\)</span> is given <span
class="math inline">\(80\%\)</span>. The next round (5th) of action is
decided by random sampling <span
class="math inline">\(A_1,A_2,A_3\)</span> with probability of <span
class="math inline">\(10\%, 80\%,10\%\)</span>. If the sampled action is
<span class="math inline">\(A_1\)</span> and the reward is <span
class="math inline">\(1\)</span>, then its action value is updated to be
is <span class="math inline">\(Q_t&#39;(1) =  (0+1+1+0+1)/5
=0.6\)</span>.</p>
<figure>
<img
src="/di-blog/2024/12/29/Understanding-RLHF/doctor_treatment_example.png"
alt="doctor_treatment_example" />
<figcaption aria-hidden="true">doctor_treatment_example</figcaption>
</figure>
<p>The pseudo code of Epsilon Greedy Approach is as follows.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Initialize</span></span><br><span class="line"><span class="keyword">for</span> a = <span class="number">1</span> to K:</span><br><span class="line">    Q(a) &lt;- <span class="number">0</span>          <span class="comment"># Estimated value of each arm</span></span><br><span class="line">    N(a) &lt;- <span class="number">0</span>          <span class="comment"># Number of times each arm has been pulled</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Epsilon-Greedy Algorithm</span></span><br><span class="line"><span class="keyword">for</span> t = <span class="number">1</span> to num_turns:</span><br><span class="line">    <span class="keyword">with</span> probability ε:</span><br><span class="line">        A &lt;- randomly select an arm (exploration)</span><br><span class="line">    otherwise:</span><br><span class="line">        A &lt;- select the arm <span class="keyword">with</span> the highest Q(a) (exploitation)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Pull the selected arm and observe reward R</span></span><br><span class="line">    R &lt;- Reward(A)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Update the estimates for the selected arm</span></span><br><span class="line">    N(A) &lt;- N(A) + <span class="number">1</span></span><br><span class="line">    Q(A) &lt;- Q(A) + (<span class="number">1</span> / N(A)) * (R - Q(A))  <span class="comment"># Incremental update formula</span></span><br></pre></td></tr></table></figure>
<p>Note that there is a math trick in the incremental updates
<code>Q(A) &lt;- Q(A) + (1 / N(A)) * (R - Q(A))</code>. <span
class="math display">\[
\begin{equation}
\begin{aligned}
Q_{n+1} &amp;= {1\over n}\sum^n_{i=1}R_i \space \text{ : average reward
in the n+1 iteration}\\
&amp;= {1\over n}(R_n + \sum^{n-1}_{i=1}R_i)\\
&amp;= {1\over n}(R_n + (n-1){1\over n-1}\sum^{n-1}_{i=1}R_i)\\
&amp;= {1\over n} (R_n + (n-1)Q_n)\\
&amp;= {1\over n}(R_n+ n \times Q_n - Q_n)\\
&amp;= Q_n + {1\over n} (R_n - Q_n)
\end{aligned}
\end{equation}
\]</span> The higher the <span class="math inline">\(\epsilon\)</span>,
the more opportunities given to actions, and the higher average
reward.</p>
<figure>
<img
src="/di-blog/2024/12/29/Understanding-RLHF/epsilon_greedy_method.png"
alt="epsilon_greedy_method" />
<figcaption aria-hidden="true">epsilon_greedy_method</figcaption>
</figure>
<p>(Source: <a
target="_blank" rel="noopener" href="https://www.amazon.com/Reinforcement-Learning-Introduction-Adaptive-Computation/dp/0262039249">Reinforcement
Learning by Sutton and Barto</a>, Chapter 2)</p>
<h3 id="agent">Agent</h3>
<h4 id="long-term-goal">Long Term Goal</h4>
<p>The goal of Agent is long-term reward <span class="math display">\[
G_t = R_{t+1}+R_{t+2}+R_{t+3}+...
\]</span> So the objective is expected reward <span
class="math inline">\(E[G_t]\)</span> <span class="math display">\[
E[G_t] = E[R_{t+1}+R_{t+2}+R_{t+3}+...]
\]</span> There are different types of agent tasks:</p>
<ul>
<li><p><strong>Episodic Task</strong>: Episodic tasks consist of
distinct episodes, where each episode has a clear beginning and end. At
the end of an episode, the environment resets to a starting
state.</p></li>
<li><p><strong>Continuing Task</strong>: Continuing tasks involve
ongoing interactions with no natural endpoint. The agent interacts with
the environment indefinitely. A key challenge in continuing tasks is
that the cumulative reward (<span class="math inline">\(E[G_t]\)</span>)
can become unbounded as time progresses. This makes it difficult to
optimize an unbounded objective directly.</p>
<p>To make the objective bounded, a <strong>discount factor</strong>
(<span class="math inline">\(\gamma\)</span>) is introduced. The
discount factor ensures that more weight is given to immediate rewards
while gradually reducing the importance of future rewards. This approach
stabilizes the optimization process. <span class="math inline">\(\gamma
\in (0,1)\)</span> is a scalar that determines how much future rewards
are discounted compared to immediate rewards. In practice, <span
class="math inline">\(\gamma\)</span> is often set close to 1 (e.g.,
0.95 or 0.98), allowing the agent to consider long-term rewards while
still prioritizing recent ones.</p>
<p>The following derivations demonstrate how discounting makes the
objective bounded. <span class="math display">\[
\begin{equation}
\begin{aligned}
G_t &amp;= \gamma R_{t+1}+\gamma^2
R_{t+2}+\gamma^3R_{t+3}+...+\gamma^{k-1} R_{t+k} ...\\
&amp;=\sum^{\infty}_{k=0}\gamma^k R_{t+k+1}\\
&amp;\leq \sum^{\infty}_{k=0} \gamma^k \times R_{max} \space \text{
,where }R_{max} = \max\{R_{t+1},R_{t+2},...R_{t+k}\}\\
&amp;=R_{max} \sum^{\infty}_{k=0} \gamma^k \\
&amp;= R_{max} {1\over 1-\gamma} &lt; \infty
\end{aligned}
\end{equation}
\]</span> The value of <span class="math inline">\(\gamma\)</span>
influences how far-sighted or short-sighted the agent is. If <span
class="math inline">\(\gamma\)</span> is large, the agent is
<strong>far-sighted</strong>, meaning it prioritizes long-term rewards
over immediate ones. If <span class="math inline">\(\gamma\)</span> is
small, the agent is <strong>short-sighted</strong>, focusing heavily on
immediate rewards while ignoring distant future outcomes.</p>
<p>The cumulative reward can also be written as follows, representing
how the current cumulative reward is determined by the next step's
reward and cumulative reward: <span class="math display">\[
\begin{equation}
\begin{aligned}
G_t &amp;= \gamma R_{t+1}+\gamma^2 R_{t+2}+...\\
&amp;=R_{t+1} + \gamma (R_{t+2} + \gamma R_{t+3} + ...)\\
&amp;=R_{t+1} + \gamma G_{t+1}
\end{aligned}
\end{equation}
\]</span></p></li>
</ul>
<h4 id="policy">Policy</h4>
<p>The outcome of RL is policy <span class="math inline">\(\pi\)</span>,
which is a projection or mapping from input state <span
class="math inline">\(s\)</span> to output action <span
class="math inline">\(a\)</span>.</p>
<p><strong>Deterministic Policy</strong>: A deterministic policy maps
each state to a single, specific action. In other words, given the same
state, the agent will always select the same action. Deterministic
policies may fail in environments with high uncertainty or noise, as
they do not allow for the exploration of alternative actions. <span
class="math display">\[
\pi(s)=a
\]</span> <strong>Stochastic Policy</strong>: A stochastic policy maps
each state to a probability distribution over possible actions. For a
given state, the agent selects an action based on this distribution,
meaning different actions can be chosen with varying probabilities.
Requires learning and maintaining a probability distribution over
actions, which can be computationally expensive. <span
class="math display">\[
\begin{aligned}
\pi(a|s) &amp;= P(a|s) \geq 1, \\
&amp;\text{where }P(a|s)  \text{ is the probability of selecting action
a in state s.}\\
\sum_{a\in A(s)}\pi(a|s)&amp;=1
\end{aligned}
\]</span></p>
<h3 id="bellman-equations">Bellman Equations*</h3>
<h4 id="state-value-functions-and-action-value-functions">State-Value
Functions and Action-Value Functions</h4>
<p><strong>State-Value Functions</strong>: denoted as <span
class="math inline">\(V_\pi(s)\)</span>, represents the expected
cumulative future rewards starting from a particular state <span
class="math inline">\(s\)</span> and following a specific policy <span
class="math inline">\(\pi\)</span> thereafter. It measures the
"goodness" of being in the state <span class="math inline">\(s\)</span>,
considering the long-term rewards achievable from that state under
policy <span class="math inline">\(\pi\)</span>. It does not depend on
specific actions but rather on the overall behavior dictated by the
policy. <span class="math display">\[
\begin{aligned}
V_\pi(s)=  E_\pi[G_t|S_t=s], \\
\space G_t=\sum^\infty_{k=0}\gamma^kR_{t+k+1}
\end{aligned}
\]</span> <strong>Action-Value Functions</strong>: denoted as <span
class="math inline">\(Q_\pi(s,a)\)</span>, represents the expected
cumulative future rewards starting from the state <span
class="math inline">\(s\)</span>, taking action <span
class="math inline">\(a\)</span>, and then following a specific policy
<span class="math inline">\(\pi\)</span> thereafter. It measures the
“goodness” of taking action <span class="math inline">\(a\)</span> in
state <span class="math inline">\(s\)</span>, considering both immediate
rewards and future rewards achievable under the policy <span
class="math inline">\(\pi\)</span>. It provides more granular
information than <span class="math inline">\(V(s)\)</span>, as it
evaluates specific actions rather than just states. <span
class="math display">\[
Q_\pi(s,a) = E_\pi[G_t|S_t=s, A_t=a]
\]</span> The relationship between the state-value function and the
action-value function can be expressed using the following formula:
<span class="math display">\[
V_\pi(s) =\sum_{a \in A} \pi(a|s) Q_\pi (s,a)
\]</span> This equation shows that the value of a state under policy
<span class="math inline">\(\pi\)</span>, <span
class="math inline">\(V_\pi(s)\)</span>, is the expected value of the
action-value function <span class="math inline">\(Q_\pi(s,a)\)</span>,
weighted by the probability of taking each action <span
class="math inline">\(a\)</span> in state <span
class="math inline">\(s\)</span> according to policy <span
class="math inline">\(\pi(a|s)\)</span>.</p>
<h4
id="state-value-bellman-equation-and-action-value-bellman-equation">State-Value
Bellman Equation and Action-Value Bellman Equation</h4>
<p><strong>State-Value Bellman Equation</strong>:</p>
<figure>
<img
src="/di-blog/2024/12/29/Understanding-RLHF/bellman_equation_huggingface.png"
alt="bellman_equation_huggingface" />
<figcaption aria-hidden="true">bellman_equation_huggingface</figcaption>
</figure>
<p>(Source: <a
target="_blank" rel="noopener" href="https://huggingface.co/learn/deep-rl-course/en/unit2/bellman-equation">The
Bellman Equation: simplify our value estimation</a>)</p>
<p>The State-Value Bellman Equation can be written in a recursive form.
<span class="math display">\[
\begin{aligned}
V_\pi(s) &amp;= E_\pi(G_t|S_t=s)\\
&amp;= E_\pi(R_{t+1}+rG_{t+1}|S_t=s)\\
&amp;=\sum_a \pi(a|s) \sum_{s&#39;}\sum_r p(s&#39;,r|s,a) [r +
V_\pi(s&#39;)]
\end{aligned}
\]</span></p>
<p>The tree structure below as an example can help understand the
recursive property of the State-Value Bellman Equation. Note that an
action <span class="math inline">\(a\)</span> does not necessarily lead
to a specific state <span class="math inline">\(s\)</span>, it can
result in multiple possible states, each with a certain probability.
These probabilities are determined by the environment, which we
typically do not have direct access to.</p>
<figure>
<img
src="/di-blog/2024/12/29/Understanding-RLHF/bellman_equation_tree.png"
alt="bellman_equation_tree" />
<figcaption aria-hidden="true">bellman_equation_tree</figcaption>
</figure>
<p><strong>Action-Value Bellman Equation</strong>:</p>
<figure>
<img
src="/di-blog/2024/12/29/Understanding-RLHF/action_value_equation_huggingface.png"
alt="action_value_equation_huggingface" />
<figcaption
aria-hidden="true">action_value_equation_huggingface</figcaption>
</figure>
<p>(Source: <a
target="_blank" rel="noopener" href="https://huggingface.co/learn/deep-rl-course/unit2/two-types-value-based-methods?utm_source=perplexity">Two
types of value-based methods</a>)</p>
<p>The Action-Value Bellman Equation can be written in a recursive form
as well: <span class="math display">\[
\begin{aligned}
Q_\pi(s,a)&amp;= E_\pi[G_t|S_t=s, A_t=a]\\
&amp;=\sum_{s&#39;}\sum_{r}
P(s&#39;,r|s,a)[r+\gamma\sum_{a&#39;}\pi(a&#39;|s&#39;)Q_\pi(s&#39;,a&#39;)]
\end{aligned}
\]</span> The tree structure below as an example can help understand the
recursive property of the Action-Value Bellman Equation.</p>
<figure>
<img
src="/di-blog/2024/12/29/Understanding-RLHF/action_value_bellman_equation_tree.png"
alt="action_value_bellman_equation_tree" />
<figcaption
aria-hidden="true">action_value_bellman_equation_tree</figcaption>
</figure>
<p>The main limitations of Bellman Equation:</p>
<ul>
<li>In real-world problems, the number of states can be extremely large,
requiring a separate Bellman equation for each state. This results in a
system of simultaneous nonlinear equations due to the presence of the
max operator, which can be difficult to solve.</li>
<li>Solving Bellman equations often requires iterative methods and can
demand significant computational resources. This is particularly true
when seeking high-precision approximations over many iterations.</li>
<li>In applications like the Bellman-Ford algorithm for finding shortest
paths, the presence of negative cycles can pose a problem. If a cycle
has a negative total sum of edges, it can lead to an undefined shortest
path since iterating through the cycle can indefinitely reduce the path
length.</li>
<li>The Bellman equation is inherently nonlinear because it involves
maximizing over possible actions. This nonlinearity can complicate
finding solutions, especially when dealing with large state spaces or
complex reward structures.</li>
</ul>
<h3 id="policy-iteration">Policy Iteration</h3>
<p>In RL, an <strong>optimal policy</strong> is a policy that maximizes
the expected cumulative reward (or return) for an agent across all
states in a <strong>Markov Decision Process (MDP)</strong>. This means
that the state-value function <span
class="math inline">\(v_{\pi}(s)\)</span> or the action-value function
<span class="math inline">\(q_{\pi}(s,a)\)</span> under the optimal
policy is greater than or equal to that of any other policy for all
states and actions. <span class="math display">\[
\pi^*(s) \geq \pi(s), \forall s \in \text{states}
\]</span> In finite MDPs, at least one optimal policy always exists.
However, there may be multiple optimal policies that achieve the same
maximum expected return.</p>
<p><strong>Policy Iteration</strong> is a <strong>dynamic
programming</strong> algorithm used in RL to compute the optimal policy
<span class="math inline">\(\pi^*\)</span> for a Markov Decision Process
(MDP). It alternates between two main steps: <strong>policy
evaluation</strong> and <strong>policy improvement</strong>, iteratively
refining the policy until convergence.</p>
<p>The full policy iteration algorithm pseudocode is in the figure below
(Source: <a
target="_blank" rel="noopener" href="https://lcalem.github.io/blog/2018/09/24/sutton-chap04-dp">Sutton
&amp; Barto summary chap 04 - Dynamic Programming</a>):</p>
<figure>
<img
src="/di-blog/2024/12/29/Understanding-RLHF/policy_iteration_pseudocode.png"
alt="policy_iteration_pseudocode" />
<figcaption aria-hidden="true">policy_iteration_pseudocode</figcaption>
</figure>
<p>Here is a detailed explanation of this policy iteration's algorithm
pseudocode.</p>
<p>Repeat steps until convergence:</p>
<ol type="1">
<li><p>Policy evaluation: keep current policy <span
class="math inline">\(\pi\)</span> fixed, find value function <span
class="math inline">\(V(\cdot)\)</span>.</p>
<p>Iterate Bellman update until values <strong>converge</strong>:</p>
<p><span class="math display">\[
V(s) \leftarrow \sum_{s&#39;,r}p(s&#39;,r|s,\pi(s))[r+\gamma V(s&#39;)]
\]</span> The Bellman operator computes future rewards but discounts
them by multiplying with <span class="math inline">\(\gamma\)</span>.
This ensures that differences in value functions become smaller with
each iteration. In other words, <strong>Bellman shrinks
distances</strong>. To see it mathematically,</p>
<p>The Bellman operator for the state-value function under a fixed
policy <span class="math inline">\(\pi\)</span> is defined as <span
class="math display">\[
V^{\pi}(s) = r(s, \pi(s)) + \gamma \sum_s P(s|s,\pi(s))V(s&#39;)
\]</span> This operator updates the value function by combining the
immediate reward and the discounted future rewards.</p>
<p>We compute the difference after applying the operator: <span
class="math display">\[
\Big|V^{\pi}_1(s)-V^{\pi}_2(s)\Big| = \Big|r(s,\pi(s))+\gamma\sum_s P
(s|s,\pi(s))V_1(s&#39;)-\Big[r(s,\pi(s))+\gamma\sum_s P
(s|s,\pi(s))V_2(s&#39;)\Big]\Big|
\]</span> Simplify by canceling out the immediate rewards, we get: <span
class="math display">\[
\Big|V^{\pi}_1(s)-V^{\pi}_2(s)\Big| = \gamma \Big|\sum_s P
(s|s,\pi(s))\Big(V_1(s&#39;)-V_2(s&#39;)\Big)\Big|
\]</span> Since <span class="math inline">\(\gamma&lt;1\)</span>, the
difference between <span class="math inline">\(V_1^{\pi}(s)\)</span> and
<span class="math inline">\(V_1^{\pi}(s)\)</span> is always smaller than
the difference between <span class="math inline">\(V_1(s&#39;)\)</span>
and <span class="math inline">\(V_1(s&#39;)\)</span>. Because Bellman
operator shrinks distances, it is a <strong>contraction mapping</strong>
and follows the contraction mapping property.</p>
<p>In summary, Policy evaluation is a contraction mapping for a fixed
policy <span class="math inline">\(\pi\)</span>. Policy evaluation
converges because it applies a contraction mapping repeatedly to compute
the value function for a fixed policy.</p></li>
<li><p>Policy improvement: find the best action for <span
class="math inline">\(V(\cdot)\)</span> via one-step lookahead.</p>
<p>During policy improvement, the current policy <span
class="math inline">\(\pi\)</span> is updated by selecting actions that
maximize the expected return for each state <span
class="math inline">\(s\)</span>.</p>
<p><span class="math inline">\(\pi(s) \leftarrow \arg \max_a
\sum_{s&#39;,r}p(s&#39;,r|s,a)[r+\gamma V(s&#39;)]\)</span></p>
<p>The intuition behind: <span class="math inline">\(V^{\pi}(s)\)</span>
measures how good it is to start from the state <span
class="math inline">\(s\)</span> and follow policy <span
class="math inline">\(\pi\)</span>. By improving the actions selected by
the policy, we ensure that the agent transits into states with higher
expected cumulative rewards. This iterative process ensures that each
new policy improves upon or equals the previous one in terms of total
expected rewards.</p></li>
</ol>
<p>Overall, the idea of Policy Iteration can be demonstrated in the
diagram below. The evaluation process usually takes a long time while
the improvement process is usually fast.</p>
<figure>
<img
src="/di-blog/2024/12/29/Understanding-RLHF/policy_iteration_eval_impro_demo.png"
alt="policy_iteration_eval_impro_demo" />
<figcaption
aria-hidden="true">policy_iteration_eval_impro_demo</figcaption>
</figure>
<p>The <strong>Generalized Policy Iteration (GPI)</strong> method can
speed up the policy evaluation process. In GPI, policy evaluation
process can be approximate or partial (e.g., only a few iterations
instead of full convergence). Policy improvement can also be done
incrementally or partially. GPI speeds up the process of finding an
optimal policy by relaxing the strict requirements of full convergence
in policy evaluation.</p>
<figure>
<img
src="/di-blog/2024/12/29/Understanding-RLHF/generalized_policy_iteration.png"
alt="generalized_policy_iteration" />
<figcaption aria-hidden="true">generalized_policy_iteration</figcaption>
</figure>
<h3 id="monte-carlo-method">Monte Carlo Method</h3>
<p>Monte Carlo methods are specifically designed for episodic tasks,
where each episode eventually terminates, regardless of the actions
taken by the agent. An <strong>episode</strong> refers to a complete
sequence of interactions between an agent and the environment, starting
from an initial state and ending in a terminal state.</p>
<h4 id="monte-carlo-for-policy-evaluation"><strong>Monte Carlo for
Policy Evaluation</strong></h4>
<p>Value function and policy updates occur only after an episode is
complete. By waiting for the end of an episode, Monte Carlo methods
ensure that all rewards following a state are included in the return
calculation. Monte Carlo methods learn purely from sampled experience
(episodes), without requiring knowledge of transition probabilities or
reward models. Episodes allow Monte Carlo methods to handle stochastic
environments by averaging returns across multiple episodes.</p>
<p>Here is an example of calculating the state-value functions and
action-action functions by Monte Carlo Method once 2 episodes are
completed. Given states <span class="math inline">\(S=[A,B,C,D,E],
A=[1,2,3]\)</span>, and two episodes <span
class="math inline">\(E_1,E_2\)</span>, (Note: <span
class="math inline">\(A:(1,0.4)\)</span> means state <span
class="math inline">\(A\)</span>, action <span
class="math inline">\(1\)</span>, and reward <span
class="math inline">\(0.4\)</span>) <span class="math display">\[
\begin{aligned}
&amp;E_1 = \{A:(1,0.4), B:(2,0.5), A:(2,0.6), C:(2,0.1), B:(3,0.8),
E:()\}\\
&amp;E_2 = \{B:(2,0.5), A:(1,0.6), C:(2,0.3), A:(1,0.3), C:(2,0.8),
E:()\}
\end{aligned}
\]</span></p>
<ol type="1">
<li><p>State-Value Functions Calculation</p>
<p>We can calculate <span
class="math inline">\(V(A),V(B),V(C),V(D),V(E)\)</span>.</p>
<p>e.g. there are 4 sequences starting from state <span
class="math inline">\(A\)</span>, then the state value function is:
<span class="math display">\[
\begin{aligned}
V(A) &amp;= [(0.4+\gamma 0.5 + \gamma^2 0.6 + \gamma^3 0.1 + \gamma^4
0.8)\\
&amp;+(0.6+\gamma 0.1 + \gamma^2 0.8)\\
&amp;+(0.6+\gamma 0.3 + \gamma^2 0.3 + \gamma^4 0.8)\\
&amp;+(0.3+\gamma 0.8)] / 4
\end{aligned}
\]</span></p></li>
<li><p>Action-Value Functions Calculation</p>
<p>We can calculate <span
class="math inline">\(Q(A,1),Q(B,2),\cdots\)</span>.</p>
<p>e.g. there are three sequences starting from <span
class="math inline">\(A:(1,)\)</span>, then the action value function is
<span class="math display">\[
\begin{aligned}
Q(A,1) &amp;= [(0.4+\gamma 0.5 + \gamma 0.6 + \gamma^3 0.1+ \gamma^4
0.8)\\
&amp;+(0.6+\gamma 0.3 + \gamma^2 0.3 + \gamma^3 0.8)\\
&amp;+(0.3+\gamma 0.8)]/3
\end{aligned}
\]</span></p></li>
</ol>
<p>The pseudocode for the above Monte Carlo for Policy Evaluation is as
follows (Source: <a
target="_blank" rel="noopener" href="https://www.amazon.com/Reinforcement-Learning-Introduction-Adaptive-Computation/dp/0262039249">Reinforcement
Learning by Sutton and Barto</a>, Chapter 5):</p>
<figure>
<img
src="/di-blog/2024/12/29/Understanding-RLHF/montecarlo_statevalue.png"
alt="montecarlo_statevalue" />
<figcaption aria-hidden="true">montecarlo_statevalue</figcaption>
</figure>
<p>As part of the algorithm, it loops for each step of episode from the
end <span class="math inline">\(T-1\)</span> to the beginning of the
episode. This allows for dynamic programming where some values can be
stored and do not need to be re-calculated (see a simple demonstration
below).</p>
<figure>
<img
src="/di-blog/2024/12/29/Understanding-RLHF/montecarlo_algo_dynamic_program.png"
alt="montecarlo_algo_dynamic_program" />
<figcaption
aria-hidden="true">montecarlo_algo_dynamic_program</figcaption>
</figure>
<h4 id="monte-carlo-for-policy-improvement"><strong>Monte Carlo for
Policy Improvement</strong></h4>
<p><span class="math display">\[
\pi_{k+1}(s)=\arg \max_a q_{\pi_k}(s,a)
\]</span></p>
<p>Here is an example of updating policy by action-value function. Given
states <span class="math inline">\(S=[A,B,C,D,E], A=[1,2,3],
\gamma=0.5\)</span>, and a episode <span
class="math inline">\(E\)</span>, (Note: <span
class="math inline">\(A:(1,0.7)\)</span> means state <span
class="math inline">\(A\)</span>, action <span
class="math inline">\(1\)</span>, and reward <span
class="math inline">\(0.7\)</span>) <span class="math display">\[
E = \{A:(1,0.7), B:(1,0.4), A:(3,1.5), C:(2,0.1), B:(3,0.7),
A:(1,0.3)\}\
\]</span> Through dynamic programming, cumulative reward is <span
class="math inline">\(G_5(A,1)=0.3\)</span>, <span
class="math inline">\(G_4(B,3)=0.7+0.5*3=0.85\)</span>, <span
class="math inline">\(G_3(C,2)=0.1+0.5*0.85=0.52\)</span>, <span
class="math inline">\(G_2(A,3)=1.5+0.52*0.5=1.76\)</span>, <span
class="math inline">\(G_1(B,1)=0.4+1.76*0.5=1.28\)</span>, <span
class="math inline">\(G_0(A,1)=0.7+1.28*0.5=1.34\)</span>. We can
maintain three lists to make the algorithm work:</p>
<ul>
<li>Return matrix <span class="math inline">\(Returns(S,A)\)</span>,
dimension <span class="math inline">\((S, A)\)</span>: It stores
cumulative reward values <span
class="math inline">\(G(S=s,A=a)\)</span>. One cell can store multiple
values as the number of episodes increases.</li>
<li><span class="math inline">\(Q(S,A)\)</span> matrix: It's initialized
as random numbers at the beginning. Updated whenever the return matrix
is updated. <span class="math inline">\(Q(S,A)\)</span> is the average
value of the corresponding <span
class="math inline">\(Returns(S,A)\)</span>.</li>
<li><span class="math inline">\(\pi(s)\)</span> list: It's updating
Epsilon values by giving <span class="math inline">\(1-\epsilon\)</span>
probability to the action with highest reward for each state, according
to the updated <span class="math inline">\(Q(S,A)\)</span> matrix. It
facilitates Epsilon Greedy Algorithm.</li>
</ul>
<p>The final updating result of the above example is in the diagram
below.</p>
<figure>
<img
src="/di-blog/2024/12/29/Understanding-RLHF/mc_action_value_update_res.png"
alt="mc_action_value_update_res" />
<figcaption aria-hidden="true">mc_action_value_update_res</figcaption>
</figure>
<p>The pseudocode for the above Monte Carlo for Policy Improvement with
action-value function is as follows (Source: <a
target="_blank" rel="noopener" href="https://www.amazon.com/Reinforcement-Learning-Introduction-Adaptive-Computation/dp/0262039249">Reinforcement
Learning by Sutton and Barto</a>, Chapter 5):</p>
<figure>
<img
src="/di-blog/2024/12/29/Understanding-RLHF/monte_carlo_action_value.png"
alt="monte_carlo_action_value" />
<figcaption aria-hidden="true">monte_carlo_action_value</figcaption>
</figure>
<figure>
<img
src="/di-blog/2024/12/29/Understanding-RLHF/mc_control_epsilon_pi.png"
alt="mc_control_epsilon_pi" />
<figcaption aria-hidden="true">mc_control_epsilon_pi</figcaption>
</figure>
<h4 id="main-limitation">Main Limitation</h4>
<ul>
<li>Policy updates occur only after an episode is completed, which can
slow down learning compared to methods like Temporal Difference (TD)
learning that update incrementally after each step.</li>
<li>MC methods do not use bootstrapping (i.e., they do not update value
estimates based on other estimates). While this avoids bias, it also
means MC methods cannot leverage intermediate value estimates, leading
to slower convergence.</li>
</ul>
<h4 id="temporal-difference-learning">Temporal Difference Learning</h4>
<p>TD leanring focuses on estimating the value function of a given
policy by updating value estimates based on the difference between
successive predictions, rather than waiting for an entire episode to
conclude.</p>
<p>Given <span class="math display">\[
\begin{aligned}
V(S_t) &amp;\leftarrow V(S_t) + \alpha \Big[G_t - V(S_t)\Big]\\
G_t &amp;= R_{t+1} + \gamma R_{t+2} + \gamma^2 R_{t+3} + ... = R_{t+1} +
\gamma G_{t+1}\\
V_{\pi}(s) &amp;= E_\pi[G_t|S_t=s] = E_\pi\Big[R_{t+1} + \gamma G_{t+1}|
S_t=s\Big] = R_{t+1} + \gamma V_\pi(S_{t+1})
\end{aligned}
\]</span> We can derive the core function of TD: <span
class="math display">\[
V(S_t) \leftarrow V(S_t) + \alpha [R_{t+1} + \gamma V(R_{t+1}) - V(S_t)]
\]</span> The pseudocode of TD learning is as follows. (Source: <a
target="_blank" rel="noopener" href="https://lcalem.github.io/blog/2018/10/31/sutton-chap06-td">Sutton
&amp; Barto summary chap 06 - Temporal Difference Learning</a>)</p>
<figure>
<img src="/di-blog/2024/12/29/Understanding-RLHF/td_learning_for_v.png"
alt="td_learning_for_v" />
<figcaption aria-hidden="true">td_learning_for_v</figcaption>
</figure>
<h4 id="from-table-to-function-approximation"><strong>From table to
function approximation</strong></h4>
<p>Main limitations of table based methods:</p>
<ul>
<li>As the number of state variables increases, the size of the state
space grows exponentially.</li>
<li>Storing a value table becomes impractical for large or continuous
state/action spaces due to memory limitations.</li>
<li>Table-based methods treat each state (or state-action pair)
independently. They cannot generalize knowledge from one part of the
state space to another, requiring every state to be visited multiple
times for accurate learning.</li>
<li>In large state spaces, it is unlikely that an agent will visit all
relevant states/actions frequently enough to converge to an optimal
policy within a reasonable time frame.</li>
<li>Table-based methods are well-suited for small problems but fail to
scale to real-world applications such as autonomous driving, robotics,
or complex games like Go or StarCraft.</li>
</ul>
<p><strong>From tabular to parametric functions</strong>:</p>
<p>Fit a parametric function to approximate the value function <span
class="math inline">\(V(s)\)</span> which maps states <span
class="math inline">\(s\)</span> to their corresponding value estimates.
<span class="math display">\[
f(s,\theta) \approx V(s)
\]</span> where <span class="math display">\[
f(s,\theta)=w^Ts+b
\]</span> To optimize this approximation, we minimize the <strong>mean
squared error (MSE)</strong> loss between the observed value <span
class="math inline">\(v(s)\)</span> and predicted <span
class="math inline">\(\hat{v}(s,{w})\)</span> from Monte Carlo. <span
class="math inline">\(\mu(s)\)</span> is the probability distribution
over states. This loss ensures that the predicted values are as close as
possible to the observed values. <span class="math display">\[
\ell = \min \sum_s \mu(s) \Big[v_\pi(s)-\hat{v}(s,{w})\Big]^2
\]</span> The optimal <span class="math inline">\({w}\)</span> that
minimize the loss can be found by batch <strong>Gradient
Descent</strong> (<span class="math inline">\(\eta\)</span> is learning
rate). <span class="math display">\[
w \leftarrow w - \eta \nabla \ell(w)
\]</span> where <span class="math display">\[
\begin{aligned}
\nabla \ell(w) &amp;= \nabla \sum_s \mu(s) \Big[v_\pi(s) -
\hat{v}(s,{w})\Big]^2\\
&amp;= \sum_s \mu(s) \nabla \Big[v_\pi(s) - \hat{v}(s,{w})\Big]^2\\
&amp;= -2 \sum_s \mu(s)  \Big[v_\pi(s) - \hat{v}(s,{w})\Big]\nabla
\hat{v}(s,{w})
\end{aligned}
\]</span> <strong>From Gradient Descent to Stochastic Gradient
Descent</strong>:</p>
<p>While batch gradient descent computes gradients over the entire
dataset (all states), this can be computationally expensive for
large-scale problems. Instead, <strong>stochastic gradient descent
(SGD)</strong> updates the parameters incrementally using one
observation at a time. Given observations <span
class="math inline">\((S_1, v_\pi(S_1)), (S_2, v_\pi(S_2)), (S_3,
v_\pi(S_3)), ...\)</span>, SGD performs updates as follows (<span
class="math inline">\(\alpha\)</span> is learning rate). <span
class="math display">\[
\begin{aligned}
{w}_2 &amp;= {w}_1 + \alpha \Big[v_\pi(S_1) - \hat{v}(S_1,{w_1})\Big]
\nabla \hat{v}(S_1,{w}_1)\\
{w}_3 &amp;= {w}_2 + \alpha \Big[v_\pi(S_2) - \hat{v}(S_2,{w_2})\Big]
\nabla \hat{v}(S_2,{w}_2)\\
&amp;\cdots
\end{aligned}
\]</span> The algorithm of Gradient Monte Carlo is as follows. (Source:
<a
target="_blank" rel="noopener" href="https://www.amazon.com/Reinforcement-Learning-Introduction-Adaptive-Computation/dp/0262039249">Reinforcement
Learning by Sutton and Barto</a>)</p>
<figure>
<img
src="/di-blog/2024/12/29/Understanding-RLHF/gradient_montecarlo_v.png"
alt="gradient_montecarlo_v" />
<figcaption aria-hidden="true">gradient_montecarlo_v</figcaption>
</figure>
<h2 id="ppo-prior">PPO Prior</h2>
<h3 id="average-reward"><strong>Average Reward</strong></h3>
<p>The average reward is an alternative to the commonly used discounted
reward framework. It measures the long-term average reward per time step
under a given policy, making it particularly suitable for continuing
tasks (non-episodic problems) where there is no natural endpoint or
terminal state.</p>
<p>The average reward framework is particularly useful for continuing
tasks, where:</p>
<ul>
<li>The task does not have a natural termination point (e.g., robot
navigation, server optimization, or industrial control systems).</li>
<li>The agent operates indefinitely, and evaluating its performance
based on long-term behavior (rather than episodic returns) is more
meaningful.</li>
</ul>
<p>The average reward for a policy is defined as: <span
class="math display">\[
r(\pi)=\lim_{h \rightarrow \infty} {1\over h}\sum^h_{t=1} E\Big[R_t |
S_0, A_{0:t-1} \sim \pi\Big]
\]</span> This simple example shows how average reward is
calculated:</p>
<figure>
<img
src="/di-blog/2024/12/29/Understanding-RLHF/average_reward_policy.png"
alt="average_reward_policy" />
<figcaption aria-hidden="true">average_reward_policy</figcaption>
</figure>
<h3 id="differential-return">Differential Return</h3>
<p>The differential return in RL is a concept that arises in the average
reward framework, particularly for continuing tasks. It measures the
cumulative deviation of rewards from the long-term average reward rate,
<span class="math inline">\(r(\pi)\)</span> , under a given policy <span
class="math inline">\(\pi\)</span>.</p>
<p>Differential return aligns with the goal of maximizing long-term
performance in continuing tasks by focusing on deviations from
steady-state behavior. Unlike discounted returns, differential return
does not rely on a discount factor <span
class="math inline">\(\gamma\)</span>. This avoids biases introduced by
choosing an arbitrary discount factor. It is particularly well-suited
for tasks with no natural termination, such as robotics or industrial
control systems.</p>
<p>The differential return at time step <span
class="math inline">\(t\)</span> is defined as: <span
class="math display">\[
G_t = R_{t+1} - r(\pi)+R_{t+2} - r(\pi)+R_{t+3} - r(\pi)
\]</span> Then the value functions can be rewritten as <span
class="math display">\[
\begin{aligned}
v_\pi(s) = \sum_a \pi(a|s)\sum_{r,s&#39;} p(s&#39;,r|s,a) \Big[r-r(\pi)
+v_{\pi}(s&#39;)\Big]\\
q_\pi(s,a) = \sum_{r,s&#39;} p(s&#39;,r|s,a) \Big[r-r(\pi)
+\sum_{a&#39;}\pi(a&#39;|s&#39;)q_{\pi}(s&#39;,a&#39;)\Big]
\end{aligned}
\]</span> Algorithms like Gradient Monte Carlos can be rewritten by
using this differential return.</p>
<h3 id="policy-gradient-and-reinforce">Policy Gradient and
REINFORCE</h3>
<p>Objective of policy gradient: <span class="math display">\[
\begin{aligned}
J(\theta) &amp;= \sum_{s\in S}d^{\pi}(s)V^\pi(s) = \sum_{s\in S}
d^\pi(s) \sum_{a\in A} \pi_\theta(a|s) Q^\pi(s,a)\\
d^\pi(s) &amp;= \lim_{t\rightarrow \infty}P(s_t=s|s_o,\pi_\theta)
\rightarrow \text{ converege (Markov Property)}\\
&amp;\max J(\theta): \\
&amp;\max \sum_{s\in S} d^\pi(s) V^\pi(s) \implies \theta \leftarrow
\theta + \nabla_\theta J(\theta)
\end{aligned}
\]</span> <strong>Policy gradient theorem</strong> allows us to compute
the gradient of the expected return with respect to the parameters of a
parameterized policy, enabling optimization through gradient ascent.
<span class="math display">\[
\begin{aligned}
\nabla_\theta J(\theta) &amp;= \nabla _\theta\Big[\sum_{s\in S} d^\pi(s)
\sum_{a\in A} \pi_\theta(a|s) Q^\pi(s,a)\Big]\\
&amp;\propto \sum_{s\in S} d^\pi(s) \sum_{a\in A} Q^\pi(s,a) \nabla
_\theta\pi_\theta(a|s)\\
&amp;\implies \theta \leftarrow \theta + \eta\Big[\sum_{s\in S} d^\pi(s)
\sum_{a\in A} Q^\pi(s,a) \nabla _\theta\pi_\theta(a|s) \Big]
\end{aligned}
\]</span> Since Monte Carlo involves a sampling step, which requires an
expectation form. The gradient derived above can be re-written as
follows, supporting gradient estimation. (Recall: <span
class="math inline">\((\ln x)&#39; = 1/x\)</span>) <span
class="math display">\[
\begin{aligned}
\nabla_\theta J(\theta) &amp;\propto \sum_{s\in S} d^\pi(s) \sum_{a\in
A} Q^\pi(s,a) \nabla _\theta\pi_\theta(a|s)\\
&amp;=\sum_{s\in S}d^\pi(s) \sum_{a\in A} \pi_\theta(a|s) Q^\pi(s,a)
{\nabla_{\theta} \pi_\theta(a|s)\over \pi_\theta(a|s)}\\
&amp;=E_\pi\Big[Q^\pi(s,a)\nabla_\theta \ln\pi_\theta(a|s)\Big]\\
(&amp;=E_{s \sim \pi, a \sim
\pi_\theta(a|s)}\Big[Q^\pi(s,a)\nabla_\theta \ln\pi_\theta(a|s)\Big])\\
\end{aligned}
\]</span> Given the above theorems, a <strong>Reinforce Algorithm -
Monte-Carlo Policy-Gradient algorithm</strong> is defined as follows.
(Source: <a
target="_blank" rel="noopener" href="https://lcalem.github.io/blog/2019/03/21/sutton-chap13">Sutton
&amp; Barto summary chap 13 - Policy Gradient Methods</a>)</p>
<figure>
<img
src="/di-blog/2024/12/29/Understanding-RLHF/montecarlo_policy_gradient_pi.png"
alt="montecarlo_policy_gradient_pi" />
<figcaption
aria-hidden="true">montecarlo_policy_gradient_pi</figcaption>
</figure>
<p>A differentiable policy ensures that small changes in <span
class="math inline">\(\theta\)</span> result in smooth changes in the
action probabilities <span
class="math inline">\(\pi(a|s,\theta)\)</span>. This is crucial for
stable and efficient learning. The <strong>softmax function</strong> is
commonly used to parameterize policies in discrete action spaces. The
softmax function is smooth and differentiable, enabling gradient-based
optimization. Softmax ensures that all actions have non-zero
probabilities, promoting exploration during training.</p>
<p>Here the differentiable policy parameterization <span
class="math inline">\(\pi(a|s,{\theta})\)</span> can be defined by <span
class="math display">\[
\pi(a|s,\theta) = {\exp(h(s,a,\theta)) \over \sum_{b\in A}
\exp(h(s,b,\theta))}
\]</span> where <span
class="math inline">\(h(s,a,\theta)=w_a^T+b_a\)</span> is a linear or
non-linear function representing the preference for action <span
class="math inline">\(a\)</span>. The denominator normalizes the
probabilities so that they sum to 1.</p>
<p>The log of the softmax function has a convenient derivative that
simplifies gradient computation: <span class="math display">\[
\nabla_\theta\ln \pi(a,s,\theta) = \nabla_\theta h(s,a,\theta) - \sum_b
\pi(b|s,\theta) \nabla_\theta h(s,b,\theta)
\]</span></p>
<h3 id="main-limitations-of-reinforce">Main Limitations of
REINFORCE</h3>
<ul>
<li>REINFORCE requires complete episodes to compute the return for each
state, as it relies on Monte Carlo estimates of the expected return.
This makes it unsuitable for continuing tasks (non-episodic
environments) where there is no clear terminal state.</li>
<li>The gradient estimates in REINFORCE have high variance because they
depend on the total return from sampled episodes, which can vary
significantly due to stochasticity in the environment and policy.</li>
<li>Since REINFORCE updates the policy only after completing an episode,
it does not make use of intermediate data. This results in poor sample
efficiency, requiring a large number of episodes to learn
effectively.</li>
<li>Unlike Temporal Difference (TD) methods, REINFORCE does not use
bootstrapping (i.e., it does not update value estimates based on other
estimates). It relies solely on complete returns from episodes.</li>
<li>The algorithm is highly sensitive to the choice of the learning
rate. A poorly chosen learning rate can lead to divergence or extremely
slow convergence.</li>
</ul>
<h3 id="advantage-function">Advantage Function</h3>
<p>Advantage function employs the idea of differential return. In the
REINFORCE algorithm, with advantage function, policy gradient can be
re-written as <span class="math display">\[
\begin{aligned}
\nabla_\theta J(\theta) &amp;=E_\pi\Big[Q^\pi(s,a)\nabla_\theta
\ln\pi_\theta(a|s)\Big]\\
&amp;=E_\pi\Big[A^\pi(s,a)\nabla_\theta \ln\pi_\theta(a|s)\Big]\\
\end{aligned}
\]</span> where <span class="math display">\[
\begin{aligned}
A^{\pi}(s,a) &amp;= Q^\pi(s,a)-V^\pi(s)\\
V^\pi(s) &amp;= \sum_{a\in A}\pi(a|s) Q(s,a)
\end{aligned}
\]</span></p>
<h3 id="off-policy-policy-gradient">Off-Policy Policy Gradient</h3>
<p>Off-policy policy gradient methods allow learning a target policy
while using data generated from a different behavior policy. By reusing
past experiences and learning from suboptimal actions, off-policy
methods can significantly improve sample efficiency. Off-policy learning
allows for better exploration strategies since it can incorporate data
from various policies, including exploratory ones.</p>
<p>The policy gradient estimate is defined as <span
class="math display">\[
\nabla_\theta J(\theta) = E_\beta\Big[{\pi_\theta(a|s)\over \beta(a|s)}
Q^\pi(s,a) \nabla _\theta \ln \pi_\theta (a|s)\Big]
\]</span> <span class="math inline">\(\beta(a|s)\)</span> refers to the
behavior policy that generates the data used for training. The behavior
policy is not necessarily the optimal policy we want to learn (the
target policy <span class="math inline">\(\pi(a|s)\)</span>). Instead,
it can be any policy that provides useful exploration of the
state-action space. <span class="math inline">\({\pi_\theta(a|s)\over
\beta(a|s)}\)</span> is the important weight for sampling.</p>
<h3 id="trust-region-policy-optimization-trpo">Trust Region Policy
Optimization (TRPO)</h3>
<p>TRPO is an advanced policy gradient method in RL designed to optimize
policies while ensuring stable and reliable updates. It addresses some
of the limitations of traditional policy gradient methods by
incorporating a trust region constraint that limits how much the policy
can change in a single update. The difference between REINFORCE and TRPO
is that TRPO uses off-policy policy gradient and advantage function, as
well as a constraint on the Jullback-Leibler (KL) divergence between the
old and new policy.</p>
<p>Recall that REINFORCE's objective of policy gradient is: <span
class="math display">\[
J(\theta) = \sum_{s\in S} d^\pi(s) \sum_{a\in A} \pi_\theta(a|s)
Q^\pi(s,a)
\]</span> The derivation of TRPO's objective of policy gradient is:
<span class="math display">\[
\begin{aligned}
J(\theta) &amp;=\sum_{s \in S} d^{\pi}(s) \sum_{a\in A} (\pi_\theta(a|s)
\hat{A}_{\theta_{old}}(s,a))\\
&amp;=\sum_{s\in S} d^{\pi_{\theta_{old}}} \sum_{a\in A} (\beta(a|s)
{\pi_\theta(a|s)\over \beta(a|s)} \hat{A}_{\theta_{old}}(s,a))\\
&amp;=E_{s\sim d^{\pi_{\theta_{old}}}, a \sim
\beta}\Big[{\pi_\theta(a|s)\over \beta(a|s)}
\hat{A}_{\theta_{old}}(s,a)\Big]\\
&amp;=E_{s\sim d^{\pi_{\theta_{old}}}, a \sim
\pi_{\theta_{old}}}\Big[{\pi_\theta(a|s)\over \pi_{\theta_{old}}(a|s)}
\hat{A}_{\theta_{old}}(s,a)\Big]\\
E_{s\sim
d^{\pi_{\theta_{old}}}}&amp;\Big[D_{KL}\Big(\pi_{\theta_{old}}(\cdot |
s)||\pi_\theta(\cdot|s)\Big)\Big] \leq \delta
\end{aligned}
\]</span> The TRPO constrained optimization is defined as <span
class="math display">\[
\begin{aligned}
&amp;\max E_{s\sim d^{\pi_{\theta_{old}}}, a \sim
\pi_{\theta_{old}}}\Big[{\pi_\theta(a|s)\over \pi_{\theta_{old}}(a|s)}
\hat{A}_{\theta_{old}}(s,a)\Big]\\
&amp; s.t. E_{s\sim
d^{\pi_{\theta_{old}}}}\Big[D_{KL}\Big(\pi_{\theta_{old}}(\cdot |
s)||\pi_\theta(\cdot|s)\Big)\Big] \leq \delta
\end{aligned}
\]</span> One of the main limitations of TRPO is that the constrained
optimization problem can be computationally intensive, especially for
large state and action spaces.</p>
<h2 id="ppo">PPO</h2>
<h3 id="ppo-objective">PPO Objective</h3>
<p>To address the computational expense of the constrained optimization
in TRPO, researchers introduced the <strong>CLIP objective</strong> in
policy gradient methods. The CLIP objective simplifies the optimization
process while maintaining stable policy updates. Below are the TRPO
objective and its corresponding CLIP version: <span
class="math display">\[
\begin{aligned}
J^{TRPO}(\theta) &amp;= E[r(\theta)\hat{A}_{\theta_{old}}(s,a)]\\
J^{CLIP}(\theta) &amp;= E[\min(r(\theta)\hat{A}_{\theta_{old}}(s,a)),
\text{clip}(r(\theta),1-\epsilon, 1+\epsilon)
\hat{A}_{\theta_{old}}(s,a)]
\end{aligned}
\]</span> where <span class="math display">\[
\begin{aligned}
&amp;r(\theta) = {\pi_{\theta (a|s)} \over \pi_{\theta_{old}(a|s)}}\\
&amp;r(\theta) \in [1-\epsilon, 1+ \epsilon], \\
&amp;i.e. 1-\epsilon \leq r(\theta) \leq 1+\epsilon
\end{aligned}
\]</span> If <span class="math inline">\(r(\theta) &gt; 1+\epsilon,
r(\theta)=1+\epsilon\)</span>. If <span class="math inline">\(r(\theta)
&lt; 1-\epsilon, r(\theta) = 1-\epsilon\)</span>.</p>
<p>The CLIP objective ensures that the policy ratio <span
class="math inline">\(r(\theta)\)</span> does not deviate too far from 1
(the old policy), thereby limiting large updates to the policy. The term
<span class="math inline">\(J^{CLIP}(\theta)\)</span> takes the minimum
of the “unclipped” objective and the “clipped” version. This prevents
overly large policy updates by removing the lower bound when <span
class="math inline">\(r(\theta)\)</span> is outside the clipping
range.</p>
<p>The <strong>Proximal Policy Optimization (PPO)</strong> algorithm
(Paper: <a target="_blank" rel="noopener" href="https://arxiv.org/abs/1707.06347">Proximal Policy
Optimization Algorithms</a>) extends the CLIP objective by incorporating
additional terms for value function optimization and entropy
regularization. The full PPO objective is defined as: <span
class="math display">\[
J^{PPO}(\theta) = E[J^{CLIP}(\theta) - c_1(V_\theta(s)-V_{target})^2 +
c_2 H(s,\pi_\theta(\cdot))]
\]</span> where</p>
<ul>
<li><span class="math inline">\(-(V_\theta(s) - V_{target})^2\)</span>
is the negative mean squared error (MSE), which we aim to maximize. It
minimizes the difference between the predicted value function <span
class="math inline">\(V_\theta(s)\)</span> and the target value <span
class="math inline">\(V_{target}\)</span>. The coefficient <span
class="math inline">\(c_2\)</span> controls the tradeoff between policy
optimization and value function fitting.</li>
<li><span class="math inline">\(H(s,\pi_\theta(\cdot))\)</span>
represents the entropy of the policy. Maximizing entropy encourages
exploration by preventing premature convergence to deterministic
policies. The coefficient <span class="math inline">\(c_2\)</span>
determines the weight of this entropy term.</li>
</ul>
<p>Here is a pseudocode of PPO-Clip Algorithm (Source: <a
target="_blank" rel="noopener" href="https://spinningup.openai.com/en/latest/algorithms/ppo.html">OpenAI
Spinning Up - Proximal Policy Optimization</a>)</p>
<figure>
<img src="/di-blog/2024/12/29/Understanding-RLHF/ppo_clip_algo.png"
alt="ppo_clip_algo" />
<figcaption aria-hidden="true">ppo_clip_algo</figcaption>
</figure>
<h3 id="ppo-usage">PPO Usage</h3>
<h4 id="state-action-and-reward-in-the-context-of-llms"><strong>State,
Action, and Reward in the Context of LLMs</strong></h4>
<p>In the context of LLMs, the components of reinforcement learning are
defined as follows:</p>
<ol type="1">
<li><strong>State</strong>: The state corresponds to the <strong>input
prompt</strong> or context provided to the language model. It represents
the scenario or query that requires a response.</li>
<li><strong>Action</strong>: The action is the <strong>output</strong>
generated by the language model, i.e., the response or continuation of
text based on the given state (prompt).</li>
<li><strong>Reward</strong>: The reward is a scalar value that
quantifies how well the generated response aligns with human preferences
or task objectives. It is typically derived from a <strong>reward
model</strong> trained on human feedback.</li>
<li><strong>Policy</strong>: A policy refers to the strategy or function
that maps a given state (input prompt and context) to an action (the
next token or sequence of tokens to generate). The policy governs how
the LLM generates responses and is optimized to maximize a reward
signal, such as alignment with human preferences or task-specific
objectives.</li>
</ol>
<h4 id="steps-of-rlhf-using-ppo"><strong>Steps of RLHF Using
PPO</strong></h4>
<p>The RLHF process using PPO involves three main stages:</p>
<ol type="1">
<li><p><strong>Training a Reward Model</strong>: A reward model is
trained to predict human preferences based on labeled data. Human
annotators rank multiple responses for each prompt, and this ranking
data is used to train the reward model in a supervised manner. The
reward model learns to assign higher scores to responses that align
better with human preferences.</p></li>
<li><p><strong>Fine-Tuning the LLM with PPO</strong>: After training the
reward model, PPO is used to fine-tune the LLM. The steps are as
follows:</p>
<ol type="1">
<li><p><strong>Initialize Policies</strong>: Start with a pre-trained
LLM as both the <strong>policy model</strong> (actor) and optionally as
the critic for value estimation.</p>
<ul>
<li><p>The <strong>actor</strong> is the language model that generates
responses (actions) based on input prompts (states).</p>
<p>For example: Input: “Explain quantum mechanics.” Output: “Quantum
mechanics is a branch of physics that studies particles at atomic and
subatomic scales.”</p></li>
<li><p>The <strong>critic</strong> is typically implemented as a
<strong>value function</strong>, which predicts how good a particular
response (action) is in terms of achieving long-term objectives. This
model predicts a scalar value for each token or sequence, representing
its expected reward or usefulness.</p>
<p>For example:</p>
<p>Input: “Explain quantum mechanics.” → “Quantum mechanics is…” Output:
A value score indicating how well this response aligns with human
preferences or task objectives.</p></li>
<li><p>Both the actor and critic can be initialized from the same
pre-trained LLM weights to leverage shared knowledge from pretraining.
However, their roles diverge during fine-tuning: The actor focuses on
generating responses. The critic focuses on evaluating those
responses.</p></li>
</ul></li>
<li><p><strong>Collect Rollouts</strong>: Interact with the environment
by sampling prompts from a dataset. Generate responses (actions) using
the current policy. Compute rewards for these responses using the
trained reward model.</p></li>
<li><p><strong>Compute Advantage Estimates</strong>: Use rewards from
the reward model and value estimates from the critic to compute
advantages: <span class="math display">\[
\hat{A}(s, a) = R_t + \gamma V(s_{t+1}) - V(s_t),
\]</span> where $ R_t $ is the reward from the reward model.</p></li>
<li><p><strong>Optimize Policy with PPO Objective</strong>: Optimize the
policy using PPO's clipped surrogate objective: <span
class="math display">\[
J^{CLIP}(\theta) = \mathbb{E}\left[\min\left(r(\theta)\hat{A}(s, a),
\text{clip}(r(\theta), 1-\epsilon, 1+\epsilon)\hat{A}(s,
a)\right)\right],
\]</span> where $ r() = $ is the probability ratio between new and old
policies.</p></li>
<li><p><strong>Update Value Function</strong>: Simultaneously update the
value function by minimizing mean squared error between predicted values
and rewards: <span class="math display">\[
\mathcal{L}_{\text{value}} = \mathbb{E}\left[(V_\theta(s) -
R_t)^2\right].
\]</span></p></li>
<li><p><strong>Repeat</strong>: Iterate over multiple epochs until
convergence, ensuring stable updates by clipping policy
changes.</p></li>
</ol></li>
<li><p><strong>Evaluation</strong>: Evaluate the fine-tuned LLM on
unseen prompts to ensure it generates outputs aligned with human
preferences. Optionally, collect additional human feedback to further
refine both the reward model and policy.</p></li>
</ol>
<p>The following diagrams summarizes the high-level RLHF process with
PPO, from preference data creation, to training a reward model, and
using reward model in an RL loop to fine tune LLM.</p>
<figure>
<img src="/di-blog/2024/12/29/Understanding-RLHF/PPO_RLHF_flowchart.png"
alt="PPO_RLHF_flowchart" />
<figcaption aria-hidden="true">PPO_RLHF_flowchart</figcaption>
</figure>
<p>The following workflow chart illustrates the more detailed training
process of RLHF with PPO. (Source: <a
target="_blank" rel="noopener" href="https://arxiv.org/abs/2307.04964">Secrets of RLHF in Large
Language Models Part I: PPO</a>)</p>
<figure>
<img
src="/di-blog/2024/12/29/Understanding-RLHF/RLHF_training_realworld.png"
alt="RLHF_training_realworld" />
<figcaption aria-hidden="true">RLHF_training_realworld</figcaption>
</figure>
<h4 id="rlhf-training-tricks">RLHF Training Tricks</h4>
<p>There are practical challenges that arise during RLHF training. These
challenges stem from the inherent complexities of RL, especially when
applied to aligning LLMs with human preferences. Therefore, tricks are
essential for addressing the practical limitations of RLHF, ensuring the
training process remains efficient, stable, and aligned with human
preferences while minimizing the impact of inherent challenges in RL
systems. (Source: <a target="_blank" rel="noopener" href="https://arxiv.org/abs/2307.04964">Secrets of
RLHF in Large Language Models Part I: PPO</a>)</p>
<figure>
<img
src="/di-blog/2024/12/29/Understanding-RLHF/RLHF_training_tricks.png"
alt="RLHF_training_tricks" />
<figcaption aria-hidden="true">RLHF_training_tricks</figcaption>
</figure>
<h2 id="dpo">DPO</h2>
<h3 id="bradley-terry-and-plackett-luce-reward-model">Bradley-Terry and
Plackett-Luce Reward Model</h3>
<p>The <strong>Bradley-Terry (BT) model</strong> is a probabilistic
model used to compare pairwise preferences. It assumes that each item
(e.g., a response or completion) has an intrinsic quality score, and the
probability of one item being preferred over another depends on the
relative difference in their scores.</p>
<p>Mathematically, the probability of option <span
class="math inline">\(y_1\)</span> being preferred over option <span
class="math inline">\(y_2\)</span> is given by: <span
class="math display">\[
P(y_1 \succ y_2|x) = {\exp(r(x,y_1)) \over \exp(r(x,y_1)) +
\exp(r(x,y_2))}
\]</span> The loss of this reward model is <span class="math display">\[
L_R(r_{\phi},D) = -E_{(x,y_w,y_l)\sim D} \Big[\log
\sigma\Big(r_{\phi}(x,y_w) - r_{\phi}(x,y_l)\Big)\Big]
\]</span> However, the BT model has some limitations:</p>
<ul>
<li>It assumes transitivity in preferences (if <span
class="math inline">\(A&gt;B\)</span> and <span
class="math inline">\(B&gt;C\)</span>, then <span
class="math inline">\(A &gt;C\)</span>), which may not always hold in
real-world data.</li>
<li>It only handles pairwise comparisons and does not naturally extend
to rankings involving more than two items.</li>
</ul>
<p>The <strong>Plackett-Luce (PL) model</strong> generalizes the
Bradley-Terry model to handle rankings of multiple items, not just
pairwise comparisons. It models the probability of a ranking as a
sequence of choices. The first-ranked item is chosen based on its
relative worth compared to all other items. The second-ranked item is
chosen from the remaining items, and so on.</p>
<p>Mathematically, for a ranking <span class="math inline">\(i_1\succ
i_2 \succ ... \succ i_J\)</span>, the probability is given by: <span
class="math display">\[
P(i_1\succ i_2 \succ ... \succ i_J ) = \prod^j_{j=1}{\alpha_{i_j}\over
\sum^J_{k=j} \alpha_{i_k}}
\]</span> where <span class="math inline">\(\alpha_{i_j}\)</span> is the
worth or quality score of item <span class="math inline">\(i_j\)</span>.
The denominator normalizes over all remaining items at each step.</p>
<p>The PL model has several advantages over the BT model:</p>
<ul>
<li>Unlike BT, which only works with pairwise comparisons, PL can handle
rankings involving multiple items.</li>
<li>PL can accommodate partial rankings (e.g., ranking only the top n
items), making it more versatile in scenarios where full rankings are
unavailable.</li>
<li>When human feedback involves ranking multiple responses rather than
just picking one as better, PL captures this richer information better
than BT.</li>
</ul>
<h3 id="dpo-objective">DPO Objective</h3>
<p>The main reason why RLHF with PPO is hard is that it takes a lot of
redundant effort. Policy Model is all we need, all other efforts are not
necessary. <strong>DPO (Direct Preference Optimization)</strong> is a
novel alternative to traditional RLHF for fine-tuning LLMs. It
simplifies the RLHF process by eliminating the need for complex reward
models and RL algorithms. Instead, DPO reframes the problem of aligning
LLMs with human preferences as a classification problem using
human-labeled preference data.</p>
<p>The idea is DPO and difference between DPO and PPO are shown in the
figure below (Source: <a target="_blank" rel="noopener" href="https://arxiv.org/abs/2305.18290">Direct
Preference Optimization: Your Language Model is Secretly a Reward
Model</a>)</p>
<figure>
<img src="/di-blog/2024/12/29/Understanding-RLHF/DPO_idea.png"
alt="DPO_idea" />
<figcaption aria-hidden="true">DPO_idea</figcaption>
</figure>
<p>Recall the Bradley-Terry reward model: <span class="math display">\[
\begin{aligned}
P(y_1 \succ y_2|x) &amp;= {\exp(r(x,y_1)) \over \exp(r(x,y_1)) +
\exp(r(x,y_2))}\\
L_R(r_{\phi},D) &amp;= -E_{(x,y_w,y_l)\sim D} \Big[\log
\sigma\Big(r_{\phi}(x,y_w) - r_{\phi}(x,y_l)\Big)\Big]
\end{aligned}
\]</span> <strong>RLHF objective</strong> is defined as follows. Keep in
mind that no matter whether DPO or PPO is used, the objective is always
like this. <span class="math display">\[
\max_{\pi_\theta} E_{x \sim D, y \sim \pi_\theta(y|x)}\Big[r_{\phi}(x,y)
- \beta D_{KL}\big[\pi_\theta(y|x) || \pi_{ref}(y|x)\big]\Big]
\]</span> where <span class="math inline">\(\beta
D_{KL}\big[\pi_\theta(y|x) || \pi_{ref}(y|x)\big]\)</span> is a
regularization term. When applying RL to NLP, regularization is often
needed. Otherwise RL would explore every possible situation and find out
hidden tricks which deviate from a language model.</p>
<p>The optimal policy <span class="math inline">\(\pi_r(y|x)\)</span>
that maximizes the objective is <span class="math display">\[
\begin{aligned}
\pi_r(y|x) &amp;= {1\over Z(x)}\pi_{ref}(y|x)\exp\Big({1\over
\beta}r(x,y)\Big)\\
Z(x) &amp;= \sum_y \pi_{ref}(y|x) \exp\Big({1\over \beta}r(x,y)\Big)
\end{aligned}
\]</span> where <span class="math inline">\(\pi_r(y|x)\)</span> is a
probability distribution.</p>
<p>Based on this optimal policy, we can derive the reward function for
the optimal policy <span class="math display">\[
r(x,y)=\beta \log{\pi_r(y|x)\over \pi_{ref}(y|x)} + \beta \log Z(x)
\]</span> If we put this reward function in the Bradley-Terry model, we
obtain a probability of <span class="math inline">\(y_1\)</span> being
prefered to <span class="math inline">\(y_2\)</span>. <span
class="math display">\[
\begin{aligned}
P^*(y_1 \succ y_2|x) &amp;= {\exp^*(r(x,y_1)) \over \exp^*(r(x,y_1)) +
\exp^*(r(x,y_2))}\\
&amp;={\exp(\beta \log{\pi^*_r(y_1|x)\over \pi_{ref}(y_1|x)} + \beta
\log Z(x)) \over \exp(\beta \log{\pi^*_r(y_1|x)\over \pi_{ref}(y_1|x)} +
\beta \log Z(x)) + \exp(\beta \log{\pi^*_r(y_2|x)\over \pi_{ref}(y_2|x)}
+ \beta \log Z(x))}\\
&amp;={1\over 1+\exp\Big(\beta \log {\pi^*(y_2|x) \over
\pi_{ref}(y_2|x)} - \beta\log {\pi^*(y_1|x)\over
\pi_{ref}(y_1|x)}\Big)}\\
&amp;=\sigma\Big(\beta \log {\pi^*(y_1|x)\over \pi_{ref}(y_1|x)} - \beta
\log {\pi^*(y_2|x)\over \pi_{ref}(y_2|x)}\Big)\\
\end{aligned}
\]</span> With this probability, we have <strong>DPO's objective
function</strong> below. We can optimize this loss function by
<strong>Maximum Likelihood Extimation</strong>: <span
class="math display">\[
L_{DPO}(\pi_\theta; \pi_{ref}) = -E_{(x,y_w,y_l) \sim D} \Big[\log
\sigma \Big(\beta \log {\pi_{\theta}(y_w|x)\over \pi_{ref}(y_w|x)} -
\beta \log {\pi_{\theta}(y_l|x)\over \pi_{ref}(y_l|x)}\Big)\Big)\Big]
\]</span> <strong>Key Ideas of DPO Objective</strong>:</p>
<ul>
<li>DPO's objective aims to increase the likelihood of generating
preferred responses over less preferred ones. By focusing directly on
preference data, DPO eliminates the need to first fit a reward model
that predicts scalar rewards based on human preferences. This simplifies
the training pipeline and reduces computational overhead.</li>
<li>Value functions exist to help reduce the variance of the reward
model. In DPO, the value function is not involved because DPO does not
rely on a traditional RL framework, such as Actor-Critic methods.
Instead, DPO directly optimizes the policy using human preference data
as a <strong>classification task</strong>, skipping the intermediate
steps of training a reward model or estimating value functions.</li>
<li>DPO was originally designed to work with <strong>pairwise</strong>
preference data, however, recent advancements and adaptations have
extended its applicability to ranking preference data as well (e.g
RankDPO).</li>
</ul>
<p>DPO paper has provided detailed steps of deriving the gradient of the
DPO objective: (Source: <a
target="_blank" rel="noopener" href="https://arxiv.org/abs/2305.18290">Direct Preference Optimization:
Your Language Model is Secretly a Reward Model</a>)</p>
<figure>
<img
src="/di-blog/2024/12/29/Understanding-RLHF/dpo_gradients_derivation_paper.png"
alt="dpo_gradients_derivation_paper" />
<figcaption
aria-hidden="true">dpo_gradients_derivation_paper</figcaption>
</figure>
<p>The simplified version of the DPO gradient for better understanding
is written as follows. Intuitively, when the difference between <span
class="math inline">\(\hat{r}_{\theta}(x, y_l)\)</span> and <span
class="math inline">\(\hat{r}_{\theta}(x, y_w)\)</span> is large, the
gradient takes a larger step during optimization. Conversely, when the
difference is small, the objective is optimized with a smaller
adjustment.</p>
<figure>
<img
src="/di-blog/2024/12/29/Understanding-RLHF/DPO_gradient_simple_version.png"
alt="DPO_gradient_simple_version" />
<figcaption aria-hidden="true">DPO_gradient_simple_version</figcaption>
</figure>
<h3 id="dpo-usage">DPO Usage</h3>
<p>Here's how DPO is applied step by step:</p>
<p><strong>1. Initial Setup and Supervised Fine-Tuning (SFT)</strong>:
Begin by fine-tuning a pre-trained LLM using supervised learning on a
dataset that is representative of the tasks the model will perform. This
step ensures the model has a strong foundation in the relevant domain,
preparing it for preference-based optimization.</p>
<p><strong>2. Collect Preference Data</strong>: Gather human feedback in
the form of pairwise preferences or rankings. Annotators evaluate
responses generated by the model and indicate which ones they prefer.
Construct a dataset of prompts and corresponding preferred and
less-preferred responses.</p>
<p><strong>3. Iterative Rounds of DPO</strong></p>
<ul>
<li><p><strong>Sampling and Annotation</strong>: In each round, sample a
set of responses from the model for given prompts. Collect new
preference annotations based on these samples, allowing for dynamic
updates to the preference dataset. (Public preference data works as
well. Off-policy and on-policy data both work).</p></li>
<li><p><strong>Preference Optimization</strong>: Use DPO to adjust the
model's outputs based on collected preference data:</p></li>
<li><p><strong>Model Update</strong>: Fine-tune the model using this
loss function to increase the likelihood of generating preferred
responses.</p></li>
</ul>
<p><strong>4. Evaluation and Iteration</strong></p>
<ul>
<li><p><strong>Performance Assessment</strong>: After each round,
evaluate the model’s performance on new prompts to ensure it aligns with
human preferences. Use feedback from these evaluations to inform
subsequent rounds of sampling and optimization.</p></li>
<li><p><strong>Iterative Refinement</strong>: Continue this loop process
over multiple rounds, iteratively refining the model's alignment with
human preferences through continuous sampling and preference
optimization.</p></li>
</ul>
<h3 id="dpo-performance">DPO Performance</h3>
<p>(Source: <a target="_blank" rel="noopener" href="https://arxiv.org/abs/2305.18290">Direct Preference
Optimization: Your Language Model is Secretly a Reward Model</a>)</p>
<figure>
<img
src="/di-blog/2024/12/29/Understanding-RLHF/DPO_performance_paper.png"
alt="DPO_performance_paper" />
<figcaption aria-hidden="true">DPO_performance_paper</figcaption>
</figure>
<h3 id="dpo-objective-pseudocode">DPO Objective Pseudocode</h3>
<p><span class="math display">\[
L_{DPO}(\pi_\theta; \pi_{ref}) = -E_{(x,y_w,y_l) \sim D} \Big[\log
\sigma \Big(\beta \log {\pi_{\theta}(y_w|x)\over \pi_{ref}(y_w|x)} -
\beta \log {\pi_{\theta}(y_l|x)\over \pi_{ref}(y_l|x)}\Big)\Big)\Big]
\]</span></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> torch.nn.functional <span class="keyword">as</span> F</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">dpo_loss</span>(<span class="params">pi_logps, ref_logps, yw_idxs, yl_idxs, beta</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    pi_logps: policy logprobs, shape (B,)</span></span><br><span class="line"><span class="string">    ref_logps: reference model logprobs, shape (B,)</span></span><br><span class="line"><span class="string">    yw_idxs: preferred completion indices in [0, B-1], shape (T,)</span></span><br><span class="line"><span class="string">    yl_idxs: dispreferred completion indices in [0, B-1], shape (T,)</span></span><br><span class="line"><span class="string">    beta: temperature controlling strength of KL penalty</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    Each pair of (yw_idxs[i], yl_idxs[i]) represents the</span></span><br><span class="line"><span class="string">    indices of a single preference pair.</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">    pi_yw_logps, pi_yl_logps = pi_logps[yw_idxs], pi_logps[yl_idxs]</span><br><span class="line">    ref_yw_logps, ref_yl_logps = ref_logps[yw_idxs], ref_logps[yl_idxs]</span><br><span class="line"></span><br><span class="line">    pi_logratios = pi_yw_logps - pi_yl_logps</span><br><span class="line">    ref_logratios = ref_yw_logps - ref_yl_logps</span><br><span class="line"></span><br><span class="line">    losses = -F.logsigmoid(beta * (pi_logratios - ref_logratios))</span><br><span class="line">    rewards = beta * (pi_logps - ref_logps).detach()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> losses, rewards</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="dpo-variants">DPO Variants</h3>
<p>The key area of research involves developing variants of DPO and
conducting theoretical analyses to understand its limitations and
potential improvements. This includes exploring different loss functions
or optimization strategies that can be applied within the DPO
framework.</p>
<ul>
<li><p>One significant area of research focuses on refining the loss
function used in DPO. This includes exploring ways to eliminate the need
for a reference model, which can simplify the optimization process.</p>
<p>Examples:</p>
<ul>
<li><p><a target="_blank" rel="noopener" href="https://arxiv.org/abs/2403.07691">ORPO: Monolithic
Preference Optimization without Reference Model</a></p></li>
<li><p><a target="_blank" rel="noopener" href="https://arxiv.org/abs/2405.14734">SimPO: Simple
Preference Optimization with a Reference-Free Reward</a></p></li>
</ul></li>
<li><p>Another key direction involves leveraging existing supervised
fine-tuning data as preference data for DPO. This strategy aims to
enhance the quality of preference data by utilizing high-quality labeled
datasets that may already exist from previous SFT processes.</p>
<p>Examples:</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://arxiv.org/abs/2402.08005v1">Refined Direct
Preference Optimization with Synthetic Data for Behavioral Alignment of
LLMs</a></li>
</ul></li>
</ul>
<h2 id="main-difficulties-in-rlhf">Main Difficulties in RLHF</h2>
<h3 id="data-collection"><strong>Data Collection</strong></h3>
<p>In practice, people noticed that the collection of human feedback in
the form of the preference dataset is a slow manual process that needs
to be repeated whenever alignment criteria change. And there is
increasing difficulty in annotating preference data as models become
more advanced, particularly because distinguishing between outputs
becomes more nuanced and subjective.</p>
<ul>
<li>The paper “<a target="_blank" rel="noopener" href="https://arxiv.org/abs/2411.02481">CDR:
Customizable Density Ratios of Strong-over-weak LLMs for Preference
Annotation</a>” explains that as models become more advanced, it becomes
harder to identify which output is better due to subtle differences in
quality. This makes preference data annotation increasingly difficult
and subjective.</li>
<li>Another paper, “<a target="_blank" rel="noopener" href="https://arxiv.org/abs/2407.14916">Improving
Context-Aware Preference Modeling for Language Models</a>,” discusses
how the underspecified nature of natural language and multidimensional
criteria make direct preference feedback difficult to interpret. This
highlights the challenge of providing consistent annotations when
outputs are highly sophisticated and nuanced.</li>
<li>“<a target="_blank" rel="noopener" href="https://www.arxiv.org/abs/2408.12799">Less for More:
Enhancing Preference Learning in Generative Language Models</a>” also
notes that ambiguity among annotators leads to inconsistently annotated
datasets, which becomes a greater issue as model outputs grow more
complex.</li>
</ul>
<h3 id="reward-hacking"><strong>Reward Hacking</strong></h3>
<p>Reward hacking is a common problem in reinforcement learning, where
the agent learns to exploit the system by maximizing its reward through
actions that deviate from the intended goal. In the context of RLHF,
reward hacking occurs when training settles in an unintended region of
the loss landscape. In this scenario, the model generates responses that
achieve high reward scores, but these responses may fail to be
meaningful or useful to the user.</p>
<p>In PPO, reward hacking occurs when the model exploits flaws or
ambiguities in the <strong>reward model</strong> to achieve high rewards
without genuinely aligning with human intentions. This is because PPO
relies on a learned reward model to guide policy updates, and any
inaccuracies or biases in this model can lead to unintended behaviors
being rewarded. PPO is particularly vulnerable to reward hacking if the
reward model is not robustly designed or if it fails to capture the true
objectives of human feedback. The iterative nature of PPO, which
involves continuous policy updates based on reward signals, can
exacerbate this issue if not carefully managed.</p>
<p>DPO avoids explicit reward modeling by directly optimizing policy
based on preference data. However, it can still encounter issues similar
to reward hacking if the preference data is <strong>biased</strong> or
if the optimization process leads to <strong>overfitting</strong>
specific patterns in the data that do not generalize well. While DPO
does not suffer from reward hacking in the traditional sense (since it
lacks a separate reward model), it can still find biased solutions that
exploit <strong>out-of-distribution responses</strong> or deviate from
intended behavior due to distribution shifts between training and
deployment contexts.</p>
<ul>
<li>The article "<a
target="_blank" rel="noopener" href="https://lilianweng.github.io/posts/2024-11-28-reward-hacking/">Reward
Hacking in Reinforcement Learning</a>" by Lilian Weng discusses how
reward hacking occurs when a RL agent exploits flaws or ambiguities in
the reward function to achieve high rewards without genuinely learning
the intended task. It highlights that in RLHF for language models,
reward hacking is a critical challenge, as models might learn to exploit
unit tests or mimic biases to achieve high rewards, which can hinder
real-world deployment.</li>
<li>The research "<a target="_blank" rel="noopener" href="https://arxiv.org/abs/2210.10760">Scaling
Laws for Reward Model Overoptimization</a>" explores how optimizing
against reward models trained to predict human preferences can lead to
overoptimization, hindering the actual objective.
<ol type="1">
<li><strong>Impact of Policy Model Size</strong>: Holding the RM size
constant, experiments showed that larger policy models exhibited similar
overoptimization trends as smaller models, despite achieving higher
initial gold scores. This implies that their higher performance on gold
rewards does not lead to excessive optimization pressure on the RM.</li>
<li><strong>Relationship with RM Data Size</strong>: Data size had a
notable effect on RM performance and overoptimization. Models trained on
fewer than ~2,000 comparison labels showed near-chance performance, with
limited improvement in gold scores. Beyond this threshold, all RMs,
regardless of size, benefited from increased data, with larger RMs
showing greater improvements in gold rewards compared to smaller
ones.</li>
<li><strong>Scaling Laws for RM Parameters and Data Size</strong>:
Overoptimization patterns scaled smoothly with both RM parameter count
and data size. Larger RMs demonstrated better alignment with gold
rewards and less susceptibility to overoptimization when trained on
sufficient data, indicating improved robustness.</li>
<li><strong>Proxy vs. Gold Reward Trends</strong>: For small data sizes,
proxy reward scores deviated significantly from gold reward scores,
highlighting overoptimization risks. As data size increased, the gap
between proxy and gold rewards narrowed, reducing overoptimization
effects.</li>
</ol></li>
</ul>
<p>Note that the KL divergence term in the RLHF objective is intended to
prevent the policy from deviating too much from a reference model,
thereby maintaining stability during training. However, it does not
fully prevent reward hacking. Reward hacking occurs when an agent
exploits flaws or ambiguities in the reward model to achieve high
rewards without genuinely aligning with human intentions. The KL
divergence penalty does not correct these flaws in the reward model
itself, meaning that if the reward model is misaligned, the agent can
still find ways to exploit it. KL does not directly address whether the
actions align with the true objectives or desired outcomes.</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://jokerdii.github.io/di-blog/2024/12/26/Understanding-QLoRA/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/di-blog/images/avatar.gif">
      <meta itemprop="name" content="Di Zhen">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Di's Blog">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Di's Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/di-blog/2024/12/26/Understanding-QLoRA/" class="post-title-link" itemprop="url">Understanding QLoRA</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2024-12-26 17:05:05" itemprop="dateCreated datePublished" datetime="2024-12-26T17:05:05-05:00">2024-12-26</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>QLoRA is never as simple as a single line of code. Let's start from
the scaling law...</p>
<h2 id="neural-scaling-law">Neural Scaling Law</h2>
<p>In the context of LLMs, a <strong>scaling law</strong> refers to an
empirical relationship that describes how the performance of a model
changes as key resources—such as model size (number of parameters),
dataset size, and computational power—are scaled up or down. These laws
provide insights into how increasing these factors impacts model
accuracy, efficiency, and generalization capabilities.</p>
<figure>
<img
src="/di-blog/2024/12/26/Understanding-QLoRA/scalinglaw_3charts.png"
alt="scalinglaw_3charts" />
<figcaption aria-hidden="true">scalinglaw_3charts</figcaption>
</figure>
<p>Compute, dataset size, and model size are not independent of each
other. Data size and model size together determine compute. The paper
"<a target="_blank" rel="noopener" href="https://arxiv.org/abs/2403.05812v1">Algorithmic progress in
language models</a>" came up with a rule <span
class="math inline">\(C=6ND\)</span> where <span
class="math inline">\(C\)</span> is compute, <span
class="math inline">\(N\)</span> is model size, and <span
class="math inline">\(D\)</span> is data size.</p>
<p>According to the paper "<a
target="_blank" rel="noopener" href="https://arxiv.org/abs/2001.08361">Scaling Laws for Neural Language
Models</a>" and "<a target="_blank" rel="noopener" href="https://arxiv.org/abs/2203.15556">Training
Compute-Optimal Large Language Models</a>", below are the key takeaways
of scaling laws for LLMs:</p>
<ul>
<li><strong>Performance Improvement</strong>: Model performance often
improves predictably with increases in size, data, and compute,
typically following a power-law relationship.</li>
<li><strong>Diminishing Returns</strong>: Beyond certain thresholds, the
benefits of scaling diminish, meaning further increases in resources
yield smaller performance gains.</li>
<li><strong>Trade-offs</strong>: Effective scaling requires balancing
resources like model parameters and training data. For example, the
"Chinchilla scaling law" highlights that increasing data size can
sometimes yield better results than merely increasing model size in
compute-constrained settings.</li>
</ul>
<p>These observations are critical for LLM research:</p>
<ul>
<li><p><strong>Guidance for Optimization</strong>: Scaling laws help
researchers allocate resources efficiently and predict the outcomes of
scaling efforts, guiding both model design and training strategies. For
example, within fixed computational constraints and limited training
duration, scaling laws provide a principled approach to determining the
optimal model size that minimizes test loss.</p></li>
<li><p><strong>Predicting model performance</strong>: As demonstrated in
<a target="_blank" rel="noopener" href="https://cdn.openai.com/papers/gpt-4.pdf">GPT-4 Technical
Report</a>, by fitting the scaling law to the loss of smaller models,
the loss of a bigger model can be predicted accurately.</p>
<figure>
<img
src="/di-blog/2024/12/26/Understanding-QLoRA/gpt4_report_scalinglaw.png"
alt="gpt4_report_scalinglaw" />
<figcaption aria-hidden="true">gpt4_report_scalinglaw</figcaption>
</figure></li>
</ul>
<p>The scaling law overlooks a critical practical consideration, which
can lead to misconceptions. While it suggests that larger models yield
better performance, <strong>in reality, the primary compute bottleneck
lies in inference rather than</strong> training. Training compute is
often less constrained because training time can be extended, but
deployment costs are significantly higher. From a practical standpoint,
a more efficient approach is to train a smaller model for an extended
period, as this substantially reduces inference compute
requirements.</p>
<h2 id="quantization">Quantization</h2>
<h3 id="background">Background</h3>
<p>As the scaling law suggested, when training a LLM, reducing the
number of parameters is probably not an optimal idea for saving
computational resource. Luckily, <strong>neural nets are robust in low
precision</strong>, which means lowering precision won't reduce much
model performance.</p>
<p>In <a
target="_blank" rel="noopener" href="https://www.youtube.com/watch?v=Y2F8yisiS6E&amp;t=2604s&amp;ab_channel=NVIDIA">GTC
March 2024 Keynote with NVIDIA CEO Jensen Huang</a>, Jensen stated that
NVIDIA has achieved 1000X increase compute power for the past 8 years,
faster than Moore’s law. It can be noticed that in the graph they show
TFLOPs on FP8 precision in 2022 and TFLOPs on FP4 precision in 2024.
This is a trick because it's easier to achieve higher TFLOPs when the
precision is lower. And it shows that there is a trend in hardware
industry to achieve higher TFLOPs in low precision.</p>
<figure>
<img src="/di-blog/2024/12/26/Understanding-QLoRA/nvidia_moorelaw.png"
alt="nvidia_moorelaw" />
<figcaption aria-hidden="true">nvidia_moorelaw</figcaption>
</figure>
<h3 id="data-structure---fp32">Data Structure - FP32</h3>
<p>The <strong>IEEE 754 single-precision floating-point format
(FP32)</strong> represents a 32-bit number in binary form. It is used
for approximating real numbers. The FP32 format has three
components:</p>
<ol type="1">
<li><strong>Sign bit (1 bit):</strong> Indicates whether the number is
positive (<code>0</code>) or negative (<code>1</code>).</li>
<li><strong>Exponent (8 bits):</strong> Encodes the exponent, biased by
127 to allow both positive and negative exponents.</li>
<li><strong>Mantissa or Fraction (23 bits):</strong> Represents the
significant digits of the number.</li>
</ol>
<p>The formula for FP32 is as follows: <span class="math display">\[
\text{Value} = (-1)^{\text{Sign}} \times (1.\text{Mantissa}) \times
2^{\text{Exponent}-127}
\]</span> Following this formula, we can calculate FP32 number. Below is
an example:</p>
<figure>
<img src="/di-blog/2024/12/26/Understanding-QLoRA/fp32_example.png"
alt="fp32_example" />
<figcaption aria-hidden="true">fp32_example</figcaption>
</figure>
<p>FP32 provides a wider range and higher precision, making it suitable
for tasks requiring numerical accuracy, such as training large-scale
deep learning models. FP16, with its lower precision, is optimized for
speed and memory efficiency. It is particularly effective for inference
tasks or mixed-precision training when paired with FP32 for critical
calculations.</p>
<p>However, the <strong>overflow problem of FP16</strong> arises due to
its limited range of representable values. FP16 has a maximum
representable value of 65,504 (<span class="math inline">\(2^{15} \times
(2 - \epsilon)\)</span>), which is much smaller compared to FP32's
maximum value of approximately <span class="math inline">\(3.4 \times
10^{38}\)</span>. When computations produce results exceeding this
range, an <strong>overflow</strong> occurs, and the value is replaced by
infinity (<span class="math inline">\(\pm \infty\)</span>). Overflow in
FP16 can occur during operations like matrix multiplications or
summations in deep learning if the intermediate values exceed the
maximum representable range. For example, scaling large tensors or
performing high-magnitude computations without normalization can easily
result in overflow when using FP16. Overflow leads to loss of numerical
accuracy and can destabilize training processes in machine learning. It
also affects applications like image processing or scientific
simulations where precision and stability are critical.</p>
<p>There are some strategies to mitigate this overflow problem:</p>
<ul>
<li>Use <strong>mixed-precision training</strong>. FP16 is used for most
computations but critical operations (e.g., gradient accumulation) are
performed in FP32 to prevent overflow.</li>
<li>Normalize inputs and intermediate values to keep them within the
representable range of FP16.</li>
<li>Use alternative formats like <strong>BF16</strong>, which have a
larger dynamic range while maintaining reduced precision.</li>
</ul>
<p><strong>Googel Brain BF16</strong> uses the same number of exponent
bits as FP32 (8 bits), giving it a much larger dynamic range compared to
FP16. This means BF16 can represent very large and very small numbers
similar to FP32, avoiding underflows and overflows that are common in
FP16. Converting from FP32 to BF16 is straightforward because both
formats share the same exponent size. The conversion simply involves
truncating the mantissa from 23 bits to 7 bits. BF16 uses only 16 bits
per value, reducing memory usage by half compared to FP32. This allows
for larger batch sizes and models to fit into limited GPU or TPU memory
without sacrificing as much numerical range as FP16 does.</p>
<p>Recently, people have started discussing <strong>NVIDIA’s FP8 formats
(E4M3 and E5M2)</strong> as alternatives to BF16 because of their
potential to significantly reduce computational and memory costs while
maintaining competitive performance in large-scale machine learning
tasks. E4M3 offers higher precision, making it suitable for
<strong>inference</strong> and <strong>forward-pass
computations</strong> where precision is critical. E5M2 provides a wider
dynamic range, making it ideal for <strong>backward-pass
computations</strong> during training where large gradients can occur.
This flexibility allows FP8 to adapt to different stages of training
more effectively than BF16.</p>
<p>NVIDIA’s H100 GPUs are specifically designed to support FP8 with
optimized Tensor Cores, achieving up to 9x faster training and 30x
faster inference compared to previous-generation GPUs using FP16 or
BF16. The Hopper architecture dynamically manages precision transitions
(e.g., between FP8 and higher-precision formats like FP32), ensuring
stability without manual intervention. "<a
target="_blank" rel="noopener" href="https://arxiv.org/abs/2411.08719?t">Balancing Speed and Stability:
The Trade-offs of FP8 vs. BF16 Training in LLMs</a>" shows that FP8 can
deliver similar convergence behavior and accuracy as BF16 in many LLM
tasks, with minimal degradation in performance. For inference, FP8
quantization (e.g., <a
target="_blank" rel="noopener" href="https://docs.vllm.ai/en/v0.4.2/quantization/fp8_e4m3_kvcache.html">E4M3
for KV cache</a>) has been shown to minimally impact accuracy while
significantly improving memory efficiency.</p>
<p>However, FP8 comes with challenges such as occasional instability
during training (e.g., loss spikes) and sensitivity in certain tasks
like code generation or mathematical reasoning. As a result, training
LLMs with FP8 precision remains an active area of research and
exploration.</p>
<figure>
<img
src="/di-blog/2024/12/26/Understanding-QLoRA/summary_5_precision.png"
alt="summary_5_precision" />
<figcaption aria-hidden="true">summary_5_precision</figcaption>
</figure>
<table>
<colgroup>
<col style="width: 8%" />
<col style="width: 19%" />
<col style="width: 18%" />
<col style="width: 19%" />
<col style="width: 17%" />
<col style="width: 18%" />
</colgroup>
<thead>
<tr>
<th><strong>Feature</strong></th>
<th><strong>IEEE 754 FP32</strong></th>
<th><strong>IEEE 754 FP16</strong></th>
<th><strong>Google BF16</strong></th>
<th><strong>NVIDIA FP8 E4M3</strong></th>
<th><strong>NVIDIA FP8 E5M2</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Bit Width</strong></td>
<td>32 bits</td>
<td>16 bits</td>
<td>16 bits</td>
<td>8 bits</td>
<td>8 bits</td>
</tr>
<tr>
<td><strong>Sign Bit</strong></td>
<td>1 bit</td>
<td>1 bit</td>
<td>1 bit</td>
<td>1 bit</td>
<td>1 bit</td>
</tr>
<tr>
<td><strong>Exponent Bits</strong></td>
<td>8 bits (bias = 127)</td>
<td>5 bits (bias = 15)</td>
<td>8 bits (bias = 127)</td>
<td>4 bits (bias = 7)</td>
<td>5 bits (bias = 15)</td>
</tr>
<tr>
<td><strong>Mantissa Bits</strong></td>
<td>23 bits</td>
<td>10 bits</td>
<td>7 bits</td>
<td>3 bits</td>
<td>2 bits</td>
</tr>
<tr>
<td><strong>Dynamic Range</strong></td>
<td><span class="math display">\[ \pm(2^{-126} \text{ to } 2^{127})
\]</span></td>
<td><span class="math display">\[ \pm(2^{-14} \text{ to } 2^{15})
\]</span></td>
<td><span class="math display">\[ \pm(2^{-126} \text{ to } 2^{127})
\]</span></td>
<td><span class="math display">\[ \pm(2^{-6} \text{ to } 2^{7})
\]</span></td>
<td><span class="math display">\[ \pm(2^{-14} \text{ to } 2^{15})
\]</span></td>
</tr>
<tr>
<td><strong>Precision</strong></td>
<td>~7 decimal digits</td>
<td>~3.3 decimal digits</td>
<td>~2.3 decimal digits</td>
<td>Lower precision</td>
<td>Lower precision</td>
</tr>
<tr>
<td><strong>Memory Usage</strong></td>
<td>High</td>
<td>Medium</td>
<td>Medium</td>
<td>Low</td>
<td>Low</td>
</tr>
<tr>
<td><strong>Performance</strong></td>
<td>Slower</td>
<td>Faster than FP32</td>
<td>Faster than FP32</td>
<td>Much faster than FP16/BF16</td>
<td>Much faster than FP16/BF16</td>
</tr>
<tr>
<td><strong>Applications</strong></td>
<td>Training requiring high precision</td>
<td>Inference or mixed-precision training</td>
<td>Mixed-precision training and inference</td>
<td>Optimized for inference</td>
<td>Optimized for training and inference</td>
</tr>
</tbody>
</table>
<h3 id="current-llm-training-method-in-fp8">Current LLM Training Method
in FP8</h3>
<p>A <a
target="_blank" rel="noopener" href="https://developer.nvidia.com/zh-cn/blog/nvidia-gpu-fp8-training-inference/">training
approach</a> has been developed to leverage FP8's efficiency for
specific operations while maintaining numerical stability and precision
with BF16 for critical components of the model.</p>
<p>During the training process, <strong>FP8</strong> is utilized
exclusively for computations within the MLP layers, while
<strong>BF16</strong> is employed for other components of the
Transformer architecture, such as Attention, Activation, and Layer
Normalization. Both weights and gradients are maintained in BF16
precision.</p>
<ul>
<li><p>In the forward pass, weights in BF16 are converted to FP8 (E4M3)
for matrix multiplications within the MLP layers. Once the computation
is completed, the results are immediately converted back to
BF16.</p></li>
<li><p>In the backward pass, gradients in BF16 are temporarily converted
to FP8 (E5M2) when passing through the MLP layers. After the
computations are performed, the results are promptly converted back to
BF16.</p></li>
</ul>
<figure>
<img
src="/di-blog/2024/12/26/Understanding-QLoRA/fp8_transformer_current.png"
alt="fp8_transformer_current" />
<figcaption aria-hidden="true">fp8_transformer_current</figcaption>
</figure>
<p>Even when FP8 is used, RAM savings may not be as significant during
training because high precision gradients and weights must be maintained
in memory to ensure model stability and convergence. The primary benefit
of FP8 lies in its ability to reduce memory usage during inference,
where weights can be stored in FP8 format, significantly decreasing the
memory footprint compared to higher precision formats like FP16 or BF16.
Despite this, FP8 is still utilized during training because it allows
for faster computations due to its lower precision. This results in
accelerated training processes and improved efficiency, especially on
hardware optimized for FP8 operations, such as NVIDIA’s H100 GPUs.</p>
<h3 id="quantization-process">Quantization Process</h3>
<p>The process of quantization in LLMs refers to a model compression
technique that maps high-precision values (e.g., FP32) to
lower-precision representations (e.g., INT8 or FP8).</p>
<p>Here is an example of a simple step-by-step quantization from FP16 to
INT4:</p>
<ol type="1">
<li><p><strong>Range Calculation</strong>: Determine the range of FP16
values for the weights or activations. This is typically defined by the
minimum and maximum values (<span class="math inline">\([min,
max]\)</span>) in the data.</p></li>
<li><p><strong>Scale Factor and Zero-Point Computation</strong>: Compute
a <strong>scaling factor (S)</strong> that maps the FP16 range to the
INT4 range (<span class="math inline">\([-8, 7]\)</span> for signed INT4
or <span class="math inline">\([0, 15]\)</span> for unsigned INT4).
Optionally, calculate a <strong>zero-point (Z)</strong> to handle
asymmetric quantization, where zero in FP16 does not align with zero in
INT4.</p>
<p>The formula for quantization is: <span class="math display">\[
x_q = \text{round}\left(\frac{x}{S} + Z\right)
\]</span> where <span class="math inline">\(x_q\)</span> is the
quantized INT4 value, <span class="math inline">\(x\)</span> is the
original FP16 value, <span class="math inline">\(S\)</span> is the
scaling factor, and <span class="math inline">\(Z\)</span> is the
zero-point.</p></li>
<li><p><strong>Quantization</strong>: Map each FP16 value to its
corresponding INT4 representation using the computed scale factor and
zero-point. This step reduces precision but compresses the data
significantly.</p></li>
</ol>
<p>There are different types of quantization:</p>
<ul>
<li>Asymmetric Quantization vs Summetric Quantization</li>
<li>Uniform Quantization vs Non-uniform Quantization</li>
</ul>
<h3 id="quant-in-general-matrix-multiply-gemm">Quant in General Matrix
Multiply (GEMM)</h3>
<p>Quantized matrices are stored in memory in their compressed form.
During matrix multiplication, these matrices are dequantized back to
higher precision (e.g., FP16 or FP32) to perform computations. This
process balances memory efficiency with computational precision.</p>
<p>Quantization can be applied at different levels of granularity, which
determines how scaling factors are assigned and used. The "<a
target="_blank" rel="noopener" href="https://arxiv.org/abs/2211.10438">SmoothQuant: Accurate and
Efficient Post-Training Quantization for Large Language Models</a>"
paper introduced several quantization granularity techniques, including
per-tensor quantization, per-token quantization, and per-channel
quantization:</p>
<ol type="1">
<li><strong>Per-Tensor Quantization</strong>: A single scaling factor is
applied to the entire tensor (e.g., a weight matrix or activation
matrix). It is highly memory-efficient since only one scaling factor
needs to be stored. But it is not recommended in practice because
outlier values can dominate the scaling factor, leading to significant
quantization errors for the rest of the tensor.</li>
<li><strong>Per-Channel Quantization</strong>: Each channel (e.g., each
column of a weight matrix or each feature map in activations) has its
own scaling factor. Commonly used for weight matrices in neural
networks. It mitigates the impact of outliers by isolating them within
individual channels, improving quantization accuracy compared to
per-tensor methods. But it can introduce computational overhead during
dequantization due to the need for multiple scaling factors.</li>
<li><strong>Per-Token Quantization</strong>: Each token's activations
are assigned a unique scaling factor. Typically used for activations in
transformer models. It captures token-specific variations in
activations, leading to better precision for tasks with dynamic token
distributions. Per-token quantization can be computationally expensive
and slower because it requires more scaling factors and additional
computations.</li>
<li><strong>Group-Wise Quantization (GWQ)</strong>: this method groups
multiple channels or tokens together and applies a shared scaling factor
across the group. It reduces computational overhead compared to
per-channel or per-token quantization while maintaining finer
granularity than per-tensor methods. It's often used for both weights
and activations to strike a balance between accuracy and
efficiency.</li>
</ol>
<figure>
<img src="/di-blog/2024/12/26/Understanding-QLoRA/quant_granularity.png"
alt="quant_granularity" />
<figcaption aria-hidden="true">quant_granularity</figcaption>
</figure>
<h2 id="qlora">QLoRA</h2>
<h3 id="fine-tuning-cost">Fine-Tuning Cost</h3>
<p>Comparing cost of full fine tuning, LoRA fine tuning, and QLoRA fine
tuning:</p>
<figure>
<img src="/di-blog/2024/12/26/Understanding-QLoRA/finetune_cost.png"
alt="finetune_cost" />
<figcaption aria-hidden="true">finetune_cost</figcaption>
</figure>
<table style="width:100%;">
<colgroup>
<col style="width: 18%" />
<col style="width: 25%" />
<col style="width: 28%" />
<col style="width: 27%" />
</colgroup>
<thead>
<tr>
<th></th>
<th>Full Finetuning</th>
<th>LoRA</th>
<th>QLoRA</th>
</tr>
</thead>
<tbody>
<tr>
<td>Weight</td>
<td>16 bits</td>
<td>16 bits</td>
<td><strong>4 bits</strong></td>
</tr>
<tr>
<td>Weight Gradient</td>
<td>16 bits</td>
<td>~0.4 bits</td>
<td>~0.4 bits</td>
</tr>
<tr>
<td>Optimizer stage</td>
<td>64 bits</td>
<td>~0.8 bits</td>
<td>~0.8 bits</td>
</tr>
<tr>
<td>Adapter weights</td>
<td>/</td>
<td>~0.4 bits</td>
<td>~0.4 bits</td>
</tr>
<tr>
<td>Totel</td>
<td>96 bits per parameter</td>
<td>17.6 bits per parameter</td>
<td>5.2 bits per parameter</td>
</tr>
</tbody>
</table>
<h3 id="qloras-contributions">QLoRA's Contributions</h3>
<p>Paper: <a target="_blank" rel="noopener" href="https://arxiv.org/abs/2305.14314">QLoRA: Efficient
Finetuning of Quantized LLMs</a></p>
<h4 id="bit-normalfloat-quantitzation"><strong>4-bit NormalFloat
Quantitzation</strong></h4>
<p>4-bit NormalFloat Quantitzation adopts the idea of <strong>Quantile
Quantization</strong> which is an information-theoretic method that maps
values based on quantiles of the weight distribution. It's a method of
data compression where data is quantized (reduced to a smaller set of
discrete values) in a way that aims to minimize the information entropy
of the resulting data, essentially achieving the most efficient
representation possible while still introducing some loss in
information, making it a "<strong>lossy minimum entropy
encoding</strong>" technique.</p>
<p>To compute the <strong>quantile function</strong> for 4-bit
NormalFloat (NF4) quantization, the process involves mapping cumulative
probabilities to quantization levels optimized for normally distributed
data. The <strong>quantile function</strong> is the inverse of the
cumulative distribution function (CDF). For example, as shown in the
description, if the probability of <span class="math inline">\(x &lt;
1.2\)</span> is 0.9, then 1.2 is the corresponding quantile for a
cumulative probability of 0.9.</p>
<figure>
<img src="/di-blog/2024/12/26/Understanding-QLoRA/quantile_function.png"
alt="quantile_function" />
<figcaption aria-hidden="true">quantile_function</figcaption>
</figure>
<p>With this quantile function, the probability range from 0 to 1 is
divided into <strong>16 equal-sized buckets</strong>, as 4 bits can
represent <span class="math inline">\(2^4 = 16\)</span> distinct values.
The steps are as follows:</p>
<ol type="1">
<li><strong>Divide the Probability Range</strong>: The range of
cumulative probabilities <span class="math inline">\([0, 1]\)</span> is
divided into 16 equal intervals or "buckets." These intervals represent
equal portions of the probability mass.</li>
<li><strong>Apply the Quantile Function</strong>: For each bucket's
cumulative probability value (e.g., <span class="math inline">\(p_i =
\frac{i}{16}\)</span>, where <span class="math inline">\(i \in [1,
15]\)</span>), the corresponding quantile value is computed using the
inverse CDF of a standard normal distribution (<span
class="math inline">\(\Phi^{-1}(p_i)\)</span>).</li>
<li><strong>Normalize Quantiles</strong>: The resulting quantiles are
normalized to fit within a predefined range, typically <span
class="math inline">\([-1, 1]\)</span>. This ensures that all
quantization levels are symmetrically distributed around zero and fall
within a compact range suitable for efficient representation.</li>
<li><strong>Assign NF4 Values</strong>: The normalized quantiles become
the 16 discrete values used by NF4 to represent weights or activations
in a compressed format. These values are spaced closer together near
zero (where most of the normal distribution's probability mass lies) and
farther apart at the extremes, optimizing precision where it matters
most.</li>
</ol>
<h4 id="double-quantization">Double Quantization</h4>
<p>Double Quantization (DQ) as introduced in paper "<a
target="_blank" rel="noopener" href="https://arxiv.org/abs/2305.14314">QLoRA: Efficient Finetuning of
Quantized LLMs</a>" is a memory optimization technique that quantizes
the quantization constants themselves to further reduce the memory
footprint of LLMs. It involves two quantization steps:</p>
<ol type="1">
<li><p>The first quantization involves quantizing the original weights
of the model into <strong>4-bit NormalFloat (NF4) format</strong>.
Weights are divided into small blocks (e.g., <strong>64</strong>
elements per block), and each block is scaled by a <strong>quantization
constant</strong> (also known as a scaling factor). This constant
ensures that the range of values in each block fits within the
representable range of NF4. The quantized weights and their
corresponding quantization constants are stored. However, these
constants (usually in <strong>FP32</strong>) can add significant memory
overhead.</p>
<p><strong>To calculate the memory overhead</strong>: for a block size
of 64, storing a 32 bit quantization constant for each block adds <span
class="math inline">\(32/64=0.5\)</span> bits per parameter on
average.</p></li>
<li><p>The second quantization aims to reduce the memory overhead caused
by storing quantization constants. Those quantization constants <span
class="math inline">\(c^{FP32}_2\)</span> are further quantized into
<strong>8-bit floating-point values (FP8)</strong> with a larger block
size (e.g., <strong>256</strong> elements per block). This is a
<strong>summetric quantization</strong> where the mean of the first
level factors <span class="math inline">\(c^{FP32}_2\)</span> is
subtracted to center their distribution around zero. This reduces their
memory footprint while maintaining sufficient precision for scaling
operations. Additionally, another set of quantization constants <span
class="math inline">\(c^{FP32}_1\)</span> is introduced to scale these
second-level quantized values.</p>
<p><strong>To calculate the memory savings</strong>: after double
quantization, the memory footprint per parameter for scaling factors is
reduced from <span class="math inline">\(32/64=0.5\)</span> bits to
<span class="math inline">\(8/64 + 32/(64\times 256)=0.127\)</span> bits
per parameter. This results in saving <span
class="math inline">\(0.5-0.127=0.373\)</span> bits per
parameter.</p></li>
</ol>
<figure>
<img src="/di-blog/2024/12/26/Understanding-QLoRA/double_quant.png"
alt="double_quant" />
<figcaption aria-hidden="true">double_quant</figcaption>
</figure>
<p>The authors of paper "<a
target="_blank" rel="noopener" href="https://arxiv.org/abs/2305.14314">QLoRA: Efficient Finetuning of
Quantized LLMs</a>" compared LLaMA models with different 4-bit data
types. They show that the NormalFloat data type significantly improves
the bit-for-bit accuracy gains compared to regular 4-bit Floats. While
Double Quantization only leads to minor gains, it allows for a more
fine-grained control over the memory footprint to fit models of certain
size (33B/65B) into certain GPUs (24/48GB). This empirical results show
that using FP8 for second-level quantization does not degrade model
performance, making it an effective trade-off between precision and
memory efficiency.</p>
<figure>
<img
src="/di-blog/2024/12/26/Understanding-QLoRA/nf4_compare_result.png"
alt="nf4_compare_result" />
<figcaption aria-hidden="true">nf4_compare_result</figcaption>
</figure>
<h4 id="paged-optimizers">Paged Optimizers</h4>
<p>As described in the QLoRA paper, paged optimizers are a memory
management innovation that leverages <strong>NVIDIA Unified
Memory</strong> to handle the memory spikes that occur during gradient
checkpointing or when processing large mini-batches with long sequence
lengths. NVIDIA Unified Memory allows seamless memory sharing between
the GPU and CPU. When the GPU runs out of memory during training,
optimizer states (e.g., gradients, momentum, or scaling factors) are
<strong>paged out</strong> (evicted) to CPU RAM. These states are
<strong>paged back</strong> into GPU memory only when needed for
computations like gradient updates.</p>
<h3 id="forward-and-backward-implementation">Forward and Backward
Implementation</h3>
<p>Forward:</p>
<figure>
<img src="/di-blog/2024/12/26/Understanding-QLoRA/qlora_forward.png"
alt="qlora_forward" />
<figcaption aria-hidden="true">qlora_forward</figcaption>
</figure>
<p>Backward:</p>
<figure>
<img src="/di-blog/2024/12/26/Understanding-QLoRA/qlora_backward.png"
alt="qlora_backward" />
<figcaption aria-hidden="true">qlora_backward</figcaption>
</figure>
<h3 id="qlora-usage">QLora Usage</h3>
<p>QLoRA utilizes <a
target="_blank" rel="noopener" href="https://github.com/TimDettmers/bitsandbytes">bitsandbytes</a> for
quantization and is seamlessly integrated with Hugging Face's <a
target="_blank" rel="noopener" href="https://github.com/huggingface/peft">PEFT</a> and <a
target="_blank" rel="noopener" href="https://github.com/huggingface/transformers/">transformers</a>
libraries, making it user-friendly. To explore the implementation
further, let's dive into the <a
target="_blank" rel="noopener" href="https://github.com/artidoro/qlora/tree/main">QLoRA code</a> and
examine the <a
target="_blank" rel="noopener" href="https://github.com/artidoro/qlora/blob/main/qlora.py#L688"><code>train()</code></a>
function in <a
target="_blank" rel="noopener" href="https://github.com/artidoro/qlora/blob/main/qlora.py"><code>qlora.py</code></a>.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">train</span>():</span><br><span class="line">    hfparser = transformers.HfArgumentParser((</span><br><span class="line">        ModelArguments, DataArguments, TrainingArguments, GenerationArguments</span><br><span class="line">    ))</span><br><span class="line">    model_args, data_args, training_args, generation_args, extra_args = \</span><br><span class="line">        hfparser.parse_args_into_dataclasses(return_remaining_strings=<span class="literal">True</span>)</span><br><span class="line">    training_args.generation_config = transformers.GenerationConfig(**<span class="built_in">vars</span>(generation_args))</span><br><span class="line">    args = argparse.Namespace(</span><br><span class="line">        **<span class="built_in">vars</span>(model_args), **<span class="built_in">vars</span>(data_args), **<span class="built_in">vars</span>(training_args)</span><br><span class="line">    )</span><br><span class="line">    <span class="built_in">print</span>(args)</span><br><span class="line">    </span><br><span class="line">    checkpoint_dir, completed_training = get_last_checkpoint(args.output_dir)</span><br><span class="line">    <span class="keyword">if</span> completed_training:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;Detected that training was already completed!&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    model, tokenizer = get_accelerate_model(args, checkpoint_dir)</span><br><span class="line"></span><br><span class="line">    ......</span><br></pre></td></tr></table></figure>
<p>The <a
target="_blank" rel="noopener" href="https://github.com/artidoro/qlora/blob/main/qlora.py#L289"><code>get_accelerate_model()</code></a>
function initializes your model and is a crucial component of
implementing QLoRA. Notably, within the
<code>AutoModelForCausalLM.from_pretrained()</code> method, it loads the
quantization configuration through <code>BitsAndBytesConfig</code>. This
setup ensures that the model weights are automatically quantized.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">get_accelerate_model</span>(<span class="params">args, checkpoint_dir</span>):</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> torch.cuda.is_available():</span><br><span class="line">        n_gpus = torch.cuda.device_count()</span><br><span class="line">    <span class="keyword">if</span> is_ipex_available() <span class="keyword">and</span> torch.xpu.is_available():</span><br><span class="line">        n_gpus = torch.xpu.device_count()</span><br><span class="line">        </span><br><span class="line">    max_memory = <span class="string">f&#x27;<span class="subst">&#123;args.max_memory_MB&#125;</span>MB&#x27;</span></span><br><span class="line">    max_memory = &#123;i: max_memory <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n_gpus)&#125;</span><br><span class="line">    device_map = <span class="string">&quot;auto&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># if we are in a distributed setting, we need to set the device map and max memory per device</span></span><br><span class="line">    <span class="keyword">if</span> os.environ.get(<span class="string">&#x27;LOCAL_RANK&#x27;</span>) <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">        local_rank = <span class="built_in">int</span>(os.environ.get(<span class="string">&#x27;LOCAL_RANK&#x27;</span>, <span class="string">&#x27;0&#x27;</span>))</span><br><span class="line">        device_map = &#123;<span class="string">&#x27;&#x27;</span>: local_rank&#125;</span><br><span class="line">        max_memory = &#123;<span class="string">&#x27;&#x27;</span>: max_memory[local_rank]&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> args.full_finetune: <span class="keyword">assert</span> args.bits <span class="keyword">in</span> [<span class="number">16</span>, <span class="number">32</span>]</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&#x27;loading base model <span class="subst">&#123;args.model_name_or_path&#125;</span>...&#x27;</span>)</span><br><span class="line">    compute_dtype = (torch.float16 <span class="keyword">if</span> args.fp16 <span class="keyword">else</span> (torch.bfloat16 <span class="keyword">if</span> args.bf16 <span class="keyword">else</span> torch.float32))</span><br><span class="line">    model = AutoModelForCausalLM.from_pretrained(</span><br><span class="line">        args.model_name_or_path,</span><br><span class="line">        cache_dir=args.cache_dir,</span><br><span class="line">        load_in_4bit=args.bits == <span class="number">4</span>,</span><br><span class="line">        load_in_8bit=args.bits == <span class="number">8</span>,</span><br><span class="line">        device_map=device_map,</span><br><span class="line">        max_memory=max_memory,</span><br><span class="line">        quantization_config=BitsAndBytesConfig(</span><br><span class="line">            load_in_4bit=args.bits == <span class="number">4</span>,</span><br><span class="line">            load_in_8bit=args.bits == <span class="number">8</span>,</span><br><span class="line">            llm_int8_threshold=<span class="number">6.0</span>,</span><br><span class="line">            llm_int8_has_fp16_weight=<span class="literal">False</span>,</span><br><span class="line">            bnb_4bit_compute_dtype=compute_dtype,</span><br><span class="line">            bnb_4bit_use_double_quant=args.double_quant,</span><br><span class="line">            bnb_4bit_quant_type=args.quant_type,</span><br><span class="line">        ),</span><br><span class="line">        torch_dtype=(torch.float32 <span class="keyword">if</span> args.fp16 <span class="keyword">else</span> (torch.bfloat16 <span class="keyword">if</span> args.bf16 <span class="keyword">else</span> torch.float32)),</span><br><span class="line">        trust_remote_code=args.trust_remote_code,</span><br><span class="line">        use_auth_token=args.use_auth_token</span><br><span class="line">    )</span><br><span class="line">    ......</span><br></pre></td></tr></table></figure>
<p>Other than some necessary components like tokenizer,
<code>train()</code> gives an option of LoRA in addition to full
finetune. It requires setup of LoRA config and
<code>get_peft_model</code> function from <code>peft</code> package.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">train</span>():</span><br><span class="line">    ......</span><br><span class="line">  <span class="keyword">if</span> <span class="keyword">not</span> args.full_finetune:</span><br><span class="line">          model = prepare_model_for_kbit_training(model, use_gradient_checkpointing=args.gradient_checkpointing)</span><br><span class="line"></span><br><span class="line">      <span class="keyword">if</span> <span class="keyword">not</span> args.full_finetune:</span><br><span class="line">          <span class="keyword">if</span> checkpoint_dir <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">              <span class="built_in">print</span>(<span class="string">&quot;Loading adapters from checkpoint.&quot;</span>)</span><br><span class="line">              model = PeftModel.from_pretrained(model, join(checkpoint_dir, <span class="string">&#x27;adapter_model&#x27;</span>), is_trainable=<span class="literal">True</span>)</span><br><span class="line">          <span class="keyword">else</span>:</span><br><span class="line">              <span class="built_in">print</span>(<span class="string">f&#x27;adding LoRA modules...&#x27;</span>)</span><br><span class="line">              modules = find_all_linear_names(args, model)</span><br><span class="line">              config = LoraConfig(</span><br><span class="line">                  r=args.lora_r,</span><br><span class="line">                  lora_alpha=args.lora_alpha,</span><br><span class="line">                  target_modules=modules,</span><br><span class="line">                  lora_dropout=args.lora_dropout,</span><br><span class="line">                  bias=<span class="string">&quot;none&quot;</span>,</span><br><span class="line">                  task_type=<span class="string">&quot;CAUSAL_LM&quot;</span>,</span><br><span class="line">              )</span><br><span class="line">              model = get_peft_model(model, config)</span><br><span class="line">    ......</span><br></pre></td></tr></table></figure>
<p>Not every layers are quantized. QLoRA only quantizes linear
projection layers. Some layers like Layer Norm is sensitive to
precision, so high precision is required.</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://jokerdii.github.io/di-blog/2024/12/25/Understanding-LoRA/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/di-blog/images/avatar.gif">
      <meta itemprop="name" content="Di Zhen">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Di's Blog">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Di's Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/di-blog/2024/12/25/Understanding-LoRA/" class="post-title-link" itemprop="url">Understanding LoRA</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2024-12-25 15:11:11" itemprop="dateCreated datePublished" datetime="2024-12-25T15:11:11-05:00">2024-12-25</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>I finally got time to have some deep dives. Happy Christmas!</p>
<h2 id="ram-usage-during-training">RAM Usage During Training</h2>
<p>Training large-scale machine learning models e.g. LLMs, requires
significant compute resources. Here’s a breakdown of the possible memory
usage (RAM) at various stages of the classic training process, based on
the pseudocode below:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">model = Model()</span><br><span class="line">optimizer = Adam(model.parameters())</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> batch, (X, y) <span class="keyword">in</span> <span class="built_in">enumerate</span>(dataloader):</span><br><span class="line">    <span class="comment"># Compute prediction and loss</span></span><br><span class="line">    pred = model(X)</span><br><span class="line">    loss = loss_fn(pred, y)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Backpropagation</span></span><br><span class="line">    optimizer.zero_grad()</span><br><span class="line">    loss.backward()</span><br><span class="line">    optimizer.step()</span><br></pre></td></tr></table></figure>
<h3 id="key-components-of-memory-usage">Key Components of Memory
Usage</h3>
<ol type="1">
<li><p><strong>Model Parameters</strong>: These are the trainable
weights of the model, which need to be stored in memory throughout the
training process. The size is proportional to the number of parameters
in the model.</p></li>
<li><p><strong>Model Gradients</strong>: Gradients for each parameter
are computed during backpropagation and stored temporarily for the
optimizer to update the weights.</p></li>
<li><p><strong>Optimizer States</strong>: Optimizers like Adam maintain
additional states, including:</p>
<ul>
<li><p><strong>First-order momentum</strong>: Tracks the moving average
of gradients.</p></li>
<li><p><strong>Second-order momentum</strong>: Tracks the moving average
of squared gradients.</p></li>
<li><p>Both momentum terms have the same size as the model
gradients.</p></li>
</ul></li>
<li><p><strong>Activations</strong>: Activation outputs from the forward
pass are stored for use during backpropagation, where the Hessian matrix
is multiplied with the activations. The memory required for activations
can be substantial, especially as batch size increases. While the size
of parameters, gradients, and optimizer states remains constant,
activation memory scales directly with batch size.</p></li>
<li><p><strong>Other Overheads</strong>: Temporary buffers and memory
fragmentation during computation also contribute to RAM usage.</p></li>
</ol>
<h3 id="memory-calculation-examples">Memory Calculation Examples</h3>
<ol type="1">
<li><p><strong>Gradients and Parameters</strong>:</p>
<p>For 70B model, using 32-bit floating-point precision (FP32): <span
class="math display">\[
70\times10^9\times4 \text{ bytes}\times2 =521.5\text{GM}
\]</span> This accounts for the weights and their corresponding
gradients.</p></li>
<li><p><strong>Optimizer State</strong>:</p>
<p>Adam optimizer requires two additional states (first and second-order
momentum), each the same size as the gradients: <span
class="math display">\[
70\times10^9\times4 \text{ byte}\times2 =521.5\text{GM}
\]</span></p></li>
<li><p><strong>Activations</strong>:</p>
<p>For 70B model with a hidden size of 8192, 80 layers, and FP32
precision, each token’s activation memory: <span class="math display">\[
8192\times80\times4\times12 \text{ bytes/token}=30\text{ MB/token}
\]</span></p></li>
</ol>
<h3 id="simple-strategies-for-reducing-memory-usage">Simple Strategies
for Reducing Memory Usage</h3>
<ol type="1">
<li><strong>Activation Checkpointing</strong>: Instead of storing all
activation outputs, recompute activations during backpropagation as
needed. This significantly reduces activation memory at the cost of
additional compute time.</li>
<li><strong>Mixed Precision Training (FP16)</strong>: Use 16-bit
floating-point precision (FP16) instead of FP32 for model weights,
gradients, and activations. This halves the memory requirements without
substantial accuracy loss when done correctly.</li>
</ol>
<h2 id="lora">LoRA</h2>
<h3 id="adapters">Adapters</h3>
<p>The original adapter was introduced in 2019 in the paper "<a
target="_blank" rel="noopener" href="https://arxiv.org/abs/1902.00751">Parameter-Efficient Transfer
Learning for NLP</a>". It's a small, additional module added to a
pre-trained model to adapt it to a new task without significantly
changing the original model parameters.</p>
<figure>
<img
src="/di-blog/2024/12/25/Understanding-LoRA/adapter_architecture.png"
alt="adapter_architecture" />
<figcaption aria-hidden="true">adapter_architecture</figcaption>
</figure>
<p>Adapters generally <strong>reduce training latency</strong> compared
to full fine-tuning because only a small number of parameters (those
within the adapter modules) are updated during training. This reduction
in trainable parameters leads to lower computational overhead and faster
convergence in many cases. Additionally, adapters allow for larger batch
sizes due to reduced memory usage, which can further accelerate
training</p>
<p>However, adapter layers <strong>increase inference latency</strong>
because they are added sequentially and cannot be parallelized. This
issue becomes more pronounced with small batch sizes or when using
sharded models, such as GPT-2. Techniques like layer pruning or
multi-task settings can mitigate but not completely eliminate this
latency.</p>
<p>As shown in the experiment results below, inference latent can be
significant (Source: <a target="_blank" rel="noopener" href="https://arxiv.org/abs/2106.09685">LoRA
paper</a>):</p>
<figure>
<img
src="/di-blog/2024/12/25/Understanding-LoRA/adapter_experiment_results.png"
alt="adapter_experiment_results" />
<figcaption aria-hidden="true">adapter_experiment_results</figcaption>
</figure>
<h3 id="lora-basics">LoRA Basics</h3>
<p>LoRA (Low-Rank Adaptation) was introduced by a Microsoft team in 2021
in the paper <a target="_blank" rel="noopener" href="https://arxiv.org/abs/2106.09685">LoRA: Low-Rank
Adaptation of Large Language Models</a>. The main idea of LoRA is to
enable efficient fine-tuning of large pre-trained models by introducing
low-rank trainable matrices into the model’s architecture, while keeping
the original model weights frozen. This approach significantly reduces
the number of trainable parameters and computational requirements
compared to full fine-tuning, without compromising performance.</p>
<figure>
<img src="/di-blog/2024/12/25/Understanding-LoRA/lora_diagram.png"
alt="lora_diagram" />
<figcaption aria-hidden="true">lora_diagram</figcaption>
</figure>
<p>LoRA approximates weight updates in neural networks using
<strong>low-rank matrix factorization</strong>. Instead of updating the
full weight matrix <span class="math inline">\(W\)</span> , it
introduces two smaller trainable matrices <span
class="math inline">\(A\)</span> and <span
class="math inline">\(B\)</span> with size <span
class="math inline">\((r \times d)\)</span> and <span
class="math inline">\((d \times r)\)</span>. These matrices have much
fewer parameters, as their rank <span class="math inline">\(r\)</span>
is much smaller than the dimensions of <span
class="math inline">\(W\)</span>. Instead of training <span
class="math inline">\(\Delta W\)</span>, LoRA trains the parameters in
<span class="math inline">\(A\)</span> and <span
class="math inline">\(B\)</span>. This can be written in formula: <span
class="math display">\[
h=W_0x + \Delta Wx = W_0x + BAx
\]</span> where <span class="math inline">\(W_0\)</span> is original
prerained weight matrix in size <span class="math inline">\((d\times
d)\)</span> which is frozen during training; <span
class="math inline">\(\Delta W\)</span> is in <span
class="math inline">\((d \times d)\)</span> as well computed by <span
class="math inline">\(BA\)</span>. <span
class="math inline">\(x\)</span> is a new input with size <span
class="math inline">\((1 \times d)\)</span>.</p>
<p>At the start of the training process, the matrix $ A $ is randomly
initialized following a normal distribution <span
class="math inline">\(\mathcal{N}(0, \sigma^2)\)</span>, while the
matrix $ B $ is initialized as a zero matrix. In the initial round, this
setup results in $ BA = 0 $, leading to $ h = W_0x $. This
initialization strategy ensures stability by preventing significant
deviations of $ W_0 $ from its original state.</p>
<p>LoRA is a groundbreaking method with a lot of
<strong>benefits</strong>:</p>
<ul>
<li><strong>Parameter Efficiency</strong>: By training only the low-rank
matrices, LoRA reduces the number of updated parameters resulting in
lower memory usage and faster training.</li>
<li><strong>Frozen Pre-trained Weights</strong>: The original
pre-trained weights remain unchanged, preserving the model’s
general-purpose knowledge and avoiding catastrophic forgetting.</li>
<li><strong>No Inference Latency Overhead</strong>: Unlike adapters,
LoRA does not add additional layers to the model. The low-rank matrices
can be merged back into the original weight matrix after fine-tuning,
ensuring no additional inference latency.</li>
<li><strong>Versatility</strong>: LoRA can be applied to various
architectures (e.g. transformers) and tasks, making it a flexible
solution for adapting large models like GPT-3 or RoBERTa to specific use
cases.</li>
</ul>
<h3 id="lora-usage">LoRA Usage</h3>
<p>The Microsoft developers of LoRA created a Python package called <a
target="_blank" rel="noopener" href="https://github.com/microsoft/LoRA"><code>loralib</code></a> to
facilitate the use of LoRA. With this library, any linear layer
implemented as <code>nn.Linear()</code> can be replaced by
<code>lora.Linear()</code>. This is possible because LoRA is designed to
work with any layer involving matrix multiplication. The
<code>lora.Linear()</code> module introduces a pair of low-rank
adaptation matrices, which are used to modify the original weight matrix
by applying a low-rank decomposition.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ===== Before =====</span></span><br><span class="line"><span class="comment"># layer = nn.Linear(in_features, out_features)</span></span><br><span class="line"><span class="comment"># ===== After ======</span></span><br><span class="line"><span class="keyword">import</span> loralib <span class="keyword">as</span> lora</span><br><span class="line"><span class="comment"># Add a pair of low-rank adaptation matrices with rank r=16</span></span><br><span class="line">layer = lora.Linear(in_features, out_features, r=<span class="number">16</span>)</span><br></pre></td></tr></table></figure>
<p>Before training the model, all non-lora matrix should be fixed and
only LoRA matrices should be set as trainable. Training loops can run as
usual.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> loralib <span class="keyword">as</span> lora</span><br><span class="line">model = BigModel()</span><br><span class="line"><span class="comment"># This sets requires_grad to False for all parameters without the string &quot;lora_&quot; in their names</span></span><br><span class="line">lora.mark_only_lora_as_trainable(model)</span><br><span class="line"><span class="comment"># Training loop</span></span><br><span class="line"><span class="keyword">for</span> batch <span class="keyword">in</span> dataloader:</span><br><span class="line">   ...</span><br></pre></td></tr></table></figure>
<p>When saving model checkpoints during LoRA fine-tuning, only the
LoRA-specific parameters need to be saved, not the entire large
pre-trained model. This results in significantly smaller checkpoint
files and more efficient storage.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ===== Before =====</span></span><br><span class="line"><span class="comment"># torch.save(model.state_dict(), checkpoint_path)</span></span><br><span class="line"><span class="comment"># ===== After =====</span></span><br><span class="line">torch.save(lora.lora_state_dict(model), checkpoint_path)</span><br></pre></td></tr></table></figure>
<h3 id="implementation-of-lora---lora.linear">Implementation of LoRA -
lora.Linear()</h3>
<p>Let's take a deep dive into the <code>lora.Linear()</code> <a
target="_blank" rel="noopener" href="https://github.com/microsoft/LoRA/blob/main/loralib/layers.py">source
code</a>:</p>
<p>The <code>lora.Linear</code> class builds upon
<code>torch.nn.Linear()</code>. It retains the original weight matrix $
W $ as initialized in
<code>nn.Linear.__init__(self, in_features, out_features)</code>, and
introduces two additional LoRA matrices: <code>self.lora_A</code> and
<code>self.lora_B</code>. The matrix <code>self.lora_A</code> has
dimensions of $ (r, ) $, while <code>self.lora_B</code> has dimensions
of $ (, r) $. These matrices are used to adapt the original weight
matrix through low-rank decomposition.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Linear</span>(nn.Linear, LoRALayer):</span><br><span class="line">    <span class="comment"># LoRA implemented in a dense layer</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params"></span></span><br><span class="line"><span class="params">        self, </span></span><br><span class="line"><span class="params">        in_features: <span class="built_in">int</span>, </span></span><br><span class="line"><span class="params">        out_features: <span class="built_in">int</span>, </span></span><br><span class="line"><span class="params">        r: <span class="built_in">int</span> = <span class="number">0</span>, </span></span><br><span class="line"><span class="params">        lora_alpha: <span class="built_in">int</span> = <span class="number">1</span>, </span></span><br><span class="line"><span class="params">        lora_dropout: <span class="built_in">float</span> = <span class="number">0.</span>,</span></span><br><span class="line"><span class="params">        fan_in_fan_out: <span class="built_in">bool</span> = <span class="literal">False</span>, <span class="comment"># Set this to True if the layer to replace stores weight like (fan_in, fan_out)</span></span></span><br><span class="line"><span class="params">        merge_weights: <span class="built_in">bool</span> = <span class="literal">True</span>,</span></span><br><span class="line"><span class="params">        **kwargs</span></span><br><span class="line"><span class="params">    </span>):</span><br><span class="line">        nn.Linear.__init__(<span class="variable language_">self</span>, in_features, out_features, **kwargs)</span><br><span class="line">        LoRALayer.__init__(<span class="variable language_">self</span>, r=r, lora_alpha=lora_alpha, lora_dropout=lora_dropout,</span><br><span class="line">                           merge_weights=merge_weights)</span><br><span class="line"></span><br><span class="line">        <span class="variable language_">self</span>.fan_in_fan_out = fan_in_fan_out</span><br><span class="line">        <span class="comment"># Actual trainable parameters</span></span><br><span class="line">        <span class="keyword">if</span> r &gt; <span class="number">0</span>:</span><br><span class="line">            <span class="variable language_">self</span>.lora_A = nn.Parameter(<span class="variable language_">self</span>.weight.new_zeros((r, in_features)))</span><br><span class="line">            <span class="variable language_">self</span>.lora_B = nn.Parameter(<span class="variable language_">self</span>.weight.new_zeros((out_features, r)))</span><br><span class="line">            <span class="variable language_">self</span>.scaling = <span class="variable language_">self</span>.lora_alpha / <span class="variable language_">self</span>.r</span><br><span class="line">            <span class="comment"># Freezing the pre-trained weight matrix</span></span><br><span class="line">            <span class="variable language_">self</span>.weight.requires_grad = <span class="literal">False</span></span><br><span class="line">        <span class="variable language_">self</span>.reset_parameters()</span><br><span class="line">        <span class="keyword">if</span> fan_in_fan_out:</span><br><span class="line">            <span class="variable language_">self</span>.weight.data = <span class="variable language_">self</span>.weight.data.transpose(<span class="number">0</span>, <span class="number">1</span>)</span><br></pre></td></tr></table></figure>
<p>In the <code>forward()</code> function, it implements <span
class="math inline">\(h=W_0x + \Delta Wx = W_0x+ BAx\)</span>.</p>
<p>There is a flag variable called <code>self.merge</code> which is use
to flag whether it's doing inference or training. Recall that the
original weight matrix remaining unchanged during LoRA training is a key
feature of the LoRA - pre-trained weights are freezed and instead small,
low-rank matrices are trained to approximate updates.</p>
<ul>
<li>During inference, if <code>merge_weights</code> is set to
<code>True</code>, the low-rank updates
<code>self.lora_B @ self.lora_A</code> are added directly to the frozen
pre-trained weights (<code>self.weight</code>). This avoids the need for
separate computations of LoRA updates during forward passes, improving
efficiency.</li>
<li>During training, if <code>merge_weights</code> is enabled and
weights were previously merged, the updates are subtracted from
<code>self.weight</code> to revert it to its original frozen state. This
ensures that gradients are not incorrectly computed on the merged
weights.</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Linear</span>(nn.Linear, LoRALayer):</span><br><span class="line">    <span class="comment"># LoRA implemented in a dense layer</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params"></span></span><br><span class="line"><span class="params">        self, </span></span><br><span class="line"><span class="params">        in_features: <span class="built_in">int</span>, </span></span><br><span class="line"><span class="params">        out_features: <span class="built_in">int</span>, </span></span><br><span class="line"><span class="params">        r: <span class="built_in">int</span> = <span class="number">0</span>, </span></span><br><span class="line"><span class="params">        lora_alpha: <span class="built_in">int</span> = <span class="number">1</span>, </span></span><br><span class="line"><span class="params">        lora_dropout: <span class="built_in">float</span> = <span class="number">0.</span>,</span></span><br><span class="line"><span class="params">        fan_in_fan_out: <span class="built_in">bool</span> = <span class="literal">False</span>, <span class="comment"># Set this to True if the layer to replace stores weight like (fan_in, fan_out)</span></span></span><br><span class="line"><span class="params">        merge_weights: <span class="built_in">bool</span> = <span class="literal">True</span>,</span></span><br><span class="line"><span class="params">        **kwargs</span></span><br><span class="line"><span class="params">    </span>):</span><br><span class="line"></span><br><span class="line">      ......</span><br><span class="line">      </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">train</span>(<span class="params">self, mode: <span class="built_in">bool</span> = <span class="literal">True</span></span>):</span><br><span class="line">        <span class="keyword">def</span> <span class="title function_">T</span>(<span class="params">w</span>):</span><br><span class="line">            <span class="keyword">return</span> w.transpose(<span class="number">0</span>, <span class="number">1</span>) <span class="keyword">if</span> <span class="variable language_">self</span>.fan_in_fan_out <span class="keyword">else</span> w</span><br><span class="line">        nn.Linear.train(<span class="variable language_">self</span>, mode)</span><br><span class="line">        <span class="keyword">if</span> mode:</span><br><span class="line">            <span class="keyword">if</span> <span class="variable language_">self</span>.merge_weights <span class="keyword">and</span> <span class="variable language_">self</span>.merged:</span><br><span class="line">                <span class="comment"># Make sure that the weights are not merged</span></span><br><span class="line">                <span class="keyword">if</span> <span class="variable language_">self</span>.r &gt; <span class="number">0</span>:</span><br><span class="line">                    <span class="variable language_">self</span>.weight.data -= T(<span class="variable language_">self</span>.lora_B @ <span class="variable language_">self</span>.lora_A) * <span class="variable language_">self</span>.scaling</span><br><span class="line">                <span class="variable language_">self</span>.merged = <span class="literal">False</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">if</span> <span class="variable language_">self</span>.merge_weights <span class="keyword">and</span> <span class="keyword">not</span> <span class="variable language_">self</span>.merged:</span><br><span class="line">                <span class="comment"># Merge the weights and mark it</span></span><br><span class="line">                <span class="keyword">if</span> <span class="variable language_">self</span>.r &gt; <span class="number">0</span>:</span><br><span class="line">                    <span class="variable language_">self</span>.weight.data += T(<span class="variable language_">self</span>.lora_B @ <span class="variable language_">self</span>.lora_A) * <span class="variable language_">self</span>.scaling</span><br><span class="line">                <span class="variable language_">self</span>.merged = <span class="literal">True</span>    </span><br><span class="line">                </span><br><span class="line">			<span class="keyword">def</span> <span class="title function_">forward</span>(<span class="params">self, x: torch.Tensor</span>):</span><br><span class="line">        <span class="keyword">def</span> <span class="title function_">T</span>(<span class="params">w</span>):</span><br><span class="line">            <span class="keyword">return</span> w.transpose(<span class="number">0</span>, <span class="number">1</span>) <span class="keyword">if</span> <span class="variable language_">self</span>.fan_in_fan_out <span class="keyword">else</span> w</span><br><span class="line">        <span class="keyword">if</span> <span class="variable language_">self</span>.r &gt; <span class="number">0</span> <span class="keyword">and</span> <span class="keyword">not</span> <span class="variable language_">self</span>.merged:</span><br><span class="line">            result = F.linear(x, T(<span class="variable language_">self</span>.weight), bias=<span class="variable language_">self</span>.bias)            </span><br><span class="line">            result += (<span class="variable language_">self</span>.lora_dropout(x) @ <span class="variable language_">self</span>.lora_A.transpose(<span class="number">0</span>, <span class="number">1</span>) @ <span class="variable language_">self</span>.lora_B.transpose(<span class="number">0</span>, <span class="number">1</span>)) * <span class="variable language_">self</span>.scaling</span><br><span class="line">            <span class="keyword">return</span> result</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> F.linear(x, T(<span class="variable language_">self</span>.weight), bias=<span class="variable language_">self</span>.bias)</span><br><span class="line">          </span><br><span class="line">      ......</span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




  <nav class="pagination">
    <a class="extend prev" rel="prev" title="Previous page" aria-label="Previous page" href="/di-blog/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/di-blog/">1</a><span class="page-number current">2</span><a class="page-number" href="/di-blog/page/3/">3</a><span class="space">&hellip;</span><a class="page-number" href="/di-blog/page/5/">5</a><a class="extend next" rel="next" title="Next page" aria-label="Next page" href="/di-blog/page/3/"><i class="fa fa-angle-right"></i></a>
  </nav>

</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">

  <div class="copyright">
    &copy; 
    <span itemprop="copyrightYear">2025</span>
    <span class="with-love">
      <i class="fa fa-heart"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">Di Zhen</span>
  </div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/muse/" rel="noopener" target="_blank">NexT.Muse</a>
  </div>

    </div>
  </footer>

  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>
  <div class="sidebar-dimmer"></div>
  <div class="back-to-top" role="button" aria-label="Back to top">
    <i class="fa fa-arrow-up fa-lg"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/di-blog/js/comments.js"></script><script src="/di-blog/js/utils.js"></script><script src="/di-blog/js/motion.js"></script><script src="/di-blog/js/sidebar.js"></script><script src="/di-blog/js/next-boot.js"></script>

  






  




  

  <script class="next-config" data-name="enableMath" type="application/json">true</script><script class="next-config" data-name="mathjax" type="application/json">{"enable":true,"tags":"none","js":{"url":"https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.2/es5/tex-mml-chtml.js","integrity":"sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI="}}</script>
<script src="/di-blog/js/third-party/math/mathjax.js"></script>



</body>
</html>
